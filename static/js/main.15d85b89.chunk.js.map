{"version":3,"sources":["components/sidebar/panels/imageUploader/ImageUploader.module.css","components/App.module.css","components/authentication/Authentication.module.css","components/5e/5eRules.ts","models/ChatMessage.ts","components/5e/characterSheet/AbilityScore.tsx","components/5e/characterSheet/AbilitySave.tsx","components/5e/characterSheet/Skill.tsx","components/5e/characterSheet/ProficiencyBonus.tsx","components/5e/characterSheet/Speed.tsx","components/5e/characterSheet/Initiative.tsx","components/5e/characterSheet/ArmorClass.tsx","components/5e/characterSheet/HitPoints.tsx","components/5e/characterSheet/AttackBlock.tsx","components/5e/characterSheet/Attacks.tsx","components/5e/characterSheet/CharacterSheet.tsx","redux/actions/chat.ts","redux/actions/characters.ts","components/5e/characterSheet/CharacterSheetContainer.tsx","redux/actions/storage.ts","components/sidebar/panels/imageUploader/ImageUploader.tsx","components/sidebar/panels/imageUploader/ImageUploaderContainer.tsx","redux/actions/auth.ts","components/authentication/Authentication.tsx","components/chat/ChatMessageItem.tsx","components/chat/RollMessageItem.tsx","components/chat/characterActions/DiceRoll.tsx","components/chat/characterActions/TextBlock.tsx","components/chat/characterActions/CharacterAction.tsx","components/chat/Chat.tsx","components/chat/ChatContainer.tsx","components/assets/AssetListItem.tsx","components/assets/AssetList.tsx","components/assets/AssetListContainer.tsx","components/assets/UploadSelector.tsx","components/assets/CreateAsset.tsx","redux/actions/assets.ts","components/assets/CreateAssetContainer.tsx","components/settings/Settings.tsx","components/settings/SettingsContainer.tsx","components/5e/CharacterList.tsx","components/sidebar/panels/characters/CharactersContainer.tsx","components/sidebar/Sidebar.tsx","components/toolbar/Toolbar.tsx","components/toolbar/ToolbarContainer.tsx","components/toolbar/ViewControls.tsx","redux/actions/map.ts","components/toolbar/ViewControlsContainer.tsx","components/map/Map.tsx","components/map/MapContainer.tsx","redux/reducers/chat.ts","redux/reducers/characters.ts","redux/reducers/auth.ts","redux/reducers/storage.ts","redux/actions/images.ts","redux/reducers/images.ts","redux/reducers/assets.ts","redux/reducers/map.ts","redux/reducers/index.ts","redux/rsf.ts","redux/sagas/chat.ts","redux/sagas/auth.ts","redux/sagas/storage.ts","redux/sagas/images.ts","redux/sagas/assets.ts","redux/sagas/index.ts","redux/store.ts","components/App.tsx","serviceWorker.js","index.tsx","components/chat/Chat.module.css"],"names":["module","exports","wrapper","fileInput","button","progressBar","chatWrapper","username","password","loginButton","logoutButton","AttackEffectType","CharacterActionResultType","AdvantageType","Rules","character","totalLevel","levels","map","x","level","reduce","y","Math","ceil","ability","baseModifier","this","getAbilityModifier","proficiencyMultiplier","proficiencies","saves","proficiencyBonus","getProficiencyBonus","floor","attacks","push","name","range","effects","type","ToHit","modifier","critRange","Damage","damageType","diceCount","diceType","bonus","AbilityScore","props","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","handleClick","bind","assertThisInitialized","_this2","_this$props","react_default","a","createElement","className","onClick","e","getLongName","abs","advantage","modifierStr","roll","DiceRoll","data","rollType","rollName","roll1Total","total","roll1Details","toString","match","roll1CritSuccess","rolls","roll1CritFail","roll2","rollAdvantageType","roll2Total","roll2Details","roll2CritSuccess","roll2CritFail","stopPropagation","sendMessage","React","Component","AbilitySave","getSaveModifier","proficiencyClass","concat","getShortAbilityName","Skill","skill","getSkillModifier","skills","getLongSkillName","ProficiencyBonus","Speed","movementTypes","_i","_Object$keys","keys","speed","length","movementType","key","walk","Initiative","getInitiativeModifier","ArmorClass","ac","HitPoints","hp","maxHp","AttackBlock","attack","toHitEffect","filter","damageEffect","undefined","crit","title","results","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","effect","value","result","roll1","critFail","critSuccess","details","ignore","damageRoll","result2","None","damageRollDetails","Error","err","return","Attacks","getAttacks","AttackBlock_AttackBlock","assign","CharacterSheet","closeSheet","join","AbilityScore_AbilityScore","ProficiencyBonus_ProficiencyBonus","Speed_Speed","HitPoints_HitPoints","AbilitySave_AbilitySave","Skill_Skill","style","flex","Initiative_Initiative","ArmorClass_ArmorClass","Attacks_Attacks","closeCharacterSheet","id","types","CHAT","SYNC","SYNC_FAILED","NEW","SAVE","syncChatMessages","messages","saveNewMessage","message","syncChatFailed","error","CHARACTERS","OPEN_SHEET","CLOSE_SHEET","CharacterSheetContainer","characterSheets","_loop","characterId","CharacterSheet_CharacterSheet","characters","openCharacterSheets","connect","dispatch","STORAGE","SEND_FILE","SEND_FILE_SUCCESS","SEND_FILE_FAILURE","SEND_FILE_PROGRESS","uploadProgress","progress","uploadCompleted","uploadFailed","ImageUploader","uploadName","file","onUpload","onChangeFile","event","target","files","setState","filePath","uuidv4","styles","placeholder","onChange","disabled","inProgress","max","ImageUploaderContainer","ImageUploader_ImageUploader","sendFile","uploading","storage","LOGIN","REQUEST","SUCCESS","FAILURE","LOGOUT","login","loginSuccess","user","loginFailure","logout","logoutSuccess","logoutFailure","Authentication","updateState","prop","val","newState","loggedIn","TextField_default","label","evt","margin","onKeyUp","keyCode","Button_default","variant","color","PureComponent","auth","ChatMessageItem","isOwner","sender","msg","RollMessageItem","ignoreRoll1","ignoreRoll2","rollSuffix","i","Advantage","TextBlock","text","CharacterAction","idx","Text","TextBlock_TextBlock","DiceRoll_DiceRoll","Chat","scrollDiv","scrollToBottomOfChat","scrollTop","scrollHeight","handleMsgChange","handleKeyDown","notation","padding","paddingBottom","authentication_Authentication","chatHeader","messageWrapper","ref","cmpt","RollMessageItem_RollMessageItem","CharacterAction_CharacterAction","ChatMessageItem_ChatMessageItem","email","chatInputWrapper","onKeyDown","ChatContainer","Chat_Chat","chat","AssetListItem","asset","AssetList","assets","AssetListItem_AssetListItem","AssetListContainer","AssetList_AssetList","UploadSelector","current","handleChange","classes","options","index_es","formControl","htmlFor","inputProps","withStyles","theme","root","display","flexWrap","spacing","unit","minWidth","selectEmpty","marginTop","CreateAsset","onSave","saveNewAsset","imageUrl","onChangeUpload","uploadId","uploads","flexDirection","nameInput","assets_UploadSelector","Save_default","classNames","leftIcon","iconSmall","marginRight","rightIcon","marginLeft","fontSize","ASSETS","syncAssets","syncAssetsFailed","CreateAssetContainer","assets_CreateAsset","images","Settings","SettingsContainer","Settings_Settings","CharacterList","openCharacterSheet","_5e_CharacterList","Sidebar","AppBar_default","position","Tabs_default","Tab_default","chat_ChatContainer","CharactersContainer","imageUploader_ImageUploaderContainer","assets_CreateAssetContainer","assets_AssetListContainer","settings_SettingsContainer","createStyles","toolbarWrapper","backgroundColor","borderTopLeftRadius","borderTopRightRadius","toolbarButton","width","height","border","borderRadius","boxShadow","cursor","&:hover","background","Toolbar","ToolbarContainer","toolbar_Toolbar","viewControlWrapper","borderBottomLeftRadius","viewControlButton","ViewControls","mapZoomIn","mapZoomOut","MAP","ZOOM","IN","OUT","ViewControlsContainer","toolbar_ViewControls","Map","alpha","dragging","sprite","app","onMapMount","viewport","Viewport","screenWidth","window","innerWidth","screenHeight","innerHeight","worldWidth","worldHeight","interaction","renderer","plugins","autoResize","view","resize","stage","addChild","drag","mouseButtons","pinch","wheel","decelerate","PIXI","fromImage","anchor","set","interactive","on","onDragStart","onDragMove","onDragEnd","currentTarget","tint","s2","inst","newPos","getLocalPosition","parent","react_pixi_module","onMount","MapContainer","zoom","Map_Map","updateSpriteLocation","initialState","new","syncError","reducer","arguments","action","objectSpread","size","strength","dexterity","constitution","intelligence","wisdom","charisma","hitDice","climb","fly","athletics","insight","intimidation","perception","toConsumableArray","loading","loginError","authReducer","url","uploadError","storageReducer","IMAGES","syncImages","syncImagesFailed","imagesReducer","assetsReducer","mapReducer","firebaseConfig","JSON","parse","localStorage","getItem","firebaseApp","firebase","initializeApp","rsf","database","ReduxSagaFirebase","saveNewChatMessage","syncMessagesSaga","rootSaga","currentUser","regenerator_default","wrap","_context","prev","select","sent","create","timestamp","ServerValue","TIMESTAMP","stop","_marked","messageTransformer","_ref","_context2","fork","sync","orderByChild","successActionCreator","failureActionCreator","transform","_marked2","_context3","all","takeEvery","_marked3","loginSaga","logoutSaga","loginStatusWatcher","loginRootSaga","EmailAuthProvider","signInWithEmailAndPassword","t0","put","auth_marked","signOut","auth_marked2","channel","take","auth_marked3","_context4","_marked4","sendFileSaga","watchUploadProgressChannel","uploadFileChannel","task","uploadFile","snapshot","pct","bytesTransferred","totalBytes","console","log","getDownloadURL","downloadUrl","uploadTime","storage_marked","storage_marked2","storage_marked3","syncImagesSaga","imageTransformer","images_marked","images_marked2","syncAssetsSaga","assetTransformer","creator","uid","assets_marked","assets_marked2","assets_marked3","sagas_marked","history","createBrowserHistory","basename","process","sagaMiddleware","createSagaMiddleware","middleware","composedEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","apply","applyMiddleware","store","createStore","combineReducers","router","connectRouter","ChatReducer","AuthReducer","StorageReducer","ImageReducer","AssetReducer","MapReducer","CharactersReducer","run","App","configLoaded","projectName","apiKey","createMuiTheme","palette","es","esm","react_router","exact","path","render","map_MapContainer","toolbar_ToolbarContainer","bottom","left","toolbar_ViewControlsContainer","right","top","characterSheet_CharacterSheetContainer","Sidebar_Sidebar","Boolean","location","hostname","ReactDOM","saveConfig","setItem","stringify","authDomain","databaseURL","projectId","storageBucket","reload","document","getElementById","require","default","navigator","serviceWorker","ready","then","registration","unregister","chatinput","rollButton"],"mappings":"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","file":"static/js/main.15d85b89.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"ImageUploader_wrapper__wSUkk\",\"fileInput\":\"ImageUploader_fileInput__bXesA\",\"button\":\"ImageUploader_button__1wVu_\",\"progressBar\":\"ImageUploader_progressBar__11JDB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chatWrapper\":\"App_chatWrapper__1W4Il\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"Authentication_wrapper__3mwEf\",\"username\":\"Authentication_username__3aSnV\",\"password\":\"Authentication_password__VxlmJ\",\"loginButton\":\"Authentication_loginButton__3ig6u\",\"logoutButton\":\"Authentication_logoutButton__3qUj0\"};","import { Character } from './Character';\r\n\r\nexport interface Attack {\r\n\tname: string;\r\n\trange: number;\r\n\tlongRange?: number;\r\n\teffects: AttackEffect[];\r\n}\r\n\r\nexport interface AttackEffect {\r\n\ttype: AttackEffectType;\r\n}\r\n\r\nexport enum AttackEffectType {\r\n\tToHit,\r\n\tDamage,\r\n\tSavingThrow,\r\n\tText\r\n}\r\n\r\nexport interface ToHitAttackEffect extends AttackEffect {\r\n\tmodifier: number;\r\n\tcritRange?: number;\r\n}\r\n\r\nexport interface DamageAttackEffect extends AttackEffect {\r\n\tdamageType: string;\r\n\tdiceCount: number;\r\n\tdiceType: number;\r\n\tbonus?: number;\r\n}\r\n\r\nexport interface SavingThrowAttackEffect extends AttackEffect {\r\n\tsaveType: string;\r\n\tsaveDC: number;\r\n\tonPassSave: AttackEffect;\r\n\tonFailSave: AttackEffect;\r\n}\r\n\r\nexport interface TextAttackEffect extends AttackEffect {\r\n\ttext: string;\r\n}\r\n\r\nexport default class Rules {\r\n\tpublic static getProficiencyBonus(character: Character): number {\r\n\t\tconst totalLevel = character.levels.map(x => x.level).reduce((x, y) => x + y);\r\n\t\treturn 1 + Math.ceil(totalLevel / 4);\r\n\t}\r\n\r\n\tpublic static getSaveModifier(character: Character, ability: string): number {\r\n\t\tconst baseModifier = this.getAbilityModifier(character, ability);\r\n\t\tconst proficiencyMultiplier = character.proficiencies.saves[ability] || 0;\r\n\t\tconst proficiencyBonus = Rules.getProficiencyBonus(character);\r\n\t\treturn baseModifier + Math.floor(proficiencyMultiplier * proficiencyBonus);\r\n\t}\r\n\r\n\tpublic static getAbilityModifier(character: Character, ability: string): number {\r\n\t\treturn Math.floor((character[ability] - 10) / 2);\r\n\t}\r\n\r\n\tpublic static getInitiativeModifier(character: Character): number {\r\n\t\treturn this.getAbilityModifier(character, 'dexterity');\r\n\t}\r\n\r\n\tpublic static getAttacks(character: Character): Attack[] {\r\n\t\tconst attacks: Attack[] = [];\r\n\t\tattacks.push({\r\n\t\t\tname: 'Longsword',\r\n\t\t\trange: 5,\r\n\t\t\teffects: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: AttackEffectType.ToHit,\r\n\t\t\t\t\tmodifier:\r\n\t\t\t\t\t\tthis.getAbilityModifier(character, 'strength') +\r\n\t\t\t\t\t\tthis.getProficiencyBonus(character),\r\n\t\t\t\t\tcritRange: 20\r\n\t\t\t\t} as ToHitAttackEffect,\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: AttackEffectType.Damage,\r\n\t\t\t\t\tdamageType: 'slashing',\r\n\t\t\t\t\tdiceCount: 1,\r\n\t\t\t\t\tdiceType: 8,\r\n\t\t\t\t\tbonus: this.getAbilityModifier(character, 'strength')\r\n\t\t\t\t} as DamageAttackEffect\r\n\t\t\t]\r\n\t\t});\r\n\t\t/*attacks.push({\r\n\t\t\tname: 'Light Crossbow',\r\n\t\t\trange: 80,\r\n\t\t\tlongRange: 320,\r\n\t\t\tdamageBonus: this.getAbilityModifier(character, 'dexterity'),\r\n\t\t\tdiceCount: 1,\r\n\t\t\tdiceType: 8,\r\n\t\t\tdamageType: 'piercing',\r\n\t\t\tcritRange: 20,\r\n\t\t\tproficient: true,\r\n\t\t\ttoHit:\r\n\t\t\t\tthis.getAbilityModifier(character, 'dexterity') +\r\n\t\t\t\tthis.getProficiencyBonus(character)\r\n\t\t});\r\n\t\tattacks.push({\r\n\t\t\tname: 'Goading Attack',\r\n\t\t\tdiceCount: 1,\r\n\t\t\tdiceType: 8,\r\n\t\t\tdamageType: 'additional',\r\n\t\t\tsaveType: 'wisdom',\r\n\t\t\tsaveDC: 10 + this.getAbilityModifier(character, 'strength'),\r\n\t\t\teffect:\r\n\t\t\t\t'On a failed save, the target has a disadvantage on all attack rolls against targets other than you until the end of your next turn.'\r\n\t\t});*/\r\n\t\treturn attacks;\r\n\t}\r\n\r\n\tpublic static getShortAbilityName(ability: string): string {\r\n\t\tswitch (ability) {\r\n\t\t\tcase 'strength':\r\n\t\t\t\treturn 'STR';\r\n\t\t\tcase 'dexterity':\r\n\t\t\t\treturn 'DEX';\r\n\t\t\tcase 'constitution':\r\n\t\t\t\treturn 'CON';\r\n\t\t\tcase 'intelligence':\r\n\t\t\t\treturn 'INT';\r\n\t\t\tcase 'wisdom':\r\n\t\t\t\treturn 'WIS';\r\n\t\t\tcase 'charisma':\r\n\t\t\t\treturn 'CHA';\r\n\t\t\tdefault:\r\n\t\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static getLongAbilityName(ability: string): string {\r\n\t\tswitch (ability) {\r\n\t\t\tcase 'strength':\r\n\t\t\t\treturn 'Strength';\r\n\t\t\tcase 'dexterity':\r\n\t\t\t\treturn 'Dexterity';\r\n\t\t\tcase 'constitution':\r\n\t\t\t\treturn 'Consititution';\r\n\t\t\tcase 'intelligence':\r\n\t\t\t\treturn 'Intelligence';\r\n\t\t\tcase 'wisdom':\r\n\t\t\t\treturn 'Wisdom';\r\n\t\t\tcase 'charisma':\r\n\t\t\t\treturn 'Charisma';\r\n\t\t\tdefault:\r\n\t\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static getLongSkillName(ability: string): string {\r\n\t\tswitch (ability) {\r\n\t\t\tcase 'acrobatics':\r\n\t\t\t\treturn 'Acrobatics';\r\n\t\t\tcase 'animalHandling':\r\n\t\t\t\treturn 'Animal Handling';\r\n\t\t\tcase 'arcana':\r\n\t\t\t\treturn 'Arcana';\r\n\t\t\tcase 'athletics':\r\n\t\t\t\treturn 'Athletics';\r\n\t\t\tcase 'deception':\r\n\t\t\t\treturn 'Deception';\r\n\t\t\tcase 'history':\r\n\t\t\t\treturn 'History';\r\n\t\t\tcase 'insight':\r\n\t\t\t\treturn 'Insight';\r\n\t\t\tcase 'intimidation':\r\n\t\t\t\treturn 'Intimidation';\r\n\t\t\tcase 'investigation':\r\n\t\t\t\treturn 'Investigation';\r\n\t\t\tcase 'medicine':\r\n\t\t\t\treturn 'Medicine';\r\n\t\t\tcase 'nature':\r\n\t\t\t\treturn 'Nature';\r\n\t\t\tcase 'perception':\r\n\t\t\t\treturn 'Perception';\r\n\t\t\tcase 'performance':\r\n\t\t\t\treturn 'Performance';\r\n\t\t\tcase 'persuasion':\r\n\t\t\t\treturn 'Persuasion';\r\n\t\t\tcase 'religion':\r\n\t\t\t\treturn 'Religion';\r\n\t\t\tcase 'sleightOfHand':\r\n\t\t\t\treturn 'Sleight of Hand';\r\n\t\t\tcase 'stealth':\r\n\t\t\t\treturn 'Stealth';\r\n\t\t\tcase 'survival':\r\n\t\t\t\treturn 'Survival';\r\n\t\t\tdefault:\r\n\t\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n}\r\n","export interface ChatMessage {\r\n\tsender: string;\r\n\tid: string;\r\n\tdata?: ChatMessageData;\r\n\tmsg?: string;\r\n}\r\n\r\nexport interface ChatMessageData {\r\n\ttype: string;\r\n}\r\n\r\nexport interface CharacterActionData extends ChatMessageData {\r\n\ttitle: string;\r\n\tresults: CharacterActionResult[];\r\n}\r\n\r\nexport enum CharacterActionResultType {\r\n\tText,\r\n\tDiceRoll\r\n}\r\n\r\nexport interface CharacterActionResult {\r\n\ttype: CharacterActionResultType;\r\n}\r\n\r\nexport interface CharacterActionTextResult extends CharacterActionResult {\r\n\ttext: string;\r\n}\r\n\r\nexport interface CharacterActionDiceRollResult extends CharacterActionResult {\r\n\trolls: CharacterActionDiceRollResultRoll[];\r\n\tadvantage: AdvantageType;\r\n\tmodifier: number;\r\n}\r\n\r\nexport enum AdvantageType {\r\n\tDisadvantage = -1,\r\n\tNone = 0,\r\n\tAdvantage = 1\r\n}\r\n\r\nexport interface CharacterActionDiceRollResultRoll {\r\n\ttotal: number;\r\n\tdetails: string;\r\n\tcritSuccess: boolean;\r\n\tcritFail: boolean;\r\n\tignore: boolean;\r\n}\r\n\r\nexport interface RollData extends ChatMessageData {\r\n\trollType: string;\r\n\trollName: string;\r\n\trollSuffix?: string;\r\n\tmodifier: string;\r\n\troll1Total: number;\r\n\troll1Details: string;\r\n\troll1CritSuccess: boolean;\r\n\troll1CritFail: boolean;\r\n\trollAdvantageType?: number; // -1 = disadvantage; 0 = normal; +1 = advantage\r\n\troll2Total?: number;\r\n\troll2Details?: string;\r\n\troll2CritSuccess?: boolean;\r\n\troll2CritFail?: boolean;\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\nimport { RollData, ChatMessageData } from '../../../models/ChatMessage';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tability: string;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class AbilityScore extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { ability, character } = this.props;\r\n\t\tconst modifier = Rules.getAbilityModifier(character, ability);\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ability\" onClick={e => this.handleClick(e, 0)}>\r\n\t\t\t\t<div className=\"popup-advantage\" onClick={e => this.handleClick(e, 1)}>\r\n\t\t\t\t\tA\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"popup-disadvantage\" onClick={e => this.handleClick(e, -1)}>\r\n\t\t\t\t\tD\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ability-title\">{this.getLongName(ability)}</div>\r\n\t\t\t\t<div className=\"ability-modifier\">\r\n\t\t\t\t\t<div className=\"ability-symbol\">{modifier < 0 ? '-' : '+'}</div>\r\n\t\t\t\t\t<div className=\"ability-number\">{Math.abs(modifier)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ability-score\">{character[ability]}</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\tgetLongName(ability: string): string {\r\n\t\tswitch (ability) {\r\n\t\t\tcase 'strength':\r\n\t\t\t\treturn 'Strength';\r\n\t\t\tcase 'dexterity':\r\n\t\t\t\treturn 'Dexterity';\r\n\t\t\tcase 'constitution':\r\n\t\t\t\treturn 'Constitution';\r\n\t\t\tcase 'intelligence':\r\n\t\t\t\treturn 'Intelligence';\r\n\t\t\tcase 'wisdom':\r\n\t\t\t\treturn 'Wisdom';\r\n\t\t\tcase 'charisma':\r\n\t\t\t\treturn 'Charisma';\r\n\t\t\tdefault:\r\n\t\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\r\n\thandleClick(e, advantage: number): void {\r\n\t\tconst modifier = Rules.getAbilityModifier(this.props.character, this.props.ability);\r\n\t\tconst modifierStr = (modifier < 0 ? '' : '+') + modifier;\r\n\t\tconst roll = new DiceRoll('d20' + modifierStr);\r\n\t\tconst stat = this.getLongName(this.props.ability);\r\n\r\n\t\tconst data: RollData = {\r\n\t\t\ttype: 'roll',\r\n\t\t\trollType: 'Ability',\r\n\t\t\trollName: stat,\r\n\t\t\tmodifier: modifierStr,\r\n\t\t\troll1Total: roll.total,\r\n\t\t\troll1Details: roll.toString().match(/.*?: (.*?) =/)[1],\r\n\t\t\troll1CritSuccess: roll.rolls[0][0] === 20,\r\n\t\t\troll1CritFail: roll.rolls[0][0] === 1\r\n\t\t};\r\n\r\n\t\tif (advantage) {\r\n\t\t\tconst roll2 = new DiceRoll('d20' + modifierStr);\r\n\t\t\tdata.rollAdvantageType = advantage;\r\n\t\t\tdata.roll2Total = roll2.total;\r\n\t\t\tdata.roll2Details = roll2.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\tdata.roll2CritSuccess = roll2.rolls[0][0] === 20;\r\n\t\t\tdata.roll2CritFail = roll2.rolls[0][0] === 1;\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\tthis.props.sendMessage('', data);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\nimport { RollData, ChatMessageData } from '../../../models/ChatMessage';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tability: string;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class AbilitySave extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { ability, character } = this.props;\r\n\t\tconst modifier = Rules.getSaveModifier(character, ability);\r\n\t\tconst proficiencyClass =\r\n\t\t\tcharacter.proficiencies.saves[ability] === 2\r\n\t\t\t\t? 'expertise'\r\n\t\t\t\t: character.proficiencies.saves[ability] === 1\r\n\t\t\t\t? 'proficient'\r\n\t\t\t\t: character.proficiencies.saves[ability] === 0.5\r\n\t\t\t\t? 'half-proficient'\r\n\t\t\t\t: 'none';\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"save\" onClick={e => this.handleClick(e, 0)}>\r\n\t\t\t\t<div className=\"popup-advantage\" onClick={e => this.handleClick(e, 1)}>\r\n\t\t\t\t\tA\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"popup-disadvantage\" onClick={e => this.handleClick(e, -1)}>\r\n\t\t\t\t\tD\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"save-wrapper\">\r\n\t\t\t\t\t<div className={`save-proficiency ${proficiencyClass}`} />\r\n\t\t\t\t\t<div className=\"save-title\">{Rules.getShortAbilityName(ability)}</div>\r\n\t\t\t\t\t<div className=\"save-modifier\">\r\n\t\t\t\t\t\t<span className=\"save-symbol\">{modifier < 0 ? '-' : '+'}</span>\r\n\t\t\t\t\t\t<span className=\"save-number\">{Math.abs(modifier)}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\tgetLongName(ability: string): string {\r\n\t\tswitch (ability) {\r\n\t\t\tcase 'strength':\r\n\t\t\t\treturn 'Strength Save';\r\n\t\t\tcase 'dexterity':\r\n\t\t\t\treturn 'Dexterity Save';\r\n\t\t\tcase 'constitution':\r\n\t\t\t\treturn 'Constitution Save';\r\n\t\t\tcase 'intelligence':\r\n\t\t\t\treturn 'Intelligence Save';\r\n\t\t\tcase 'wisdom':\r\n\t\t\t\treturn 'Wisdom Save';\r\n\t\t\tcase 'charisma':\r\n\t\t\t\treturn 'Charisma Save';\r\n\t\t\tdefault:\r\n\t\t\t\treturn '';\r\n\t\t}\r\n\t}\r\n\r\n\thandleClick(e, advantage: number): void {\r\n\t\tconst modifier = Rules.getSaveModifier(this.props.character, this.props.ability);\r\n\t\tconst modifierStr = (modifier < 0 ? '' : '+') + modifier;\r\n\t\tconst roll = new DiceRoll('d20' + modifierStr);\r\n\t\tconst stat = this.getLongName(this.props.ability);\r\n\r\n\t\tconst data: RollData = {\r\n\t\t\ttype: 'roll',\r\n\t\t\trollType: 'Save',\r\n\t\t\trollName: stat,\r\n\t\t\tmodifier: modifierStr,\r\n\t\t\troll1Total: roll.total,\r\n\t\t\troll1Details: roll.toString().match(/.*?: (.*?) =/)[1],\r\n\t\t\troll1CritSuccess: roll.rolls[0][0] === 20,\r\n\t\t\troll1CritFail: roll.rolls[0][0] === 1\r\n\t\t};\r\n\r\n\t\tif (advantage) {\r\n\t\t\tconst roll2 = new DiceRoll('d20' + modifierStr);\r\n\t\t\tdata.rollAdvantageType = advantage;\r\n\t\t\tdata.roll2Total = roll2.total;\r\n\t\t\tdata.roll2Details = roll2.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\tdata.roll2CritSuccess = roll2.rolls[0][0] === 20;\r\n\t\t\tdata.roll2CritFail = roll2.rolls[0][0] === 1;\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\tthis.props.sendMessage('', data);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\nimport { RollData, ChatMessageData } from '../../../models/ChatMessage';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tskill: string;\r\n\tability: string;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class Skill extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { ability, character, skill } = this.props;\r\n\t\tconst modifier = this.getSkillModifier(character, skill, ability);\r\n\t\tconst proficiencyClass =\r\n\t\t\tcharacter.proficiencies.skills[skill] === 2\r\n\t\t\t\t? 'expertise'\r\n\t\t\t\t: character.proficiencies.skills[skill] === 1\r\n\t\t\t\t? 'proficient'\r\n\t\t\t\t: character.proficiencies.skills[skill] === 0.5\r\n\t\t\t\t? 'half-proficient'\r\n\t\t\t\t: 'none';\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"skill\" onClick={e => this.handleClick(e, 0)}>\r\n\t\t\t\t<div className=\"popup-advantage\" onClick={e => this.handleClick(e, 1)}>\r\n\t\t\t\t\tA\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"popup-disadvantage\" onClick={e => this.handleClick(e, -1)}>\r\n\t\t\t\t\tD\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"skill-wrapper\">\r\n\t\t\t\t\t<div className={`skill-proficiency ${proficiencyClass}`} />\r\n\t\t\t\t\t<div className=\"skill-ability\">{Rules.getShortAbilityName(ability)}</div>\r\n\t\t\t\t\t<div className=\"skill-title\">{Rules.getLongSkillName(skill)}</div>\r\n\t\t\t\t\t<div className=\"skill-modifier\">\r\n\t\t\t\t\t\t<div className=\"skill-symbol\">{modifier < 0 ? '-' : '+'}</div>\r\n\t\t\t\t\t\t<div className=\"skill-number\">{Math.abs(modifier)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\tgetSkillModifier(character: Character, skill: string, ability: string): number {\r\n\t\tconst baseModifier = Math.floor((character[ability] - 10) / 2);\r\n\t\tconst proficiencyMultiplier = character.proficiencies.skills[skill] || 0;\r\n\t\tconst proficiencyBonus = Rules.getProficiencyBonus(character);\r\n\t\treturn baseModifier + Math.floor(proficiencyMultiplier * proficiencyBonus);\r\n\t}\r\n\r\n\thandleClick(e, advantage: number): void {\r\n\t\tconst modifier = this.getSkillModifier(\r\n\t\t\tthis.props.character,\r\n\t\t\tthis.props.skill,\r\n\t\t\tthis.props.ability\r\n\t\t);\r\n\t\tconst modifierStr = (modifier < 0 ? '' : '+') + modifier;\r\n\t\tconst roll = new DiceRoll('d20' + modifierStr);\r\n\t\tconst stat = this.props.ability;\r\n\r\n\t\tconst data: RollData = {\r\n\t\t\ttype: 'roll',\r\n\t\t\trollType: 'Skill',\r\n\t\t\trollName: `${this.props.skill} (${this.props.ability})`,\r\n\t\t\tmodifier: modifierStr,\r\n\t\t\troll1Total: roll.total,\r\n\t\t\troll1Details: roll.toString().match(/.*?: (.*?) =/)[1],\r\n\t\t\troll1CritSuccess: roll.rolls[0][0] === 20,\r\n\t\t\troll1CritFail: roll.rolls[0][0] === 1\r\n\t\t};\r\n\r\n\t\tif (advantage) {\r\n\t\t\tconst roll2 = new DiceRoll('d20' + modifierStr);\r\n\t\t\tdata.rollAdvantageType = advantage;\r\n\t\t\tdata.roll2Total = roll2.total;\r\n\t\t\tdata.roll2Details = roll2.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\tdata.roll2CritSuccess = roll2.rolls[0][0] === 20;\r\n\t\t\tdata.roll2CritFail = roll2.rolls[0][0] === 1;\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\tthis.props.sendMessage('', data);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\n\r\ninterface Props {\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class ProficiencyBonus extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\t\tconst modifier = Rules.getProficiencyBonus(character);\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"proficiency\">\r\n\t\t\t\t<div className=\"proficiency-title\">Proficiency</div>\r\n\t\t\t\t<div className=\"proficiency-modifier\">\r\n\t\t\t\t\t<div className=\"proficiency-symbol\">+</div>\r\n\t\t\t\t\t<div className=\"proficiency-number\">{modifier}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\n\r\ninterface Props {\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class Speed extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\r\n\t\tconst movementTypes = [];\r\n\t\tfor (const movementType of Object.keys(character.speed)) {\r\n\t\t\tmovementTypes.push(\r\n\t\t\t\t<div className=\"speed-container\" key={movementType}>\r\n\t\t\t\t\t<div className=\"speed-popup-wrap\">\r\n\t\t\t\t\t\t<span className=\"speed-number\">{character.speed[movementType]}</span>\r\n\t\t\t\t\t\t<span className=\"speed-unit\">ft.</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"speed-type\">{movementType}</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"speed\">\r\n\t\t\t\t<div className=\"speed-title\">Speed</div>\r\n\t\t\t\t<div className=\"speed-container\">\r\n\t\t\t\t\t<span className=\"speed-number\">{character.speed.walk}</span>\r\n\t\t\t\t\t<span className=\"speed-unit\">ft.</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"speed-popup\">\r\n\t\t\t\t\t<div className=\"speed-title\">Speed</div>\r\n\t\t\t\t\t{movementTypes}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\nimport { RollData, ChatMessageData } from '../../../models/ChatMessage';\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class Initiative extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\t\tconst modifier = Rules.getInitiativeModifier(character);\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"initiative\" onClick={e => this.handleClick(e, 0)}>\r\n\t\t\t\t<div className=\"popup-advantage\" onClick={e => this.handleClick(e, 1)}>\r\n\t\t\t\t\tA\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"popup-disadvantage\" onClick={e => this.handleClick(e, -1)}>\r\n\t\t\t\t\tD\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"initiative-title\">Initiative</div>\r\n\t\t\t\t<div className=\"initiative-modifier\">\r\n\t\t\t\t\t<div className=\"initiative-symbol\">{modifier < 0 ? '-' : '+'}</div>\r\n\t\t\t\t\t<div className=\"initiative-number\">{Math.abs(modifier)}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\thandleClick(e, advantage: number): void {\r\n\t\tconst modifier = Rules.getInitiativeModifier(this.props.character);\r\n\t\tconst modifierStr = (modifier < 0 ? '' : '+') + modifier;\r\n\t\tconst roll = new DiceRoll('d20' + modifierStr);\r\n\r\n\t\tconst data: RollData = {\r\n\t\t\ttype: 'roll',\r\n\t\t\trollType: 'Initiative',\r\n\t\t\trollName: 'Initiative',\r\n\t\t\tmodifier: modifierStr,\r\n\t\t\troll1Total: roll.total,\r\n\t\t\troll1Details: roll.toString().match(/.*?: (.*?) =/)[1],\r\n\t\t\troll1CritSuccess: roll.rolls[0][0] === 20,\r\n\t\t\troll1CritFail: roll.rolls[0][0] === 1\r\n\t\t};\r\n\r\n\t\tif (advantage) {\r\n\t\t\tconst roll2 = new DiceRoll('d20' + modifierStr);\r\n\t\t\tdata.rollAdvantageType = advantage;\r\n\t\t\tdata.roll2Total = roll2.total;\r\n\t\t\tdata.roll2Details = roll2.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\tdata.roll2CritSuccess = roll2.rolls[0][0] === 20;\r\n\t\t\tdata.roll2CritFail = roll2.rolls[0][0] === 1;\r\n\t\t\te.stopPropagation();\r\n\t\t}\r\n\r\n\t\tthis.props.sendMessage('', data);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\n\r\ninterface Props {\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class ArmorClass extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"ac\">\r\n\t\t\t\t<div className=\"ac-title\">AC</div>\r\n\t\t\t\t<div className=\"ac-number\">{character.ac}</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\n\r\ninterface Props {\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class HitPoints extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"hp\">\r\n\t\t\t\t<div className=\"hp-title\">Hit Points</div>\r\n\t\t\t\t<div className=\"hp-current\">\r\n\t\t\t\t\t<span>{character.hp}</span>\r\n\t\t\t\t\t<span className=\"hp-header\">Current</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"hp-divider\">/</div>\r\n\t\t\t\t<div className=\"hp-max\">\r\n\t\t\t\t\t<span>{character.maxHp}</span>\r\n\t\t\t\t\t<span className=\"hp-header\">Max</span>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Attack, AttackEffectType, ToHitAttackEffect, DamageAttackEffect } from '../5eRules';\r\nimport {\r\n\tChatMessageData,\r\n\tCharacterActionData,\r\n\tCharacterActionResultType,\r\n\tCharacterActionDiceRollResult,\r\n\tAdvantageType\r\n} from '../../../models/ChatMessage';\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tattack: Attack;\r\n}\r\ninterface State {}\r\n\r\nexport default class AttackBlock extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t\tthis.handleClick = this.handleClick.bind(this);\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { attack } = this.props;\r\n\t\tconst toHitEffect: ToHitAttackEffect = attack.effects.filter(\r\n\t\t\tx => x.type === AttackEffectType.ToHit\r\n\t\t)[0] as ToHitAttackEffect;\r\n\t\tconst damageEffect: DamageAttackEffect = attack.effects.filter(\r\n\t\t\tx => x.type === AttackEffectType.Damage\r\n\t\t)[0] as DamageAttackEffect;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"attack\" onClick={e => this.handleClick(e, 0)}>\r\n\t\t\t\t{toHitEffect && (\r\n\t\t\t\t\t<div className=\"popup-advantage\" onClick={e => this.handleClick(e, 1)}>\r\n\t\t\t\t\t\tA\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t{toHitEffect !== undefined && (\r\n\t\t\t\t\t<div className=\"popup-disadvantage\" onClick={e => this.handleClick(e, -1)}>\r\n\t\t\t\t\t\tD\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className=\"attack-name\">\r\n\t\t\t\t\t<span>{attack.name}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"attack-range\">{attack.range} ft.</div>\r\n\t\t\t\t<div className=\"attack-toHit\">\r\n\t\t\t\t\t{toHitEffect && (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"attack-toHit-symbol\">\r\n\t\t\t\t\t\t\t\t{toHitEffect.modifier < 0 ? '-' : '+'}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"attack-toHit-number\">\r\n\t\t\t\t\t\t\t\t{Math.abs(toHitEffect.modifier)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{/*attack.saveDC !== undefined && (\r\n\t\t\t\t\t\t<div className=\"attack-toHit-number\">\r\n\t\t\t\t\t\t\tDC {attack.saveDC} {Rules.getShortAbilityName(attack.saveType)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)*/}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"attack-damage\">\r\n\t\t\t\t\t{damageEffect.diceCount}d{damageEffect.diceType}+{damageEffect.bonus || 0}{' '}\r\n\t\t\t\t\t{damageEffect.damageType}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"attack-notes\">Notes</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\thandleClick(e, advantage: number): void {\r\n\t\tconst attack = this.props.attack;\r\n\t\tlet crit = false;\r\n\r\n\t\tconst data: CharacterActionData = {\r\n\t\t\ttype: 'action',\r\n\t\t\ttitle: attack.name,\r\n\t\t\tresults: []\r\n\t\t};\r\n\r\n\t\tfor (const effect of attack.effects) {\r\n\t\t\tswitch (effect.type) {\r\n\t\t\t\tcase AttackEffectType.ToHit:\r\n\t\t\t\t\tconst toHitEffect = effect as ToHitAttackEffect;\r\n\t\t\t\t\tconst modifierStr =\r\n\t\t\t\t\t\t(toHitEffect.modifier < 0 ? '' : '+') + toHitEffect.modifier;\r\n\t\t\t\t\tconst result: CharacterActionDiceRollResult = {\r\n\t\t\t\t\t\tadvantage: advantage,\r\n\t\t\t\t\t\tmodifier: toHitEffect.modifier,\r\n\t\t\t\t\t\ttype: CharacterActionResultType.DiceRoll,\r\n\t\t\t\t\t\trolls: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst roll1 = new DiceRoll('d20' + modifierStr);\r\n\t\t\t\t\tconst roll1Details = roll1.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\t\t\tconst roll1CritSuccess = roll1.rolls[0][0] === (toHitEffect.critRange || 20);\r\n\t\t\t\t\tconst roll1CritFail = roll1.rolls[0][0] === 1;\r\n\r\n\t\t\t\t\tlet roll2: DiceRoll;\r\n\t\t\t\t\tlet roll2Details: string;\r\n\t\t\t\t\tlet roll2CritSuccess: boolean;\r\n\t\t\t\t\tlet roll2CritFail: boolean;\r\n\t\t\t\t\tif (advantage) {\r\n\t\t\t\t\t\troll2 = new DiceRoll('d20' + modifierStr);\r\n\t\t\t\t\t\troll2Details = roll2.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\t\t\t\troll2CritSuccess = roll2.rolls[0][0] === (toHitEffect.critRange || 20);\r\n\t\t\t\t\t\troll2CritFail = roll2.rolls[0][0] === 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcrit =\r\n\t\t\t\t\t\tadvantage >= 0\r\n\t\t\t\t\t\t\t? roll1CritSuccess || roll2CritSuccess\r\n\t\t\t\t\t\t\t: roll1CritSuccess && roll2CritSuccess;\r\n\r\n\t\t\t\t\tresult.rolls.push({\r\n\t\t\t\t\t\ttotal: roll1.total,\r\n\t\t\t\t\t\tcritFail: roll1CritFail,\r\n\t\t\t\t\t\tcritSuccess: roll1CritSuccess,\r\n\t\t\t\t\t\tdetails: roll1Details,\r\n\t\t\t\t\t\tignore:\r\n\t\t\t\t\t\t\t(roll2 || false) &&\r\n\t\t\t\t\t\t\t((advantage > 0 && roll1.total < roll2.total) ||\r\n\t\t\t\t\t\t\t\troll1.total > roll2.total)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (roll2) {\r\n\t\t\t\t\t\tresult.rolls.push({\r\n\t\t\t\t\t\t\ttotal: roll2.total,\r\n\t\t\t\t\t\t\tcritFail: roll2CritFail,\r\n\t\t\t\t\t\t\tcritSuccess: roll2CritSuccess,\r\n\t\t\t\t\t\t\tdetails: roll2Details,\r\n\t\t\t\t\t\t\tignore:\r\n\t\t\t\t\t\t\t\t(advantage > 0 && roll1.total >= roll2.total) ||\r\n\t\t\t\t\t\t\t\troll1.total <= roll2.total\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdata.results.push(result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase AttackEffectType.Damage:\r\n\t\t\t\t\tconst damageEffect = effect as DamageAttackEffect;\r\n\t\t\t\t\tconst damageRoll = new DiceRoll(\r\n\t\t\t\t\t\t`${damageEffect.diceCount * (crit ? 2 : 1)}d${\r\n\t\t\t\t\t\t\tdamageEffect.diceType\r\n\t\t\t\t\t\t}+${damageEffect.bonus || 0}`\r\n\t\t\t\t\t);\r\n\t\t\t\t\tconst result2: CharacterActionDiceRollResult = {\r\n\t\t\t\t\t\tadvantage: AdvantageType.None,\r\n\t\t\t\t\t\tmodifier: damageEffect.bonus,\r\n\t\t\t\t\t\ttype: CharacterActionResultType.DiceRoll,\r\n\t\t\t\t\t\trolls: []\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst damageRollDetails = damageRoll.toString().match(/.*?: (.*?) =/)[1];\r\n\t\t\t\t\tresult2.rolls.push({\r\n\t\t\t\t\t\tcritFail: false,\r\n\t\t\t\t\t\tcritSuccess: false,\r\n\t\t\t\t\t\tdetails: damageRollDetails,\r\n\t\t\t\t\t\tignore: false,\r\n\t\t\t\t\t\ttotal: damageRoll.total\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdata.results.push(result2);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(`Unexpected attack effect ${effect.type}.`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.props.sendMessage('', data);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport './Attacks.css';\r\nimport { Character } from '../Character';\r\nimport Rules from '../5eRules';\r\nimport AttackBlock from './AttackBlock';\r\nimport { ChatMessageData } from '../../../models/ChatMessage';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class Attacks extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\r\n\t\tconst attacks = Rules.getAttacks(character).map(attack => (\r\n\t\t\t<AttackBlock key={attack.name} attack={attack} {...this.props} />\r\n\t\t));\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"attacks\">\r\n\t\t\t\t<div className=\"attack-container\">\r\n\t\t\t\t\t<div className=\"attack-header\">\r\n\t\t\t\t\t\t<span className=\"attack-name\">Attack</span>\r\n\t\t\t\t\t\t<span className=\"attack-range\">Range</span>\r\n\t\t\t\t\t\t<span className=\"attack-toHit\">To Hit</span>\r\n\t\t\t\t\t\t<span className=\"attack-damage\">Damage</span>\r\n\t\t\t\t\t\t<span className=\"attack-notes\">Notes</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{attacks}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"attacks-title\">Attacks</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\n// import firebase from 'firebase/app';\r\n// import 'firebase/firestore';\r\n// import FirebaseConfig from '../../firebase-config.json';\r\n\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\nimport { RollData, ChatMessageData } from '../../../models/ChatMessage';\r\nimport AbilityScore from './AbilityScore';\r\nimport AbilitySave from './AbilitySave';\r\n\r\nimport './CharacterSheet.css';\r\nimport { Character } from '../Character';\r\nimport Skill from './Skill';\r\nimport ProficiencyBonus from './ProficiencyBonus';\r\nimport Speed from './Speed';\r\nimport Initiative from './Initiative';\r\nimport ArmorClass from './ArmorClass';\r\nimport HitPoints from './HitPoints';\r\nimport Attacks from './Attacks';\r\n\r\ninterface Props {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tcloseCharacterSheet: (characterid: string) => void;\r\n\tcharacter: Character;\r\n}\r\ninterface State {}\r\n\r\nexport default class CharacterSheet extends React.Component<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {};\r\n\t}\r\n\r\n\t// private chatRoom: firebase.firestore.CollectionReference;\r\n\r\n\t// private cleanup: () => void;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { character } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"column character-sheet\">\r\n\t\t\t\t<div className=\"character-close\" onClick={e => this.closeSheet()}>\r\n\t\t\t\t\tX\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row character-details\">\r\n\t\t\t\t\t<div className=\"character-name\">{character.name}</div>\r\n\t\t\t\t\t<div className=\"character-classes\">\r\n\t\t\t\t\t\t{character.levels.map(x => `${x.className} ${x.level}`).join(', ')}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"ability-container\">\r\n\t\t\t\t\t\t<AbilityScore ability=\"strength\" character={character} {...this.props} />\r\n\t\t\t\t\t\t<AbilityScore ability=\"dexterity\" character={character} {...this.props} />\r\n\t\t\t\t\t\t<AbilityScore\r\n\t\t\t\t\t\t\tability=\"constitution\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<AbilityScore\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<AbilityScore ability=\"wisdom\" character={character} {...this.props} />\r\n\t\t\t\t\t\t<AbilityScore ability=\"charisma\" character={character} {...this.props} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<ProficiencyBonus character={character} {...this.props} />\r\n\t\t\t\t\t<Speed character={character} {...this.props} />\r\n\t\t\t\t\t<HitPoints character={character} {...this.props} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"column\">\r\n\t\t\t\t\t\t<div className=\"save-container\">\r\n\t\t\t\t\t\t\t<AbilitySave ability=\"strength\" character={character} {...this.props} />\r\n\t\t\t\t\t\t\t<AbilitySave\r\n\t\t\t\t\t\t\t\tability=\"dexterity\"\r\n\t\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<AbilitySave\r\n\t\t\t\t\t\t\t\tability=\"constitution\"\r\n\t\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<AbilitySave\r\n\t\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<AbilitySave ability=\"wisdom\" character={character} {...this.props} />\r\n\t\t\t\t\t\t\t<AbilitySave ability=\"charisma\" character={character} {...this.props} />\r\n\t\t\t\t\t\t\t<div className=\"section-title\">Saving Throws</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"skill-container\">\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"acrobatics\"\r\n\t\t\t\t\t\t\tability=\"dexterity\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"animalHandling\"\r\n\t\t\t\t\t\t\tability=\"wisdom\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"arcana\"\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"athletics\"\r\n\t\t\t\t\t\t\tability=\"strength\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"deception\"\r\n\t\t\t\t\t\t\tability=\"charisma\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"history\"\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"insight\"\r\n\t\t\t\t\t\t\tability=\"wisdom\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"intimidation\"\r\n\t\t\t\t\t\t\tability=\"charisma\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"investigation\"\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"medicine\"\r\n\t\t\t\t\t\t\tability=\"wisdom\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"nature\"\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"perception\"\r\n\t\t\t\t\t\t\tability=\"wisdom\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"performance\"\r\n\t\t\t\t\t\t\tability=\"charisma\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"persuasion\"\r\n\t\t\t\t\t\t\tability=\"charisma\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"religion\"\r\n\t\t\t\t\t\t\tability=\"intelligence\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"sleightOfHand\"\r\n\t\t\t\t\t\t\tability=\"dexterity\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"stealth\"\r\n\t\t\t\t\t\t\tability=\"dexterity\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Skill\r\n\t\t\t\t\t\t\tskill=\"survival\"\r\n\t\t\t\t\t\t\tability=\"wisdom\"\r\n\t\t\t\t\t\t\tcharacter={character}\r\n\t\t\t\t\t\t\t{...this.props}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<div className=\"section-title\">Skills</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"column\" style={{ flex: 1 }}>\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t<Initiative character={character} {...this.props} />\r\n\t\t\t\t\t\t\t<ArmorClass character={character} {...this.props} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t<Attacks character={character} {...this.props} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n\r\n\tcloseSheet(): void {\r\n\t\tthis.props.closeCharacterSheet(this.props.character.id);\r\n\t}\r\n}\r\n","export const types = {\r\n\tCHAT: {\r\n\t\tSYNC: 'CHAT.SYNC',\r\n\t\tSYNC_FAILED: 'CHAT.SYNC_FAILED',\r\n\t\tNEW: {\r\n\t\t\t// CHANGE: 'CHAT.NEW.CHANGE',\r\n\t\t\tSAVE: 'CHAT.NEW.SAVE'\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport const syncChatMessages = messages => ({\r\n\ttype: types.CHAT.SYNC,\r\n\tmessages\r\n});\r\n\r\n// export const changeNewMessage = message => ({\r\n// \ttype: types.CHAT.NEW.CHANGE,\r\n// \tmessage\r\n// });\r\n\r\nexport const saveNewMessage = (message, data) => ({\r\n\ttype: types.CHAT.NEW.SAVE,\r\n\tmessage,\r\n\tdata\r\n});\r\n\r\nexport const syncChatFailed = error => ({\r\n\ttype: types.CHAT.SYNC_FAILED,\r\n\terror\r\n});\r\n","export const types = {\r\n\tCHARACTERS: {\r\n\t\tOPEN_SHEET: 'CHARACTERS.OPEN_SHEET',\r\n\t\tCLOSE_SHEET: 'CHARACTERS.CLOSE_SHEET'\r\n\t}\r\n};\r\n\r\nexport const openCharacterSheet = (characterId: string) => ({\r\n\ttype: types.CHARACTERS.OPEN_SHEET,\r\n\tcharacterId\r\n});\r\n\r\nexport const closeCharacterSheet = (characterId: string) => ({\r\n\ttype: types.CHARACTERS.CLOSE_SHEET,\r\n\tcharacterId\r\n});\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport CharacterSheet from './CharacterSheet';\r\nimport { ChatMessageData } from '../../../models/ChatMessage';\r\n\r\nimport { saveNewMessage } from '../../../redux/actions/chat';\r\nimport { Character } from '../Character';\r\nimport { closeCharacterSheet } from '../../../redux/actions/characters';\r\n\r\nconst mapStateToProps = (state): any => ({\r\n\topenCharacterSheets: state.characters.openCharacterSheets,\r\n\tcharacters: state.characters.characters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch): any => ({\r\n\tsendMessage: (message, data?) => dispatch(saveNewMessage(message, data)),\r\n\tcloseCharacterSheet: characterId => dispatch(closeCharacterSheet(characterId))\r\n});\r\n\r\ninterface DispatchFromProps {\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tcloseCharacterSheet: (characterId: string) => void;\r\n}\r\n\r\ninterface StateFromProps {\r\n\topenCharacterSheets: string[];\r\n\tcharacters: Character[];\r\n}\r\n\r\n// interface OwnProps {}\r\n\r\ntype Props = DispatchFromProps & StateFromProps;\r\n\r\nclass CharacterSheetContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst characterSheets = [];\r\n\t\tfor (const characterId of this.props.openCharacterSheets) {\r\n\t\t\tcharacterSheets.push(\r\n\t\t\t\t<CharacterSheet\r\n\t\t\t\t\tkey={characterId}\r\n\t\t\t\t\tcharacter={this.props.characters.filter(x => x.id === characterId)[0]}\r\n\t\t\t\t\t{...this.props}\r\n\t\t\t\t/>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn <div>{characterSheets}</div>;\r\n\t}\r\n}\r\n\r\nexport default connect<StateFromProps, DispatchFromProps, void>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(CharacterSheetContainer);\r\n","import { AnyAction } from 'redux';\r\n\r\nexport const types = {\r\n\tSTORAGE: {\r\n\t\tSEND_FILE: 'STORAGE.SEND_FILE',\r\n\t\tSEND_FILE_SUCCESS: 'STORAGE.SEND_FILE_SUCCESS',\r\n\t\tSEND_FILE_FAILURE: 'STORAGE.SEND_FILE_FAILURE',\r\n\t\tSEND_FILE_PROGRESS: 'STORAGE.SEND_FILE_PROGRESS'\r\n\t}\r\n};\r\n\r\nexport const sendFile = (name: string, file: File, filePath: string): AnyAction => ({\r\n\ttype: types.STORAGE.SEND_FILE,\r\n\tname,\r\n\tfile,\r\n\tfilePath\r\n});\r\n\r\nexport const uploadProgress = progress => ({\r\n\ttype: types.STORAGE.SEND_FILE_PROGRESS,\r\n\tprogress\r\n});\r\nexport const uploadCompleted = () => ({\r\n\ttype: types.STORAGE.SEND_FILE_SUCCESS\r\n});\r\nexport const uploadFailed = error => ({\r\n\ttype: types.STORAGE.SEND_FILE_FAILURE,\r\n\terror\r\n});\r\n","import React, { Component, ReactNode } from 'react';\r\nimport uuidv4 from 'uuid/v4';\r\n\r\nimport styles from './ImageUploader.module.css';\r\n\r\ninterface State {\r\n\tfile: File;\r\n\tuploadName: string;\r\n}\r\ninterface Props {\r\n\tonUpload: (name: string, file: File, filePath: string) => void;\r\n\tprogress: number;\r\n\tinProgress: boolean;\r\n}\r\nexport default class ImageUploader extends Component<Props, State> {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tuploadName: '',\r\n\t\t\tfile: null\r\n\t\t};\r\n\r\n\t\tthis.onUpload = this.onUpload.bind(this);\r\n\t\tthis.onChangeFile = this.onChangeFile.bind(this);\r\n\t}\r\n\r\n\tonChangeFile(event): void {\r\n\t\tconst file = event.target.files[0];\r\n\t\tthis.setState({\r\n\t\t\tfile: file\r\n\t\t});\r\n\t}\r\n\r\n\tonUpload(event): void {\r\n\t\tif (!this.state.file) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!this.state.uploadName || this.state.uploadName.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst filePath = `uploads/${uuidv4()}`;\r\n\t\tthis.props.onUpload(this.state.uploadName, this.state.file, filePath);\r\n\t}\r\n\r\n\trender(): ReactNode {\r\n\t\treturn (\r\n\t\t\t<div className={styles.wrapper}>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tclassName={styles.fileInput}\r\n\t\t\t\t\t\tplaceholder=\"Upload Name\"\r\n\t\t\t\t\t\tonChange={event => this.setState({ uploadName: event.target.value })}\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tdisabled={this.props.inProgress}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<input onChange={this.onChangeFile} type=\"file\" />\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={styles.button}\r\n\t\t\t\t\t\tonClick={this.onUpload}\r\n\t\t\t\t\t\tdisabled={this.props.inProgress}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tUpload\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<progress className={styles.progressBar} max=\"100\" value={this.props.progress} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { sendFile } from '../../../../redux/actions/storage';\r\nimport ImageUploader from './ImageUploader';\r\n\r\ninterface StateProps {\r\n\tuploadProgress: number;\r\n\tuploading: boolean;\r\n}\r\ninterface DispatchProps {\r\n\tsendFile: (name: string, file: File, filePath: string) => void;\r\n}\r\n\r\ntype Props = StateProps & DispatchProps;\r\n\r\nclass ImageUploaderContainer extends Component<Props> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<ImageUploader\r\n\t\t\t\tonUpload={this.props.sendFile}\r\n\t\t\t\tprogress={this.props.uploadProgress}\r\n\t\t\t\tinProgress={this.props.uploading}\r\n\t\t\t/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tuploadProgress: state.storage.uploadProgress,\r\n\tuploading: state.storage.uploading\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\r\n\tsendFile: (name, file, filePath) => dispatch(sendFile(name, file, filePath))\r\n});\r\n\r\nexport default connect<StateProps, DispatchProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(ImageUploaderContainer);\r\n","import { AnyAction } from 'redux';\r\n\r\nexport const types = {\r\n\tLOGIN: {\r\n\t\tREQUEST: 'LOGIN.REQUEST',\r\n\t\tSUCCESS: 'LOGIN.SUCCESS',\r\n\t\tFAILURE: 'LOGIN.FAILURE'\r\n\t},\r\n\tLOGOUT: {\r\n\t\tREQUEST: 'LOGOUT.REQUEST',\r\n\t\tSUCCESS: 'LOGOUT.SUCCESS',\r\n\t\tFAILURE: 'LOGOUT.FAILURE'\r\n\t}\r\n};\r\n\r\nexport const login = (username: string, password: string): AnyAction => ({\r\n\ttype: types.LOGIN.REQUEST,\r\n\tusername,\r\n\tpassword\r\n});\r\n\r\nexport const loginSuccess = user => ({\r\n\ttype: types.LOGIN.SUCCESS,\r\n\tuser\r\n});\r\n\r\nexport const loginFailure = error => ({\r\n\ttype: types.LOGIN.FAILURE,\r\n\terror\r\n});\r\n\r\nexport const logout = () => ({\r\n\ttype: types.LOGOUT.REQUEST\r\n});\r\n\r\nexport const logoutSuccess = () => ({\r\n\ttype: types.LOGOUT.SUCCESS\r\n});\r\n\r\nexport const logoutFailure = error => ({\r\n\ttype: types.LOGOUT.FAILURE,\r\n\terror\r\n});\r\n","import React, { PureComponent, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport { login, logout } from '../../redux/actions/auth';\r\n\r\nimport styles from './Authentication.module.css';\r\n\r\ninterface StateProps {\r\n\tloggedIn: boolean;\r\n}\r\ninterface DispatchProps {\r\n\tlogin: (username: string, password: string) => void;\r\n\tlogout: () => void;\r\n}\r\n\r\ntype Props = StateProps & DispatchProps;\r\n\r\ninterface State {\r\n\tusername: string;\r\n\tpassword: string;\r\n}\r\n\r\nclass Authentication extends PureComponent<Props, State> {\r\n\tconstructor(props: Props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\tpassword: ''\r\n\t\t};\r\n\r\n\t\tthis.updateState = this.updateState.bind(this);\r\n\t\tthis.login = this.login.bind(this);\r\n\t}\r\n\r\n\tupdateState(prop, val): void {\r\n\t\tlet newState = {};\r\n\t\tnewState[prop] = val;\r\n\t\tthis.setState(newState);\r\n\t\t// ANnoying I couldn't use { [prop]: val }\r\n\t}\r\n\r\n\tlogin(): void {\r\n\t\tif (this.state.username.length === 0 || this.state.password.length === 0) {\r\n\t\t\t// TODO: Error\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.props.login(this.state.username, this.state.password);\r\n\t}\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { loggedIn, logout } = this.props;\r\n\r\n\t\tif (loggedIn) {\r\n\t\t\treturn <div />;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className={styles.wrapper}>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tlabel=\"Username\"\r\n\t\t\t\t\tonChange={evt => this.updateState('username', evt.target.value)}\r\n\t\t\t\t\tvalue={this.state.username}\r\n\t\t\t\t\tmargin=\"normal\"\r\n\t\t\t\t/>\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tlabel=\"Password\"\r\n\t\t\t\t\tonChange={evt => this.updateState('password', evt.target.value)}\r\n\t\t\t\t\tvalue={this.state.password}\r\n\t\t\t\t\tmargin=\"normal\"\r\n\t\t\t\t\tonKeyUp={event => {\r\n\t\t\t\t\t\tevent.keyCode === 13 && this.login(); // Quick login on enter if password is focused.\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={() => this.login()}>\r\n\t\t\t\t\tLogin\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tloggedIn: state.auth.loggedIn\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\r\n\tlogin: (username: string, password: string) => dispatch(login(username, password)),\r\n\tlogout: () => dispatch(logout())\r\n});\r\n\r\nexport default connect<StateProps, DispatchProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(Authentication);\r\n","import React, { ReactNode } from 'react';\r\nimport { ChatMessage } from '../../models/ChatMessage';\r\n\r\nimport styles from './Chat.module.css';\r\n\r\ninterface Props {\r\n\tmessage: ChatMessage;\r\n\tisOwner: boolean;\r\n}\r\nexport default class ChatMessageItem extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { message, isOwner } = this.props;\r\n\t\tconst username = message.sender || 'unknown';\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"message\" key={message.id}>\r\n\t\t\t\t<div className={styles.username}>{username} :</div>\r\n\t\t\t\t<div>{message.msg}</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { ReactNode } from 'react';\r\nimport { ChatMessage, RollData } from '../../models/ChatMessage';\r\n\r\ninterface Props {\r\n\tmessage: ChatMessage;\r\n}\r\nexport default class RollMessageItem extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { message } = this.props;\r\n\t\tconst data = message.data as RollData;\r\n\t\tlet className;\r\n\t\tswitch (data.rollType) {\r\n\t\t\tcase 'Skill':\r\n\t\t\t\tclassName = 'roll-skill';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Ability':\r\n\t\t\t\tclassName = 'roll-ability';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Initiative':\r\n\t\t\t\tclassName = 'roll-initiative';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Attack':\r\n\t\t\t\tclassName = 'roll-attack';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Ad-hoc':\r\n\t\t\tdefault:\r\n\t\t\t\tclassName = 'roll-adhoc';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tvar ignoreRoll1 =\r\n\t\t\t(data.rollAdvantageType > 0 && data.roll1Total < data.roll2Total) ||\r\n\t\t\t(data.rollAdvantageType < 0 && data.roll1Total > data.roll2Total);\r\n\t\tvar ignoreRoll2 = data.rollAdvantageType && !ignoreRoll1;\r\n\r\n\t\treturn (\r\n\t\t\t<div className={`roll-container ${className}`}>\r\n\t\t\t\t<div className=\"roll-header\">\r\n\t\t\t\t\t<span className=\"roll-user\">{message.sender}</span>\r\n\t\t\t\t\t<span className=\"roll-type\">{data.rollType}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"roll-title\">\r\n\t\t\t\t\t<span className=\"roll-name\">{data.rollName}</span>\r\n\t\t\t\t\t{data.modifier !== null && data.modifier !== undefined && (\r\n\t\t\t\t\t\t<span className=\"roll-modifier\">({data.modifier})</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"roll-rolls\">\r\n\t\t\t\t\t<div className={`roll-1 ${ignoreRoll1 ? 'ignore' : ''}`}>\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\t'summary ' +\r\n\t\t\t\t\t\t\t\t(data.roll1CritSuccess\r\n\t\t\t\t\t\t\t\t\t? 'crit'\r\n\t\t\t\t\t\t\t\t\t: data.roll1CritFail\r\n\t\t\t\t\t\t\t\t\t? 'critFail'\r\n\t\t\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<span className=\"roll-total\">{data.roll1Total}</span>\r\n\t\t\t\t\t\t\t<span className=\"roll-suffix\">{data.rollSuffix}</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span className=\"details\">{data.roll1Details}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{data.roll2Details && data.rollAdvantageType && (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\tdata.rollAdvantageType > 0 ? 'roll-advantage' : 'roll-disadvantage'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{data.rollAdvantageType > 0 ? 'A' : 'D'}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{data.roll2Details && (\r\n\t\t\t\t\t\t<div className={`roll-2 ${ignoreRoll2 ? 'ignore' : ''}`}>\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t\t\t'summary ' +\r\n\t\t\t\t\t\t\t\t\t(data.roll2CritSuccess\r\n\t\t\t\t\t\t\t\t\t\t? 'crit'\r\n\t\t\t\t\t\t\t\t\t\t: data.roll2CritFail\r\n\t\t\t\t\t\t\t\t\t\t? 'critFail'\r\n\t\t\t\t\t\t\t\t\t\t: '')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<span className=\"roll-total\">{data.roll2Total}</span>\r\n\t\t\t\t\t\t\t\t<span className=\"roll-suffix\">{data.rollSuffix}</span>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"details\">{data.roll2Details}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { ReactNode } from 'react';\r\nimport { CharacterActionDiceRollResult, AdvantageType } from '../../../models/ChatMessage';\r\n\r\ninterface Props {\r\n\tresult: CharacterActionDiceRollResult;\r\n}\r\n\r\nexport default class DiceRoll extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { result } = this.props;\r\n\r\n\t\tconst rolls = [];\r\n\t\tlet i = 0;\r\n\t\tfor (const roll of result.rolls) {\r\n\t\t\trolls.push(\r\n\t\t\t\t<div key={i++} className={`roll ${roll.ignore ? 'ignore' : ''}`}>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\t'summary ' +\r\n\t\t\t\t\t\t\t(roll.critSuccess ? 'crit' : roll.critFail ? 'critFail' : '')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"roll-total\">{roll.total}</span>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<span className=\"details\">{roll.details}</span>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\r\n\t\t\tif (result.advantage) {\r\n\t\t\t\trolls.push(\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={i++}\r\n\t\t\t\t\t\tclassName={\r\n\t\t\t\t\t\t\tresult.advantage === AdvantageType.Advantage\r\n\t\t\t\t\t\t\t\t? 'roll-advantage'\r\n\t\t\t\t\t\t\t\t: 'roll-disadvantage'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{result.advantage === AdvantageType.Advantage ? 'A' : 'D'}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn <div className={`roll-rolls`}>{rolls}</div>;\r\n\t}\r\n}\r\n","import React, { ReactNode } from 'react';\r\nimport { CharacterActionTextResult } from '../../../models/ChatMessage';\r\n\r\ninterface Props {\r\n\tresult: CharacterActionTextResult;\r\n}\r\n\r\nexport default class TextBlock extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { result } = this.props;\r\n\r\n\t\treturn <div className={`text`}>{result.text}</div>;\r\n\t}\r\n}\r\n","import React, { ReactNode } from 'react';\r\nimport {\r\n\tChatMessage,\r\n\tCharacterActionData,\r\n\tCharacterActionResultType,\r\n\tCharacterActionDiceRollResult,\r\n\tCharacterActionTextResult\r\n} from '../../../models/ChatMessage';\r\nimport DiceRoll from './DiceRoll';\r\nimport TextBlock from './TextBlock';\r\n\r\ninterface Props {\r\n\tmessage: ChatMessage;\r\n}\r\n\r\nexport default class CharacterAction extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { message } = this.props;\r\n\t\tconst data = message.data as CharacterActionData;\r\n\r\n\t\tconst details = [];\r\n\t\tfor (const idx in data.results) {\r\n\t\t\tconst result = data.results[idx];\r\n\t\t\tswitch (result.type) {\r\n\t\t\t\tcase CharacterActionResultType.Text:\r\n\t\t\t\t\tdetails.push(\r\n\t\t\t\t\t\t<TextBlock key={idx} result={result as CharacterActionTextResult} />\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase CharacterActionResultType.DiceRoll:\r\n\t\t\t\t\tdetails.push(\r\n\t\t\t\t\t\t<DiceRoll key={idx} result={result as CharacterActionDiceRollResult} />\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(`Unknown result type ${result.type}.`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className={`character-action-container`}>\r\n\t\t\t\t<div className=\"action-header\">\r\n\t\t\t\t\t<span className=\"action-user\">{message.sender}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"action-title\">\r\n\t\t\t\t\t<span className=\"action-name\">{data.title}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t{details}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { ReactNode, ReactElement } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\n\r\nimport { DiceRoll } from 'rpg-dice-roller';\r\n\r\nimport styles from './Chat.module.css';\r\nimport './Roll.css';\r\nimport ChatMessageItem from './ChatMessageItem';\r\nimport RollMessageItem from './RollMessageItem';\r\nimport { ChatMessage, ChatMessageData, RollData } from '../../models/ChatMessage.js';\r\nimport Authentication from '../authentication/Authentication';\r\nimport CharacterAction from './characterActions/CharacterAction';\r\n\r\ninterface Props {\r\n\tmessages: ChatMessage[];\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n\tlogin: (username: string, password: string) => void;\r\n\tloggedIn: boolean;\r\n\tuser: firebase.User;\r\n}\r\ninterface State {\r\n\tmsg: string;\r\n\tmessages: ChatMessage[];\r\n}\r\nexport default class Chat extends React.Component<Props, State> {\r\n\tstate = {\r\n\t\tmsg: '',\r\n\t\tmessages: []\r\n\t};\r\n\r\n\tprivate scrollDiv: HTMLElement;\r\n\r\n\tcomponentDidUpdate(): void {\r\n\t\tthis.scrollToBottomOfChat();\r\n\t}\r\n\r\n\tcomponentDidMount(): void {\r\n\t\tthis.scrollToBottomOfChat();\r\n\t}\r\n\r\n\tscrollToBottomOfChat = (): void => {\r\n\t\tif (this.scrollDiv) {\r\n\t\t\tthis.scrollDiv.scrollTop = this.scrollDiv.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { messages } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div style={{ padding: '0 10px 10px 10px' }}>\r\n\t\t\t\t{!this.props.loggedIn ? (\r\n\t\t\t\t\t<Authentication />\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tstyle={\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t// display: 'flex',\r\n\t\t\t\t\t\t\t\t// flexDirection: 'column',\r\n\t\t\t\t\t\t\t\t// justifyContent: 'start-flex'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div style={{ paddingBottom: '15px' }}>\r\n\t\t\t\t\t\t\t<Authentication />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<h1 className={styles.chatHeader}>Chat</h1>\r\n\t\t\t\t\t\t<div className={styles.messageWrapper}>\r\n\t\t\t\t\t\t\t<div className={styles.messages} ref={cmpt => (this.scrollDiv = cmpt)}>\r\n\t\t\t\t\t\t\t\t{messages.map(\r\n\t\t\t\t\t\t\t\t\t(x, idx): ReactElement => {\r\n\t\t\t\t\t\t\t\t\t\tswitch (x.data && x.data.type) {\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'roll':\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn <RollMessageItem message={x} key={idx} />;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'action':\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn <CharacterAction message={x} key={idx} />;\r\n\t\t\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChatMessageItem\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage={x}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOwner={x.sender === this.props.user.email}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className={styles.chatInputWrapper}>\r\n\t\t\t\t\t\t\t\t{/* This could do with some work to not look so aweful */}\r\n\t\t\t\t\t\t\t\t<TextField\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"msg or d20+4 etc\"\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleMsgChange}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={this.handleKeyDown}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.msg}\r\n\t\t\t\t\t\t\t\t\tvariant=\"filled\"\r\n\t\t\t\t\t\t\t\t\tmargin=\"normal\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\thandleMsgChange = (e): void => {\r\n\t\tthis.setState({ msg: e.target.value });\r\n\t};\r\n\r\n\thandleKeyDown = (e): void => {\r\n\t\tif (e.key === 'Enter') {\r\n\t\t\tif (this.state.msg.match(/^\\d*?d(\\d+|%)/)) {\r\n\t\t\t\tconst roll = new DiceRoll(this.state.msg);\r\n\t\t\t\tconst data: RollData = {\r\n\t\t\t\t\ttype: 'roll',\r\n\t\t\t\t\trollType: 'Ad-hoc',\r\n\t\t\t\t\trollName: roll.notation,\r\n\t\t\t\t\tmodifier: null,\r\n\t\t\t\t\troll1Total: roll.total,\r\n\t\t\t\t\troll1Details: roll.toString().match(/.*?: (.*?) =/)[1],\r\n\t\t\t\t\troll1CritSuccess: false, // XXX\r\n\t\t\t\t\troll1CritFail: false // XXX\r\n\t\t\t\t};\r\n\t\t\t\tthis.props.sendMessage('', data);\r\n\t\t\t} else {\r\n\t\t\t\tthis.sendMessage(this.state.msg);\r\n\t\t\t}\r\n\t\t\tthis.setState({ msg: '' });\r\n\t\t}\r\n\t};\r\n\r\n\tsendMessage = (msg: string): void => {\r\n\t\tthis.props.sendMessage(msg);\r\n\t};\r\n}\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Chat from './Chat';\r\nimport { ChatMessage, ChatMessageData } from '../../models/ChatMessage';\r\n\r\nimport { saveNewMessage } from '../../redux/actions/chat';\r\nimport { login } from '../../redux/actions/auth';\r\n\r\nconst mapStateToProps = (state): any => ({\r\n\tmessages: state.chat.messages,\r\n\tloggedIn: state.auth.loggedIn,\r\n\tuser: state.auth.user\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch): any => ({\r\n\tsendMessage: (message, data?) => dispatch(saveNewMessage(message, data)),\r\n\tlogin: (username, password) => dispatch(login(username, password))\r\n});\r\n\r\ninterface DispatchFromProps {\r\n\tlogin: (username: string, password: string) => void;\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n}\r\n\r\ninterface StateFromProps {\r\n\tmessages: ChatMessage[];\r\n\tloggedIn: boolean;\r\n\tuser: firebase.User;\r\n}\r\n\r\n// interface OwnProps {}\r\n\r\ntype Props = DispatchFromProps & StateFromProps;\r\n\r\nclass ChatContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\treturn <Chat {...this.props} />;\r\n\t}\r\n}\r\n\r\nexport default connect<StateFromProps, DispatchFromProps, void>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(ChatContainer);\r\n","import React, { Component } from 'react';\r\n\r\ninterface Props {\r\n\tasset: any;\r\n}\r\nexport default class AssetListItem extends Component<Props> {\r\n\trender() {\r\n\t\tconst { asset } = this.props;\r\n\t\treturn <div>{asset.name || 'unknown'}</div>;\r\n\t}\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Asset } from '../../models/Asset';\r\nimport AssetListItem from './AssetListItem';\r\n\r\ninterface Props {\r\n\t// assets: Asset[];\r\n\tassets: any[];\r\n}\r\n\r\nexport default class AssetList extends Component<Props> {\r\n\trender() {\r\n\t\tconst { assets } = this.props;\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t{assets.map(x => (\r\n\t\t\t\t\t\t<AssetListItem asset={x} key={x.id} />\r\n\t\t\t\t\t))}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Asset } from '../../models/Asset';\r\nimport AssetList from './AssetList';\r\n\r\ninterface StateProps {\r\n\tassets: Asset[];\r\n}\r\ninterface DispatchProps {}\r\ninterface OwnProps {}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass AssetListContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { assets } = this.props;\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<h1>Asset List</h1>\r\n\t\t\t\t<AssetList assets={assets} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tassets: state.assets.assets\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(AssetListContainer);\r\n","import React, { Component, ReactNode, ReactElement } from 'react';\r\nimport { FormControl, InputLabel, Select, MenuItem, StyledComponentProps } from '@material-ui/core';\r\nimport { withStyles } from '@material-ui/core';\r\nimport { Upload } from '../../models/Upload';\r\n\r\nconst styles = (theme): any => ({\r\n\troot: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexWrap: 'wrap'\r\n\t},\r\n\tformControl: {\r\n\t\tmargin: theme.spacing.unit,\r\n\t\tminWidth: 120\r\n\t},\r\n\tselectEmpty: {\r\n\t\tmarginTop: theme.spacing.unit * 2\r\n\t}\r\n});\r\n\r\ninterface Props {\r\n\tclasses: any;\r\n\toptions: Upload[];\r\n\tonChange: (uploadId: string) => void;\r\n}\r\n\r\ninterface State {\r\n\tcurrent: string;\r\n}\r\n\r\nclass UploadSelector extends Component<Props, State> {\r\n\tstate = {\r\n\t\tcurrent: ''\r\n\t};\r\n\thandleChange = (event): void => {\r\n\t\tthis.setState({ current: event.target.value });\r\n\t\tif (this.props.onChange) {\r\n\t\t\tthis.props.onChange(event.target.value);\r\n\t\t}\r\n\t};\r\n\trender(): ReactNode {\r\n\t\tconst { classes, options } = this.props;\r\n\t\treturn (\r\n\t\t\t<FormControl className={classes.formControl}>\r\n\t\t\t\t<InputLabel htmlFor=\"upload-input\">Images</InputLabel>\r\n\t\t\t\t<Select\r\n\t\t\t\t\tvalue={this.state.current}\r\n\t\t\t\t\tonChange={this.handleChange}\r\n\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\tname: 'upload',\r\n\t\t\t\t\t\tid: 'upload-input'\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{options.map(\r\n\t\t\t\t\t\t(x: Upload): ReactElement => (\r\n\t\t\t\t\t\t\t<MenuItem key={x.id} value={x.id}>\r\n\t\t\t\t\t\t\t\t{x.name}\r\n\t\t\t\t\t\t\t</MenuItem>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Select>\r\n\t\t\t</FormControl>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(UploadSelector);\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { TextField, Button } from '@material-ui/core';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\nimport UploadSelector from './UploadSelector';\r\nimport { Upload } from '../../models/Upload';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport classNames from 'classnames';\r\nimport { Asset } from '../../models/Asset';\r\n\r\ninterface Props {\r\n\tuploads: Upload[];\r\n\tclasses: any;\r\n\tsaveNewAsset: (asset: Asset) => void;\r\n}\r\n\r\nconst styles = (theme): any => ({\r\n\tbutton: {\r\n\t\tmargin: theme.spacing.unit\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing.unit\r\n\t},\r\n\trightIcon: {\r\n\t\tmarginLeft: theme.spacing.unit\r\n\t},\r\n\ticonSmall: {\r\n\t\tfontSize: 20\r\n\t},\r\n\tnameInput: {\r\n\t\tmargin: theme.spacing.unit\r\n\t}\r\n});\r\n\r\nclass CreateAsset extends Component<Props> {\r\n\tonSave = (): void => {\r\n\t\tconst a: Asset = {\r\n\t\t\timageUrl: 'xyz',\r\n\t\t\ttype: 0\r\n\t\t};\r\n\t\tthis.props.saveNewAsset(a);\r\n\t};\r\n\r\n\tonChangeUpload = (uploadId: string): void => {};\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { classes, uploads } = this.props;\r\n\t\treturn (\r\n\t\t\t<div style={{ display: 'flex', flexDirection: 'column' }}>\r\n\t\t\t\t<h1>Create Asset</h1>\r\n\t\t\t\t<TextField label=\"Name\" margin=\"normal\" className={classes.nameInput} />\r\n\t\t\t\t<UploadSelector onChange={this.onChangeUpload} options={uploads} />\r\n\t\t\t\t<Button variant=\"contained\" className={classes.button} onClick={this.onSave}>\r\n\t\t\t\t\t<SaveIcon className={classNames(classes.leftIcon, classes.iconSmall)} />\r\n\t\t\t\t\tSave\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(CreateAsset);\r\n","import { Asset } from '../../models/Asset';\r\n\r\nexport const types = {\r\n\tASSETS: {\r\n\t\tSYNC: 'ASSETS.SYNC',\r\n\t\tSYNC_FAILED: 'ASSETS.SYNC_FAILED',\r\n\t\tNEW: {\r\n\t\t\tSAVE: 'ASSETS.NEW.SAVE'\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport const saveNewAsset = (asset: Asset) => ({\r\n\ttype: types.ASSETS.NEW.SAVE,\r\n\tasset\r\n});\r\n\r\nexport const syncAssets = assets => ({\r\n\ttype: types.ASSETS.SYNC,\r\n\tassets\r\n});\r\n\r\nexport const syncAssetsFailed = error => ({\r\n\ttype: types.ASSETS.SYNC_FAILED,\r\n\terror\r\n});\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport CreateAsset from './CreateAsset';\r\nimport { Asset } from '../../models/Asset';\r\nimport { Upload } from '../../models/Upload';\r\nimport { saveNewAsset } from '../../redux/actions/assets';\r\n\r\ninterface StateProps {\r\n\tassets: Asset[];\r\n\tuploads: Upload[];\r\n}\r\ninterface DispatchProps {\r\n\tsaveNewAsset: (asset: Asset) => void;\r\n}\r\ninterface OwnProps {}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass CreateAssetContainer extends Component<Props> {\r\n\trender() {\r\n\t\treturn <CreateAsset uploads={this.props.uploads} saveNewAsset={this.props.saveNewAsset} />;\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tassets: state.assets.assets,\r\n\tuploads: state.images.images\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\r\n\tsaveNewAsset: (asset: Asset) => dispatch(saveNewAsset(asset))\r\n});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(CreateAssetContainer);\r\n","import React, { Component } from 'react';\r\nimport { Button } from '@material-ui/core';\r\n\r\ninterface Props {\r\n\tloggedIn: boolean;\r\n\tlogout: () => void;\r\n}\r\nexport default class Settings extends Component<Props> {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<h1>Settings</h1>\r\n\t\t\t\t{this.props.loggedIn && (\r\n\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={this.props.logout}>\r\n\t\t\t\t\t\tLogout\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Settings from './Settings';\r\nimport { logout } from '../../redux/actions/auth';\r\n\r\ninterface StateProps {\r\n\tloggedIn: boolean;\r\n}\r\ninterface DispatchProps {\r\n\tlogout: () => void;\r\n}\r\ninterface OwnProps {}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass SettingsContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\treturn <Settings loggedIn={this.props.loggedIn} logout={this.props.logout} />;\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tloggedIn: state.auth.loggedIn\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\r\n\tlogout: () => dispatch(logout())\r\n});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(SettingsContainer);\r\n","import React, { ReactNode, ReactElement } from 'react';\r\n\r\nimport { Character } from './Character';\r\nimport { connect } from 'react-redux';\r\nimport { openCharacterSheet } from '../../redux/actions/characters';\r\n\r\nconst mapStateToProps = (state): any => ({\r\n\tcharacters: state.characters.characters\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch): any => ({\r\n\topenCharacterSheet: (characterId: string) => dispatch(openCharacterSheet(characterId))\r\n});\r\n\r\ninterface DispatchFromProps {\r\n\topenCharacterSheet: (characterId: string) => void;\r\n}\r\n\r\ninterface StateFromProps {\r\n\tcharacters: Character[];\r\n}\r\n\r\ntype Props = DispatchFromProps & StateFromProps;\r\n\r\nclass CharacterList extends React.Component<Props> {\r\n\trender(): ReactNode {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t{this.props.characters.map(x => (\r\n\t\t\t\t\t<div key={x.id} onClick={e => this.openCharacterSheet(x)}>\r\n\t\t\t\t\t\t{x.name}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\topenCharacterSheet(character: Character): void {\r\n\t\tthis.props.openCharacterSheet(character.id);\r\n\t}\r\n\r\n\tcomponentDidMount(): void {}\r\n\tcomponentWillUnmount(): void {}\r\n}\r\n\r\nexport default connect<StateFromProps, DispatchFromProps, void>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(CharacterList);\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { saveNewMessage } from '../../../../redux/actions/chat';\r\nimport { ChatMessageData } from '../../../../models/ChatMessage';\r\nimport CharacterList from '../../../5e/CharacterList';\r\n\r\nconst mapStateToProps = (state): any => ({\r\n\tmessages: state.chat.messages,\r\n\tloggedIn: state.auth.loggedIn,\r\n\tuser: state.auth.user\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch): any => ({\r\n\tsendMessage: (message, data?) => dispatch(saveNewMessage(message, data))\r\n});\r\n\r\ninterface DispatchFromProps {\r\n\tlogin: (username: string, password: string) => void;\r\n\tsendMessage: (message: string, data?: ChatMessageData) => void;\r\n}\r\n\r\ninterface StateFromProps {\r\n\tloggedIn: boolean;\r\n\tuser: firebase.User;\r\n}\r\n\r\n// interface OwnProps {}\r\n\r\ntype Props = DispatchFromProps & StateFromProps;\r\n\r\nclass ChatContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\treturn <CharacterList {...this.props} />;\r\n\t}\r\n}\r\n\r\nexport default connect<StateFromProps, DispatchFromProps, void>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(ChatContainer);\r\n","import React, { Component, ReactNode } from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport ChatContainer from '../chat/ChatContainer';\r\nimport ImageUploaderContainer from './panels/imageUploader/ImageUploaderContainer';\r\nimport AssetListContainer from '../assets/AssetListContainer';\r\nimport CreateAssetContainer from '../assets/CreateAssetContainer';\r\nimport SettingsContainer from '../settings/SettingsContainer';\r\nimport CharactersContainer from './panels/characters/CharactersContainer';\r\n\r\nexport default class Sidebar extends Component {\r\n\tstate = {\r\n\t\tvalue: 0\r\n\t};\r\n\r\n\thandleChange = (event, value): void => {\r\n\t\tthis.setState({ value });\r\n\t};\r\n\r\n\trender(): ReactNode {\r\n\t\tconst { value } = this.state;\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<AppBar position=\"static\">\r\n\t\t\t\t\t<Tabs variant=\"scrollable\" value={value} onChange={this.handleChange}>\r\n\t\t\t\t\t\t<Tab label=\"Chat\" />\r\n\t\t\t\t\t\t<Tab label=\"Characters\" />\r\n\t\t\t\t\t\t<Tab label=\"Upload\" />\r\n\t\t\t\t\t\t<Tab label=\"Assets\" />\r\n\t\t\t\t\t\t<Tab label=\"Settings\" />\r\n\t\t\t\t\t</Tabs>\r\n\t\t\t\t</AppBar>\r\n\t\t\t\t{value === 0 && <ChatContainer />}\r\n\t\t\t\t{value === 1 && <CharactersContainer />}\r\n\t\t\t\t{value === 2 && <ImageUploaderContainer />}\r\n\t\t\t\t{value === 3 && (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<CreateAssetContainer />\r\n\t\t\t\t\t\t<AssetListContainer />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t{value === 4 && <SettingsContainer />}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { withStyles, createStyles, Theme, WithStyles } from '@material-ui/core';\r\n\r\nconst styles = createStyles({\r\n\ttoolbarWrapper: {\r\n\t\tbackgroundColor: 'grey',\r\n\t\tpadding: '5px',\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tborderTopLeftRadius: '10px',\r\n\t\tborderTopRightRadius: '10px'\r\n\t},\r\n\ttoolbarButton: {\r\n\t\twidth: '5vh',\r\n\t\theight: '5vh',\r\n\t\tmargin: '5px',\r\n\t\tborder: 'none',\r\n\t\tborderRadius: '5px',\r\n\t\tboxShadow: '0px 2px 5px 0px rgba(0,0,0,0.5)',\r\n\t\tcursor: 'pointer',\r\n\t\t'&:hover': {\r\n\t\t\tbackground: 'rgba(190,190,190,0.5)'\r\n\t\t}\r\n\t}\r\n});\r\n\r\ninterface Props extends WithStyles<typeof styles> {}\r\n\r\nclass Toolbar extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.toolbarWrapper}>\r\n\t\t\t\t<button className={classes.toolbarButton}>Add Asset</button>\r\n\t\t\t\t<button className={classes.toolbarButton}>YY</button>\r\n\t\t\t\t<button className={classes.toolbarButton}>ZZ</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Toolbar);\r\n","import React, { Component, ReactNode, CSSProperties } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Toolbar from './Toolbar';\r\n\r\ninterface StateProps {}\r\ninterface DispatchProps {}\r\ninterface OwnProps {\r\n\tstyle?: CSSProperties;\r\n}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass ToolbarContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\treturn (\r\n\t\t\t<div style={this.props.style}>\r\n\t\t\t\t<Toolbar />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(ToolbarContainer);\r\n","import React, { Component } from 'react';\r\nimport { WithStyles, createStyles, withStyles } from '@material-ui/core';\r\n\r\nconst styles = createStyles({\r\n\tviewControlWrapper: {\r\n\t\tbackgroundColor: 'grey',\r\n\t\tpadding: '8px',\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'column',\r\n\t\tborderTopLeftRadius: '10px',\r\n\t\tborderBottomLeftRadius: '10px'\r\n\t},\r\n\tviewControlButton: {\r\n\t\twidth: '3vh',\r\n\t\theight: '3vh',\r\n\t\tmargin: '3px',\r\n\t\tborder: 'none',\r\n\t\tborderRadius: '5px',\r\n\t\tboxShadow: '0px 2px 5px 0px rgba(0,0,0,0.5)',\r\n\t\tcursor: 'pointer',\r\n\t\t'&:hover': {\r\n\t\t\tbackground: 'rgba(190,190,190,0.5)'\r\n\t\t}\r\n\t}\r\n});\r\n\r\ninterface Props extends WithStyles<typeof styles> {\r\n\tmapZoomIn: () => void;\r\n\tmapZoomOut: () => void;\r\n}\r\n\r\nclass ViewControls extends Component<Props> {\r\n\trender() {\r\n\t\tconst { classes, mapZoomIn, mapZoomOut } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.viewControlWrapper}>\r\n\t\t\t\t<button className={classes.viewControlButton} onClick={mapZoomIn}>\r\n\t\t\t\t\t+\r\n\t\t\t\t</button>\r\n\t\t\t\t<button className={classes.viewControlButton} onClick={mapZoomOut}>\r\n\t\t\t\t\t-\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(ViewControls);\r\n","export const types = {\r\n\tMAP: {\r\n\t\tZOOM: {\r\n\t\t\tIN: 'MAP.ZOOM.IN',\r\n\t\t\tOUT: 'MAP.ZOOM.OUT'\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport const zoomIn = () => ({\r\n\ttype: types.MAP.ZOOM.IN\r\n});\r\n\r\nexport const zoomOut = () => ({\r\n\ttype: types.MAP.ZOOM.OUT\r\n});\r\n","import React, { Component, ReactNode, CSSProperties } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport ViewControls from './ViewControls';\r\nimport { zoomIn, zoomOut } from '../../redux/actions/map';\r\n\r\ninterface StateProps {}\r\ninterface DispatchProps {\r\n\tmapZoomIn: () => void;\r\n\tmapZoomOut: () => void;\r\n}\r\ninterface OwnProps {\r\n\tstyle?: CSSProperties;\r\n}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass ViewControlsContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { mapZoomIn, mapZoomOut } = this.props;\r\n\t\treturn (\r\n\t\t\t<div style={this.props.style}>\r\n\t\t\t\t<ViewControls mapZoomIn={mapZoomIn} mapZoomOut={mapZoomOut} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({\r\n\tmapZoomIn: () => dispatch(zoomIn()),\r\n\tmapZoomOut: () => dispatch(zoomOut())\r\n});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(ViewControlsContainer);\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { Stage, Sprite, Container } from '@inlet/react-pixi';\r\nimport * as PIXI from 'pixi.js';\r\nimport Viewport from 'pixi-viewport';\r\n\r\nimport { MapData } from '../../models/Map';\r\nimport DraggableSprite from './DraggableSprite';\r\n\r\n/**\r\n * TODO:\r\n *      This class is really just a proof of concept at the moment\r\n * as a-lot is hard-coded.\r\n *\r\n * [ ] - Change to load sprites from the redux store\r\n * [ ] - On Drag Move update the local redux store only\r\n * [ ] - On Drag End update the Firestore with the new position\r\n * [ ] - Load Sprite images from FireStorage (but first need a way to upload to it)\r\n * [ ] - Create a custom Pixi component that can represent imported images\r\n */\r\n\r\ninterface Props {\r\n\tupdateSpriteLocation: (sprite: Sprite) => void;\r\n\tmapData?: MapData;\r\n\tzoom?: number;\r\n}\r\n\r\ninterface State {}\r\nexport default class Map extends Component<Props, State> {\r\n\tstate = {\r\n\t\tx: 300,\r\n\t\ty: 300,\r\n\t\talpha: 1.0,\r\n\t\tdragging: false,\r\n\t\tdata: null\r\n\t};\r\n\r\n\tprivate sprite: any;\r\n\tprivate app: any;\r\n\tprivate root: PIXI.Container;\r\n\r\n\tonMapMount = (app: PIXI.Application): void => {\r\n\t\tconst viewport = new Viewport({\r\n\t\t\tscreenWidth: window.innerWidth * 0.75,\r\n\t\t\tscreenHeight: window.innerHeight,\r\n\t\t\tworldWidth: 1000,\r\n\t\t\tworldHeight: 1000,\r\n\t\t\tinteraction: app.renderer.plugins.interaction\r\n\t\t});\r\n\r\n\t\tapp.renderer.autoResize = true;\r\n\t\tapp.renderer.view.style.position = 'absolute';\r\n\t\tapp.renderer.view.style.display = 'block';\r\n\t\tapp.renderer.resize(window.innerWidth * 0.75, window.innerHeight);\r\n\r\n\t\tapp.stage.addChild(viewport);\r\n\r\n\t\tviewport\r\n\t\t\t.drag({\r\n\t\t\t\tmouseButtons: 'right'\r\n\t\t\t})\r\n\t\t\t.pinch()\r\n\t\t\t.wheel()\r\n\t\t\t.decelerate();\r\n\r\n\t\t// var sprite = viewport.addChild(new PIXI.Sprite(PIXI.Texture.WHITE));\r\n\t\tvar sprite = viewport.addChild(\r\n\t\t\tPIXI.Sprite.fromImage(\r\n\t\t\t\t'https://firebasestorage.googleapis.com/v0/b/dnd-player-a7776.appspot.com/o/uploads%2F5e9a7b59-678a-477c-a18b-4739c9cb197a?alt=media&token=73ec57e9-87e2-44ca-9b08-4243d584cd91'\r\n\t\t\t)\r\n\t\t);\r\n\t\t// sprite.tint = 0xff0000;\r\n\t\tsprite.width = sprite.height = 100;\r\n\t\tsprite.anchor.set(0.5, 0.5);\r\n\t\tsprite.position.set(100, 100);\r\n\t\tsprite.interactive = true;\r\n\t\tsprite.cursor = 'pointer';\r\n\t\tsprite.on('mousedown', this.onDragStart);\r\n\t\tsprite.on('mousemove', this.onDragMove);\r\n\t\tsprite.on('mouseup', this.onDragEnd);\r\n\t\tsprite.on('mouseupoutside', this.onDragEnd);\r\n\t\tsprite.on(\r\n\t\t\t'mouseover',\r\n\t\t\t(event: PIXI.interaction.InteractionEvent): void => {\r\n\t\t\t\tconst x = event.currentTarget as PIXI.Sprite;\r\n\t\t\t\tif (x) {\r\n\t\t\t\t\tx.tint = 0xff0000;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\tsprite.on(\r\n\t\t\t'mouseout',\r\n\t\t\t(event: PIXI.interaction.InteractionEvent): void => {\r\n\t\t\t\tconst x = event.currentTarget as PIXI.Sprite;\r\n\t\t\t\tif (x) {\r\n\t\t\t\t\tx.tint = 0xffffff;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tvar s2 = viewport.addChild(\r\n\t\t\tPIXI.Sprite.fromImage(\r\n\t\t\t\t'https://firebasestorage.googleapis.com/v0/b/dnd-player-a7776.appspot.com/o/uploads%2F8b58cc32-ae8f-4ed9-ba32-21a23087050c?alt=media&token=cf5989aa-73c7-4c96-9aaa-95ab11649fa5'\r\n\t\t\t)\r\n\t\t);\r\n\t\ts2.width = s2.height = 150;\r\n\t\ts2.position.set(350, 400);\r\n\t\ts2.anchor.set(0.5, 0.5);\r\n\t\ts2.interactive = true;\r\n\t\ts2.cursor = 'pointer';\r\n\t};\r\n\r\n\tonDragStart = (e: PIXI.interaction.InteractionEvent): void => {\r\n\t\tconst inst = e.currentTarget;\r\n\t\tinst.alpha = 0.5;\r\n\t\t(inst as any).dragging = true;\r\n\t\t(inst as any).data = e.data;\r\n\t};\r\n\r\n\tonDragEnd = (e: PIXI.interaction.InteractionEvent): void => {\r\n\t\tconst inst = e.currentTarget;\r\n\t\tinst.alpha = 1.0;\r\n\t\t(inst as any).dragging = false;\r\n\t\t(inst as any).data = null;\r\n\t};\r\n\r\n\tonDragMove = (e: PIXI.interaction.InteractionEvent): void => {\r\n\t\tconst inst = e.currentTarget;\r\n\t\tif ((inst as any).dragging) {\r\n\t\t\tconst newPos = (inst as any).data.getLocalPosition(e.currentTarget.parent);\r\n\t\t\tinst.x = newPos.x;\r\n\t\t\tinst.y = newPos.y;\r\n\t\t}\r\n\t};\r\n\r\n\trender(): ReactNode {\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<Stage\r\n\t\t\t\t\tonMount={this.onMapMount}\r\n\t\t\t\t\twidth={window.innerWidth * 0.75}\r\n\t\t\t\t\theight={window.innerHeight}\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* <DraggableSprite image=\"https://firebasestorage.googleapis.com/v0/b/dnd-player-a7776.appspot.com/o/uploads%2Fa240f2d0-622a-4a5a-bb96-b512a08c1317?alt=media&token=bae496e7-8ea7-4a1c-a502-301aeb99f8da\" /> */}\r\n\t\t\t\t</Stage>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n","import React, { Component, ReactNode } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Map from './Map';\r\n\r\ninterface StateProps {\r\n\tzoom: number;\r\n}\r\ninterface DispatchProps {}\r\ninterface OwnProps {}\r\n\r\ntype Props = StateProps & DispatchProps & OwnProps;\r\n\r\nclass MapContainer extends Component<Props> {\r\n\trender(): ReactNode {\r\n\t\tconst { zoom } = this.props;\r\n\t\treturn <Map updateSpriteLocation={() => {}} zoom={zoom} />;\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (state): StateProps => ({\r\n\tzoom: state.map.zoom\r\n});\r\nconst mapDispatchToProps = (dispatch): DispatchProps => ({});\r\n\r\nexport default connect<StateProps, DispatchProps, OwnProps>(\r\n\tmapStateToProps,\r\n\tmapDispatchToProps\r\n)(MapContainer);\r\n","import { types } from '../actions/chat';\r\n\r\nconst initialState = {\r\n\tmessages: [],\r\n\tnew: {},\r\n\tsyncError: null\r\n};\r\n\r\nexport default function reducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.CHAT.SYNC:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tmessages: action.messages\r\n\t\t\t};\r\n\t\tcase types.CHAT.SYNC_FAILED:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsyncError: action.error\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { types } from '../actions/characters';\r\n\r\nconst initialState = {\r\n\topenCharacterSheets: [],\r\n\tcharacters: [\r\n\t\t{\r\n\t\t\tid: '1',\r\n\t\t\tname: 'Garrick Crownguard',\r\n\t\t\tsize: 'M',\r\n\t\t\tstrength: 25,\r\n\t\t\tdexterity: 12,\r\n\t\t\tconstitution: 18,\r\n\t\t\tintelligence: 9,\r\n\t\t\twisdom: 12,\r\n\t\t\tcharisma: 12,\r\n\t\t\tac: 19,\r\n\t\t\thp: 41,\r\n\t\t\tmaxHp: 87,\r\n\t\t\thitDice: 8,\r\n\t\t\tspeed: {\r\n\t\t\t\twalk: 30,\r\n\t\t\t\tclimb: 0,\r\n\t\t\t\tfly: 0\r\n\t\t\t},\r\n\t\t\tproficiencies: {\r\n\t\t\t\tsaves: {\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tconstitution: 1\r\n\t\t\t\t},\r\n\t\t\t\tskills: {\r\n\t\t\t\t\tathletics: 2,\r\n\t\t\t\t\tinsight: 1,\r\n\t\t\t\t\tintimidation: 1,\r\n\t\t\t\t\tperception: 1\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tlevels: [\r\n\t\t\t\t{\r\n\t\t\t\t\tclassName: 'Fighter',\r\n\t\t\t\t\tlevel: 8\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t]\r\n};\r\n\r\nexport default function reducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.CHARACTERS.OPEN_SHEET:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\topenCharacterSheets: [\r\n\t\t\t\t\t...state.openCharacterSheets.filter(x => x !== action.characterId),\r\n\t\t\t\t\taction.characterId\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\tcase types.CHARACTERS.CLOSE_SHEET:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\topenCharacterSheets: state.openCharacterSheets.filter(x => x !== action.characterId)\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { types } from '../actions/auth';\r\n\r\nconst initialState = {\r\n\tloading: false,\r\n\tloggedIn: false,\r\n\tuser: null,\r\n\tloginError: null\r\n};\r\n\r\nexport default function authReducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.LOGIN.REQUEST:\r\n\t\tcase types.LOGOUT.REQUEST:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tloading: true\r\n\t\t\t};\r\n\t\tcase types.LOGIN.SUCCESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tloading: false,\r\n\t\t\t\tloggedIn: true,\r\n\t\t\t\tuser: action.user,\r\n\t\t\t\tloginError: null\r\n\t\t\t};\r\n\t\tcase types.LOGIN.FAILURE:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tloading: false,\r\n\t\t\t\tloginError: action.error\r\n\t\t\t};\r\n\t\tcase types.LOGOUT.SUCCESS:\r\n\t\t\treturn initialState;\r\n\t\tcase types.LOGOUT.FAILURE:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tloading: false\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { types } from '../actions/storage';\r\nimport { stat } from 'fs';\r\n\r\nconst initialState = {\r\n\tuploading: false,\r\n\turl: null,\r\n\tuploadProgress: 0,\r\n\tuploadError: null\r\n};\r\n\r\nexport default function storageReducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.STORAGE.SEND_FILE:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tuploading: true\r\n\t\t\t};\r\n\t\tcase types.STORAGE.SEND_FILE_SUCCESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tuploading: false\r\n\t\t\t};\r\n\t\tcase types.STORAGE.SEND_FILE_FAILURE:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tuploading: false,\r\n\t\t\t\tuploadError: action.error\r\n\t\t\t};\r\n\t\tcase types.STORAGE.SEND_FILE_PROGRESS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tuploadProgress: action.progress\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","export const types = {\r\n\tIMAGES: {\r\n\t\tSYNC: 'IMAGES.SYNC',\r\n\t\tSYNC_FAILED: 'IMAGES.SYNC_FAILED'\r\n\t}\r\n};\r\n\r\nexport const syncImages = images => ({\r\n\ttype: types.IMAGES.SYNC,\r\n\timages\r\n});\r\n\r\nexport const syncImagesFailed = error => ({\r\n\ttype: types.IMAGES.SYNC_FAILED,\r\n\terror\r\n});\r\n","import { types } from '../actions/images';\r\n\r\nconst initialState = {\r\n\timages: [],\r\n\tsyncError: null\r\n};\r\n\r\nexport default function imagesReducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.IMAGES.SYNC:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\timages: action.images\r\n\t\t\t};\r\n\t\tcase types.IMAGES.SYNC_FAILED:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsyncError: action.error\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { types } from '../actions/assets';\r\n\r\nconst initialState = {\r\n\tassets: [],\r\n\tsyncError: null\r\n};\r\n\r\nexport default function assetsReducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.ASSETS.SYNC:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tassets: action.assets\r\n\t\t\t};\r\n\t\tcase types.ASSETS.SYNC_FAILED:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsyncError: action.error\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { types } from '../actions/map';\r\n\r\nconst initialState = {\r\n\tzoom: 1\r\n};\r\n\r\nexport default function mapReducer(state = initialState, action: any = {}) {\r\n\tswitch (action.type) {\r\n\t\tcase types.MAP.ZOOM.IN:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tzoom: state.zoom *= 1.2\r\n\t\t\t};\r\n\t\tcase types.MAP.ZOOM.OUT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tzoom: state.zoom *= 0.8\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { combineReducers } from 'redux';\r\nimport { connectRouter } from 'connected-react-router';\r\n\r\nimport ChatReducer from './chat';\r\nimport CharactersReducer from './characters';\r\nimport AuthReducer from './auth';\r\nimport StorageReducer from './storage';\r\nimport ImageReducer from './images';\r\nimport AssetReducer from './assets';\r\nimport MapReducer from './map';\r\n\r\nexport default history =>\r\n\tcombineReducers({\r\n\t\trouter: connectRouter(history),\r\n\t\tchat: ChatReducer,\r\n\t\tauth: AuthReducer,\r\n\t\tstorage: StorageReducer,\r\n\t\timages: ImageReducer,\r\n\t\tassets: AssetReducer,\r\n\t\tmap: MapReducer,\r\n\t\tcharacters: CharactersReducer\r\n\t});\r\n","import firebase from 'firebase';\r\n// import '@firebase/firestore';\r\nimport '@firebase/database';\r\nimport ReduxSagaFirebase from 'redux-saga-firebase';\r\n\r\nconst firebaseConfig = JSON.parse(localStorage.getItem('firebaseConfig'));\r\n\r\nconst firebaseApp = firebase.initializeApp(firebaseConfig);\r\nconst database = firebaseApp.database();\r\nconst rsf = new ReduxSagaFirebase(firebaseApp);\r\n\r\nexport default rsf;\r\n","import { all, call, fork, select, takeEvery } from 'redux-saga/effects';\r\n\r\nimport { types, syncChatMessages, syncChatFailed } from '../actions/chat';\r\n\r\nimport rsf from '../rsf';\r\nimport { database } from 'firebase';\r\n\r\nfunction* saveNewChatMessage(action): any {\r\n\t// const msg = yield select(state => state.chat.newMessage);\r\n\tconst currentUser: firebase.User = yield select(state => state.auth.user);\r\n\tconst msg = action.message || '';\r\n\tconst data = action.data || {};\r\n\r\n\tyield call(rsf.database.create, '/chatroom', {\r\n\t\tsender: currentUser.email,\r\n\t\t// timestamp: firestore.Timestamp.now(), // Firestore way\r\n\t\ttimestamp: database.ServerValue.TIMESTAMP, // Database way\r\n\t\tmsg,\r\n\t\tdata\r\n\t});\r\n}\r\n\r\nconst messageTransformer = ({ value }) =>\r\n\tObject.keys(value).map(key => ({\r\n\t\t...value[key],\r\n\t\tid: key\r\n\t}));\r\n\r\nfunction* syncMessagesSaga(): any {\r\n\tyield fork(\r\n\t\trsf.database.sync,\r\n\t\tdatabase(rsf.app)\r\n\t\t\t.ref('/chatroom')\r\n\t\t\t.orderByChild('timestamp') as any,\r\n\t\t{\r\n\t\t\tsuccessActionCreator: syncChatMessages,\r\n\t\t\tfailureActionCreator: syncChatFailed,\r\n\t\t\ttransform: messageTransformer\r\n\t\t},\r\n\t\t'value'\r\n\t);\r\n}\r\n\r\nexport default function* rootSaga() {\r\n\tyield all([fork(syncMessagesSaga), takeEvery(types.CHAT.NEW.SAVE, saveNewChatMessage)]);\r\n}\r\n","import firebase from 'firebase';\r\nimport { all, call, fork, put, take, takeEvery } from 'redux-saga/effects';\r\n\r\nimport { types, loginSuccess, loginFailure, logoutSuccess, logoutFailure } from '../actions/auth';\r\n\r\nimport rsf from '../rsf';\r\n\r\n// const authProvider = new firebase.auth.GoogleAuthProvider();\r\nconst emailAuthProvider = new firebase.auth.EmailAuthProvider();\r\n\r\nfunction* loginSaga(action): any {\r\n\t// yield put(loginSuccess(action.username));\r\n\ttry {\r\n\t\t// yield call(rsf.auth.signInWithPopup, emailAuthProvider);\r\n\t\t// yield call(rsf.auth.signInAnonymously);\r\n\t\tyield call(rsf.auth.signInWithEmailAndPassword, action.username, action.password);\r\n\t\t// successful login will trigger the loginStatusWatcher, which will update the state\r\n\t} catch (error) {\r\n\t\tyield put(loginFailure(error));\r\n\t}\r\n}\r\n\r\nfunction* logoutSaga(): any {\r\n\ttry {\r\n\t\tyield call(rsf.auth.signOut);\r\n\t\t// successful logout will trigger the loginStatusWatcher, which will update the state\r\n\t} catch (error) {\r\n\t\tyield put(logoutFailure(error));\r\n\t}\r\n}\r\n\r\nfunction* loginStatusWatcher(): any {\r\n\t// events on this channel fire when the user logs in or logs out\r\n\tconst channel = yield call(rsf.auth.channel);\r\n\r\n\twhile (true) {\r\n\t\tconst { user } = yield take(channel);\r\n\r\n\t\tif (user) yield put(loginSuccess(user));\r\n\t\telse yield put(logoutSuccess());\r\n\t}\r\n}\r\n\r\nexport default function* loginRootSaga(): any {\r\n\tyield fork(loginStatusWatcher);\r\n\tyield all([\r\n\t\ttakeEvery(types.LOGIN.REQUEST, loginSaga),\r\n\t\ttakeEvery(types.LOGOUT.REQUEST, logoutSaga)\r\n\t]);\r\n}\r\n","import { channel } from 'redux-saga';\r\nimport { all, call, put, take, select, fork, takeEvery } from 'redux-saga/effects';\r\nimport { database } from 'firebase';\r\n\r\nimport { types, uploadProgress } from '../actions/storage';\r\n\r\nimport { uploadCompleted, uploadFailed } from '../actions/storage';\r\n\r\nimport rsf from '../rsf';\r\n\r\nconst uploadFileChannel = channel();\r\n\r\nfunction* sendFileSaga(action): any {\r\n\tconst task = rsf.storage.uploadFile(action.filePath, action.file);\r\n\r\n\ttask.on('state_changed', snapshot => {\r\n\t\tconst pct = (snapshot.bytesTransferred * 100) / snapshot.totalBytes;\r\n\t\tconsole.log(`${pct}%`);\r\n\t\t// yield put(uploadProgress(pct));\r\n\t\tuploadFileChannel.put(uploadProgress(pct));\r\n\t});\r\n\r\n\tyield task;\r\n\r\n\ttry {\r\n\t\tconst url = yield call(rsf.storage.getDownloadURL, action.filePath);\r\n\r\n\t\t// Add an entry in the Realtime DB for this upload\r\n\t\tyield call(rsf.database.create, '/uploads', {\r\n\t\t\tfilePath: action.filePath,\r\n\t\t\tname: action.name,\r\n\t\t\tdownloadUrl: url,\r\n\t\t\tuploadTime: database.ServerValue.TIMESTAMP\r\n\t\t});\r\n\r\n\t\tyield put(uploadCompleted());\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\r\n\t\tyield put(uploadFailed(error));\r\n\t}\r\n}\r\n\r\nfunction* watchUploadProgressChannel(): any {\r\n\twhile (true) {\r\n\t\tconst action = yield take(uploadFileChannel);\r\n\t\tyield put(action);\r\n\t}\r\n}\r\n\r\nexport default function* rootSaga(): any {\r\n\tyield fork(watchUploadProgressChannel);\r\n\tyield all([takeEvery(types.STORAGE.SEND_FILE, sendFileSaga)]);\r\n}\r\n","import { all, call, fork, takeEvery } from 'redux-saga/effects';\r\n\r\nimport { types, syncImages, syncImagesFailed } from '../actions/images';\r\n\r\nimport rsf from '../rsf';\r\nimport { database } from 'firebase';\r\n\r\nconst imageTransformer = ({ value }) =>\r\n\tObject.keys(value).map(key => ({\r\n\t\t...value[key],\r\n\t\tid: key\r\n\t}));\r\n\r\nfunction* syncImagesSaga(): any {\r\n\tyield fork(\r\n\t\trsf.database.sync,\r\n\t\tdatabase(rsf.app)\r\n\t\t\t.ref('/uploads')\r\n\t\t\t.orderByChild('timestamp') as any,\r\n\t\t{\r\n\t\t\tsuccessActionCreator: syncImages,\r\n\t\t\tfailureActionCreator: syncImagesFailed,\r\n\t\t\ttransform: imageTransformer\r\n\t\t},\r\n\t\t'value'\r\n\t);\r\n}\r\n\r\nexport default function* rootSaga() {\r\n\tyield all([fork(syncImagesSaga)]);\r\n}\r\n","import { all, call, select, fork, takeEvery } from 'redux-saga/effects';\r\n\r\nimport { types, syncAssets, syncAssetsFailed } from '../actions/assets';\r\n\r\nimport rsf from '../rsf';\r\nimport { database } from 'firebase';\r\nimport { AnyAction } from 'redux';\r\n\r\nconst assetTransformer = ({ value }) =>\r\n\tObject.keys(value).map(key => ({\r\n\t\t...value[key],\r\n\t\tid: key\r\n\t}));\r\n\r\nfunction* saveNewAsset(action: AnyAction): any {\r\n\tconst currentUser: firebase.User = yield select(state => state.auth.user);\r\n\tconst asset = action.asset;\r\n\r\n\tyield call(rsf.database.create, '/assets', {\r\n\t\t...asset,\r\n\t\tcreator: currentUser.uid,\r\n\t\ttimestamp: database.ServerValue.TIMESTAMP\r\n\t});\r\n}\r\n\r\nfunction* syncAssetsSaga(): any {\r\n\tyield fork(\r\n\t\trsf.database.sync,\r\n\t\tdatabase(rsf.app)\r\n\t\t\t.ref('/assets')\r\n\t\t\t.orderByChild('name') as any,\r\n\t\t{\r\n\t\t\tsuccessActionCreator: syncAssets,\r\n\t\t\tfailureActionCreator: syncAssetsFailed,\r\n\t\t\ttransform: assetTransformer\r\n\t\t},\r\n\t\t'value'\r\n\t);\r\n}\r\n\r\nexport default function* rootSaga() {\r\n\tyield all([fork(syncAssetsSaga), takeEvery(types.ASSETS.NEW.SAVE, saveNewAsset)]);\r\n}\r\n","import { all, fork } from 'redux-saga/effects';\r\n\r\nimport chat from './chat';\r\nimport auth from './auth';\r\nimport storage from './storage';\r\nimport images from './images';\r\nimport assets from './assets';\r\n\r\nexport default function* rootSaga(): any {\r\n\tyield all([fork(chat), fork(auth), fork(storage), fork(images), fork(assets)]);\r\n}\r\n","import React from 'react';\r\nimport { createStore, applyMiddleware, compose } from 'redux';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport { routerMiddleware } from 'connected-react-router';\r\nimport { createBrowserHistory } from 'history';\r\n\r\nimport createRootReducer from './reducers/index';\r\nimport rootSaga from './sagas/index';\r\n\r\nexport const history = createBrowserHistory({\r\n\tbasename: process.env.PUBLIC_URL\r\n});\r\n\r\nconst sagaMiddleware = createSagaMiddleware();\r\n\r\nconst enhancers = [];\r\nconst middleware = [sagaMiddleware];\r\n\r\nconst composeEnhancers = (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nconst composedEnhancers = composeEnhancers(applyMiddleware(...middleware), ...enhancers);\r\n\r\nconst store = createStore(createRootReducer(history), {}, composedEnhancers);\r\n\r\nsagaMiddleware.run(rootSaga);\r\n\r\nexport default store;\r\n","import React, { Component, ReactNode, ReactElement } from 'react';\r\nimport { Switch, Route } from 'react-router';\r\nimport styles from './App.module.css';\r\n\r\nimport CharacterSheetContainer from './5e/characterSheet/CharacterSheetContainer';\r\nimport ImageUploaderContainer from './sidebar/panels/imageUploader/ImageUploaderContainer';\r\nimport Authentication from './authentication/Authentication';\r\nimport Sidebar from './sidebar/Sidebar';\r\nimport ToolbarContainer from './toolbar/ToolbarContainer';\r\nimport ViewControlsContainer from './toolbar/ViewControlsContainer';\r\nimport MapContainer from './map/MapContainer';\r\nimport { TextField, Button, MuiThemeProvider, createMuiTheme } from '@material-ui/core';\r\n\r\nimport { Provider } from 'react-redux';\r\nimport store, { history } from '../redux/store';\r\nimport { ConnectedRouter } from 'connected-react-router';\r\n\r\ninterface State {\r\n\tprojectName: string;\r\n\tapiKey: string;\r\n}\r\n\r\nclass App extends Component<{}, State> {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.configLoaded = !!localStorage.getItem('firebaseConfig');\r\n\r\n\t\tthis.state = {\r\n\t\t\tprojectName: '',\r\n\t\t\tapiKey: ''\r\n\t\t};\r\n\t}\r\n\r\n\tconfigLoaded: boolean;\r\n\r\n\trender(): ReactNode {\r\n\t\tconst theme = createMuiTheme({\r\n\t\t\tpalette: {\r\n\t\t\t\ttype: 'dark'\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (\r\n\t\t\t<Provider store={store}>\r\n\t\t\t\t<ConnectedRouter history={history}>\r\n\t\t\t\t\t<div className=\"App\">\r\n\t\t\t\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\texact\r\n\t\t\t\t\t\t\t\t\tpath=\"/\"\r\n\t\t\t\t\t\t\t\t\trender={(): ReactElement => (\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<MapContainer />\r\n\t\t\t\t\t\t\t\t\t\t\t<ToolbarContainer\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbottom: '0',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tleft: '35%',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttransform: 'translate(-50%, 0%)'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<ViewControlsContainer\r\n\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tright: '25vw',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttop: '10vh'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<CharacterSheetContainer />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className={styles.chatWrapper}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Sidebar />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\tpath=\"/upload\"\r\n\t\t\t\t\t\t\t\t\trender={(): ReactElement => <ImageUploaderContainer />}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\t\tpath=\"/login\"\r\n\t\t\t\t\t\t\t\t\trender={(): ReactElement => <Authentication />}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Switch>\r\n\t\t\t\t\t\t</MuiThemeProvider>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</ConnectedRouter>\r\n\t\t\t</Provider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n\twindow.location.hostname === 'localhost' ||\r\n\t\t// [::1] is the IPv6 localhost address.\r\n\t\twindow.location.hostname === '[::1]' ||\r\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\r\n\t\twindow.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\r\n);\r\n\r\nexport function register(config) {\r\n\tif (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n\t\t// The URL constructor is available in all browsers that support SW.\r\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n\t\tif (publicUrl.origin !== window.location.origin) {\r\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\r\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\r\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\twindow.addEventListener('load', () => {\r\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n\t\t\tif (isLocalhost) {\r\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\r\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\r\n\r\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\r\n\t\t\t\t// service worker/PWA documentation.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t'This web app is being served cache-first by a service ' +\r\n\t\t\t\t\t\t\t'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Is not localhost. Just register service worker\r\n\t\t\t\tregisterValidSW(swUrl, config);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n\tnavigator.serviceWorker\r\n\t\t.register(swUrl)\r\n\t\t.then(registration => {\r\n\t\t\tregistration.onupdatefound = () => {\r\n\t\t\t\tconst installingWorker = registration.installing;\r\n\t\t\t\tif (installingWorker == null) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tinstallingWorker.onstatechange = () => {\r\n\t\t\t\t\tif (installingWorker.state === 'installed') {\r\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\r\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\r\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\r\n\t\t\t\t\t\t\t// content until all client tabs are closed.\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t'New content is available and will be used when all ' +\r\n\t\t\t\t\t\t\t\t\t'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\r\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// At this point, everything has been precached.\r\n\t\t\t\t\t\t\t// It's the perfect time to display a\r\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\r\n\t\t\t\t\t\t\tconsole.log('Content is cached for offline use.');\r\n\r\n\t\t\t\t\t\t\t// Execute callback\r\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\r\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t};\r\n\t\t})\r\n\t\t.catch(error => {\r\n\t\t\tconsole.error('Error during service worker registration:', error);\r\n\t\t});\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n\t// Check if the service worker can be found. If it can't reload the page.\r\n\tfetch(swUrl)\r\n\t\t.then(response => {\r\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\r\n\t\t\tconst contentType = response.headers.get('content-type');\r\n\t\t\tif (\r\n\t\t\t\tresponse.status === 404 ||\r\n\t\t\t\t(contentType != null && contentType.indexOf('javascript') === -1)\r\n\t\t\t) {\r\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\r\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\t\t\tregistration.unregister().then(() => {\r\n\t\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Service worker found. Proceed as normal.\r\n\t\t\t\tregisterValidSW(swUrl, config);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(() => {\r\n\t\t\tconsole.log('No internet connection found. App is running in offline mode.');\r\n\t\t});\r\n}\r\n\r\nexport function unregister() {\r\n\tif ('serviceWorker' in navigator) {\r\n\t\tnavigator.serviceWorker.ready.then(registration => {\r\n\t\t\tregistration.unregister();\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { MuiThemeProvider, TextField, Button, createMuiTheme } from '@material-ui/core';\r\n\r\nconst state = {\r\n\tprojectName: '',\r\n\tapiKey: ''\r\n};\r\n\r\nconst saveConfig = (): void => {\r\n\tlocalStorage.setItem(\r\n\t\t'firebaseConfig',\r\n\t\tJSON.stringify({\r\n\t\t\tapiKey: state.apiKey,\r\n\t\t\tauthDomain: `${state.projectName}.firebaseapp.com`,\r\n\t\t\tdatabaseURL: `https://${state.projectName}.firebaseio.com`,\r\n\t\t\tprojectId: state.projectName,\r\n\t\t\tstorageBucket: `${state.projectName}.appspot.com`\r\n\t\t})\r\n\t);\r\n\r\n\twindow.location.reload();\r\n};\r\n\r\nif (localStorage.getItem('firebaseConfig') == null) {\r\n\tconst theme = createMuiTheme({\r\n\t\tpalette: {\r\n\t\t\ttype: 'dark'\r\n\t\t}\r\n\t});\r\n\r\n\tReactDOM.render(\r\n\t\t<div className=\"App\">\r\n\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t<div className=\"projectInputs\">\r\n\t\t\t\t\t<TextField\r\n\t\t\t\t\t\tlabel=\"Project Name\"\r\n\t\t\t\t\t\tplaceholder=\"dnd-player-b8372\"\r\n\t\t\t\t\t\tonChange={evt => (state.projectName = evt.target.value)}\r\n\t\t\t\t\t\tmargin=\"normal\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<TextField\r\n\t\t\t\t\t\tlabel=\"API Key\"\r\n\t\t\t\t\t\tplaceholder=\"AIzaSd***************pK5ao6g95Q-9auWt-8\"\r\n\t\t\t\t\t\tonChange={evt => (state.apiKey = evt.target.value)}\r\n\t\t\t\t\t\tmargin=\"normal\"\r\n\t\t\t\t\t\tonKeyUp={event => {\r\n\t\t\t\t\t\t\tevent.keyCode === 13 && this.saveConfig(); // Quick save on enter if API box is focused.\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button variant=\"contained\" color=\"primary\" onClick={() => saveConfig()}>\r\n\t\t\t\t\t\tSave\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</MuiThemeProvider>\r\n\t\t</div>,\r\n\t\tdocument.getElementById('root')\r\n\t);\r\n} else {\r\n\tconst App = require('./components/App').default;\r\n\tReactDOM.render(<App />, document.getElementById('root'));\r\n}\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chatinput\":\"Chat_chatinput__t09l3\",\"messageWrapper\":\"Chat_messageWrapper__aBXHq\",\"messages\":\"Chat_messages__1eOv3\",\"rollButton\":\"Chat_rollButton__2pWqq\",\"chat\":\"Chat_chat__3QwoS\",\"chatHeader\":\"Chat_chatHeader__pIhFX\",\"username\":\"Chat_username__6SOBQ\",\"chatInputWrapper\":\"Chat_chatInputWrapper__eio3O\"};"],"sourceRoot":""}