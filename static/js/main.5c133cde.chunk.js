(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){e.exports={wrapper:"EquipmentItem_wrapper__1gmMl",name:"EquipmentItem_name__JQKN0",quantity:"EquipmentItem_quantity__3fjZi",weight:"EquipmentItem_weight__IGS_H",notes:"EquipmentItem_notes__1ObZa"}},115:function(e,t,a){e.exports={item:"AssetListItem_item__FHViu",image:"AssetListItem_image__3AR_3",title:"AssetListItem_title__3GLMy"}},17:function(e,t,a){e.exports={row:"NonPlayerCharacterSheet_row__2WSWI",column:"NonPlayerCharacterSheet_column__1tRCs",popupAdvantage:"NonPlayerCharacterSheet_popupAdvantage__1W1CH",popupDisadvantage:"NonPlayerCharacterSheet_popupDisadvantage__1UDfA",characterSheet:"NonPlayerCharacterSheet_characterSheet__1ITIM","character-sheet":"NonPlayerCharacterSheet_character-sheet__uG1jQ",popout:"NonPlayerCharacterSheet_popout__3CCXN","character-close":"NonPlayerCharacterSheet_character-close__1Gi0k","character-popout":"NonPlayerCharacterSheet_character-popout__1shaV","character-cancel":"NonPlayerCharacterSheet_character-cancel__XFuZE",characterImageContainer:"NonPlayerCharacterSheet_characterImageContainer__3ssK9",characterName:"NonPlayerCharacterSheet_characterName__2Pk6i",characterType:"NonPlayerCharacterSheet_characterType__1hRFz",boldHeading:"NonPlayerCharacterSheet_boldHeading__iF3Wx",italicHeading:"NonPlayerCharacterSheet_italicHeading__21qNT",divider:"NonPlayerCharacterSheet_divider__11Rzp",abilityContainer:"NonPlayerCharacterSheet_abilityContainer__1_94c",ability:"NonPlayerCharacterSheet_ability__2qAo4",abilityTitle:"NonPlayerCharacterSheet_abilityTitle__1tqn_",skill:"NonPlayerCharacterSheet_skill__3oqJh",feature:"NonPlayerCharacterSheet_feature__3Pv2P",action:"NonPlayerCharacterSheet_action__vmiUS",subheading:"NonPlayerCharacterSheet_subheading__WYOtH",rollable:"NonPlayerCharacterSheet_rollable__2hCTt"}},221:function(e,t,a){e.exports={mapWrapper:"App_mapWrapper__w0tfJ",chatWrapper:"App_chatWrapper__2U1dO"}},341:function(e,t,a){e.exports={wrapper:"CharacterImage_wrapper__3sak9"}},342:function(e,t,a){e.exports={wrapper:"Authentication_wrapper__1wnUP",username:"Authentication_username__1zpTM",password:"Authentication_password__1usTz",loginButton:"Authentication_loginButton__36BHo",logoutButton:"Authentication_logoutButton__1QowG"}},428:function(e,t,a){e.exports=a(831)},433:function(e,t,a){},557:function(e,t,a){},56:function(e,t,a){},598:function(e,t,a){},71:function(e,t,a){e.exports={equipment:"Equipment_equipment__3cDCi",title:"Equipment_title__1QYuE",header:"Equipment_header__2uM8D",name:"Equipment_name__2M0UY",quantity:"Equipment_quantity__2AxDK",weight:"Equipment_weight__2FpQP",notes:"Equipment_notes__31VK1"}},830:function(e,t,a){"use strict";a.r(t);var r,n=a(4),c=a(5),i=a(7),s=a(6),l=a(8),o=a(0),u=a.n(o),p=a(61),m=a(221),h=a.n(m),d=a(36),f=a(12),v=a(38),b=a(35),g=(a(56),a(77));!function(e){e[e.Tremorsense=0]="Tremorsense",e[e.Darkvision=1]="Darkvision",e[e.Blindsight=2]="Blindsight",e[e.Truesight=3]="Truesight",e[e.Blind=4]="Blind"}(r||(r={}));var E,y,O=function(){function e(){Object(n.a)(this,e)}return Object(c.a)(e,null,[{key:"mapCharacterAttackEffect",value:function(e,t){var a=this.attackEffectMap[e.type];return a?a(e,t):{type:y.Text,text:"Unknown attack type ".concat(e.type,"!")}}},{key:"mapToHitCharacterEffect",value:function(e,t){var a=e;return{type:y.ToHit,modifier:C.getAbilityModifier(t,a.ability)+C.getProficiencyBonus(t),critRange:20}}},{key:"mapDamageCharacterEffect",value:function(e,t){var a=e;return{type:y.Damage,damageType:a.damageType,diceCount:a.diceCount,diceSize:a.diceSize,bonus:(a.bonus||0)+(a.ability?C.getAbilityModifier(t,a.ability):0)}}},{key:"mapSavingThrowCharacterEffect",value:function(t,a){var r=t;return{type:y.SavingThrow,saveType:r.saveType,saveDC:10+C.getAbilityModifier(a,r.DCAbility),onSave:e.mapCharacterAttackEffect(r.onSave,a),onFail:e.mapCharacterAttackEffect(r.onFail,a)}}},{key:"mapTextCharacterEffect",value:function(e){var t=e;return{type:y.Text,text:t.text}}}]),e}();O.attackEffectMap={0:O.mapToHitCharacterEffect,1:O.mapDamageCharacterEffect,2:O.mapSavingThrowCharacterEffect,3:O.mapTextCharacterEffect},function(e){e[e.ToHit=0]="ToHit",e[e.Damage=1]="Damage",e[e.SavingThrow=2]="SavingThrow",e[e.Text=3]="Text"}(y||(y={}));var C=function(){function e(){Object(n.a)(this,e)}return Object(c.a)(e,null,[{key:"getProficiencyBonus",value:function(e){if(!e||!e.levels)return null;var t=e.levels.map(function(e){return e.level}).reduce(function(e,t){return e+t});return t>20?null:1+Math.ceil(t/4)}},{key:"getSaveModifier",value:function(t,a){if(!t||!t.proficiencies||!t.proficiencies.saves)return null;var r=this.getAbilityModifier(t,a);if(null===r)return null;var n=t.proficiencies.saves[a]||0,c=e.getProficiencyBonus(t);return r+Math.floor(n*c)}},{key:"getAbilityModifier",value:function(e,t){return e&&void 0!==e[t]?Math.floor((e[t]-10)/2):null}},{key:"getInitiativeModifier",value:function(e){return this.getAbilityModifier(e,"dexterity")}},{key:"getSkillModifier",value:function(t,a,r){if(!t||void 0===t[r])return null;var n=Math.floor((t[r]-10)/2),c=t.proficiencies.skills[a]||0,i=e.getProficiencyBonus(t);return n+Math.floor(c*i)}},{key:"getAttacks",value:function(e){return[].concat((e.equipment||[]).map(function(e){return e.attacks||[]})).concat(e.attacks||[]).concat((e.spells||[]).map(function(e){return Object(f.a)({},e,{title:e.name})})).flat().map(function(t){return{name:t.title,range:t.range,effects:t.effects.map(function(t){return O.mapCharacterAttackEffect(t,e)})}})}},{key:"getShortAbilityName",value:function(t){var a=e.abilityNameMap[t];return a&&a.short}},{key:"getLongAbilityName",value:function(t){var a=e.abilityNameMap[t];return a&&a.long}},{key:"getLongSkillName",value:function(t){return e.skillNameMap[t]}},{key:"getSaveName",value:function(t){return e.saveNameMap[t]}},{key:"getSenseName",value:function(t){return e.senseNameMap[t]}}]),e}();C.abilityNameMap={strength:{short:"STR",long:"Strength"},dexterity:{short:"DEX",long:"Dexterity"},constitution:{short:"CON",long:"Constitution"},intelligence:{short:"INT",long:"Intelligence"},wisdom:{short:"WIS",long:"Wisdom"},charisma:{short:"CHA",long:"Charisma"}},C.skillNameMap={acrobatics:"Acrobatics",animalHandling:"Animal Handling",arcana:"Arcana",athletics:"Athletics",deception:"Deception",history:"History",insight:"Insight",intimidation:"Intimidation",investigation:"Investigation",medicine:"Medicine",nature:"Nature",perception:"Perception",performance:"Performance",persuasion:"Persuasion",religion:"Religion",sleightOfHand:"Sleight of Hand",stealth:"Stealth",survival:"Survival"},C.saveNameMap={strength:"Strength Save",dexterity:"Dexterity Save",constitution:"Constitution Save",intelligence:"Intelligence Save",wisdom:"Wisdom Save",charisma:"Charisma Save"},C.senseNameMap=(E={},Object(g.a)(E,r.Tremorsense,"tremorsense"),Object(g.a)(E,r.Darkvision,"darkvision"),Object(g.a)(E,r.Blindsight,"blindsight"),Object(g.a)(E,r.Truesight,"truesight"),Object(g.a)(E,r.Blind,"blind"),E);var j,S,N=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.ability,r=t.character,n=C.getAbilityModifier(r,a);return u.a.createElement("div",{className:"ability",onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("div",{className:"popup-advantage",onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:"popup-disadvantage",onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",{className:"ability-title"},C.getLongAbilityName(a)),u.a.createElement("div",{className:"ability-modifier"},u.a.createElement("div",{className:"ability-symbol"},n<0?"-":"+"),u.a.createElement("div",{className:"ability-number"},Math.abs(n))),u.a.createElement("div",{className:"ability-score"},r[a]))}},{key:"handleClick",value:function(e,t){var a=C.getAbilityModifier(this.props.character,this.props.ability),r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Ability",rollName:C.getLongAbilityName(this.props.ability),modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),k=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.ability,r=t.character,n=(r.proficiencies||{saves:{}}).saves||{},c=C.getSaveModifier(r,a),i=J[n[a]||0];return u.a.createElement("div",{className:"save",onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("div",{className:"popup-advantage",onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:"popup-disadvantage",onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",{className:"save-wrapper"},u.a.createElement("div",{className:"save-proficiency ".concat(i)}),u.a.createElement("div",{className:"save-title"},C.getShortAbilityName(a)),u.a.createElement("div",{className:"save-modifier"},u.a.createElement("span",{className:"save-symbol"},c<0?"-":"+"),u.a.createElement("span",{className:"save-number"},Math.abs(c)))))}},{key:"handleClick",value:function(e,t){var a=C.getSaveModifier(this.props.character,this.props.ability),r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Save",rollName:C.getSaveName(this.props.ability),modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),A=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.ability,r=t.character,n=t.skill,c=(r.proficiencies||{skills:{}}).skills||{},i=C.getSkillModifier(r,n,a),s=J[c[n]||0];return u.a.createElement("div",{className:"skill",onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("div",{className:"popup-advantage",onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:"popup-disadvantage",onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",{className:"skill-wrapper"},u.a.createElement("div",{className:"skill-proficiency ".concat(s)}),u.a.createElement("div",{className:"skill-ability"},C.getShortAbilityName(a)),u.a.createElement("div",{className:"skill-title"},C.getLongSkillName(n)),u.a.createElement("div",{className:"skill-modifier"},u.a.createElement("div",{className:"skill-symbol"},i<0?"-":"+"),u.a.createElement("div",{className:"skill-number"},Math.abs(i)))))}},{key:"handleClick",value:function(e,t){var a=C.getSkillModifier(this.props.character,this.props.skill,this.props.ability),r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Skill",rollName:"".concat(this.props.skill," (").concat(this.props.ability,")"),modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),T=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character,t=C.getProficiencyBonus(e);return u.a.createElement("div",{className:"proficiency"},u.a.createElement("div",{className:"proficiency-title"},"Proficiency"),u.a.createElement("div",{className:"proficiency-modifier"},u.a.createElement("div",{className:"proficiency-symbol"},"+"),u.a.createElement("div",{className:"proficiency-number"},t)))}}]),t}(u.a.Component),w=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=this.props.character.speed||{walk:0},t=[],a=0,r=Object.keys(e);a<r.length;a++){var n=r[a];t.push(u.a.createElement("div",{className:"speed-container",key:n},u.a.createElement("div",{className:"speed-popup-wrap"},u.a.createElement("span",{className:"speed-number"},e[n]),u.a.createElement("span",{className:"speed-unit"},"ft.")),u.a.createElement("div",{className:"speed-type"},n)))}return u.a.createElement("div",{className:"speed"},u.a.createElement("div",{className:"speed-title"},"Speed"),u.a.createElement("div",{className:"speed-container"},u.a.createElement("span",{className:"speed-number"},e.walk),u.a.createElement("span",{className:"speed-unit"},"ft.")),u.a.createElement("div",{className:"speed-popup"},u.a.createElement("div",{className:"speed-title"},"Speed"),t))}}]),t}(u.a.Component),_=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.character,a=C.getInitiativeModifier(t);return u.a.createElement("div",{className:"initiative",onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("div",{className:"popup-advantage",onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:"popup-disadvantage",onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",{className:"initiative-title"},"Initiative"),u.a.createElement("div",{className:"initiative-modifier"},u.a.createElement("div",{className:"initiative-symbol"},a<0?"-":"+"),u.a.createElement("div",{className:"initiative-number"},Math.abs(a))))}},{key:"handleClick",value:function(e,t){var a=C.getInitiativeModifier(this.props.character),r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Initiative",rollName:"Initiative",modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),D=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character;return u.a.createElement("div",{className:"ac"},u.a.createElement("div",{className:"ac-title"},"AC"),u.a.createElement("div",{className:"ac-number"},e.ac))}}]),t}(u.a.Component),P=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character;return u.a.createElement("div",{className:"hp"},u.a.createElement("div",{className:"hp-title"},"Hit Points"),u.a.createElement("div",{className:"hp-current"},u.a.createElement("span",null,e.hp),u.a.createElement("span",{className:"hp-header"},"Current")),u.a.createElement("div",{className:"hp-divider"},"/"),u.a.createElement("div",{className:"hp-max"},u.a.createElement("span",null,e.maxHp),u.a.createElement("span",{className:"hp-header"},"Max")))}}]),t}(u.a.Component);a(557);!function(e){e[e.Text=0]="Text",e[e.DiceRoll=1]="DiceRoll",e[e.Condition=2]="Condition"}(j||(j={})),function(e){e[e.Disadvantage=-1]="Disadvantage",e[e.None=0]="None",e[e.Advantage=1]="Advantage"}(S||(S={}));var R=function(){function e(){Object(n.a)(this,e)}return Object(c.a)(e,null,[{key:"doAction",value:function(t,a,r){var n=!1,c={type:"action",title:t.title,results:[]},i=!0,s=!1,l=void 0;try{for(var o,u=t.effects[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var p=o.value,m=e.applyEffect(p,a,n);n=m.crit,c.results.push(m.result)}}catch(h){s=!0,l=h}finally{try{i||null==u.return||u.return()}finally{if(s)throw l}}r("",c)}},{key:"applyEffect",value:function(e,t,a){switch(e.type){case y.ToHit:var r,n,c,i,s=e,l=(s.modifier<0?"":"+")+s.modifier,o={advantage:t,modifier:s.modifier,type:j.DiceRoll,rolls:[]},u=new b.DiceRoll("d20"+l),p=u.toString().match(/.*?: (.*?) =/)[1],m=u.rolls[0][0]===(s.critRange||20),h=1===u.rolls[0][0];return t&&(n=(r=new b.DiceRoll("d20"+l)).toString().match(/.*?: (.*?) =/)[1],c=r.rolls[0][0]===(s.critRange||20),i=1===r.rolls[0][0]),a=t>=0?m||c:m&&c,o.rolls.push({total:u.total,critFail:h,critSuccess:m,details:p,ignore:!!r&&(t>0&&u.total<r.total||u.total>r.total)}),r&&o.rolls.push({total:r.total,critFail:i,critSuccess:c,details:n,ignore:t>0&&u.total>=r.total||u.total<=r.total}),{result:o,crit:a};case y.Damage:var d=e,f=new b.DiceRoll("".concat(d.diceCount*(a?2:1),"d").concat(d.diceSize,"+").concat(d.bonus||0)),v={advantage:S.None,modifier:d.bonus,type:j.DiceRoll,rolls:[]},g=f.toString().match(/.*?: (.*?) =/)[1];return v.rolls.push({critFail:!1,critSuccess:!1,details:g,ignore:!1,total:f.total}),{result:v,crit:a};case y.SavingThrow:var E=e;return{result:{type:j.Condition,condition:"DC ".concat(E.saveDC," ").concat(C.getLongAbilityName(E.saveType)," save"),onSuccess:this.applyEffect(E.onSave,0,a).result,onFailure:this.applyEffect(E.onFail,0,a).result},crit:a};case y.Text:var O=e;return{result:{type:j.Text,text:O.text},crit:a};default:return{result:{type:j.Text,text:"Unexpected attack effect ".concat(e.type,"!")},crit:a}}}}]),e}(),I=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a.handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.attack,a=t.effects.filter(function(e){return e.type===y.ToHit})[0],r=t.effects.filter(function(e){return e.type===y.Damage})[0];return u.a.createElement("div",{className:"attack",onClick:function(t){return e.handleClick(t,0)}},a&&u.a.createElement("div",{className:"popup-advantage",onClick:function(t){return e.handleClick(t,1)}},"A"),void 0!==a&&u.a.createElement("div",{className:"popup-disadvantage",onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",{className:"attack-name"},u.a.createElement("span",null,t.name)),u.a.createElement("div",{className:"attack-range"},t.range," ft."),u.a.createElement("div",{className:"attack-toHit"},a&&u.a.createElement("div",null,u.a.createElement("div",{className:"attack-toHit-symbol"},a.modifier<0?"-":"+"),u.a.createElement("div",{className:"attack-toHit-number"},Math.abs(a.modifier)))),u.a.createElement("div",{className:"attack-damage"},r.diceCount,"d",r.diceSize,"+",r.bonus||0," ",r.damageType))}},{key:"handleClick",value:function(e,t){var a=this.props.attack,r=!1,n={type:"action",title:a.name,results:[]},c=!0,i=!1,s=void 0;try{for(var l,o=a.effects[Symbol.iterator]();!(c=(l=o.next()).done);c=!0){var u=l.value,p=R.applyEffect(u,t,r);r=p.crit,n.results.push(p.result)}}catch(m){i=!0,s=m}finally{try{c||null==o.return||o.return()}finally{if(i)throw s}}this.props.sendMessage("",n)}}]),t}(u.a.Component),x=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.character,a=C.getAttacks(t).map(function(t){return u.a.createElement(I,Object.assign({key:t.name,attack:t},e.props))});return u.a.createElement("div",{className:"attacks"},u.a.createElement("div",{className:"attack-container"},u.a.createElement("div",{className:"attack-header"},u.a.createElement("span",{className:"attack-name"},"Attack"),u.a.createElement("span",{className:"attack-range"},"Range"),u.a.createElement("span",{className:"attack-toHit"},"To Hit"),u.a.createElement("span",{className:"attack-damage"},"Damage")),a),u.a.createElement("div",{className:"attacks-title"},"Attacks"))}}]),t}(u.a.Component),M=a(71),L=a.n(M),U=a(100),H=a.n(U),F=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.character,e.item);return u.a.createElement("div",{className:H.a.wrapper},u.a.createElement("span",{className:H.a.name},t.name),u.a.createElement("span",{className:H.a.quantity},t.quantity||"-"),u.a.createElement("span",{className:H.a.weight},t.weight?t.weight+" lb.":"-"),u.a.createElement("span",{className:H.a.notes},t.notes))}}]),t}(u.a.Component),Y=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=(this.props.character.equipment||[]).map(function(t,a){return u.a.createElement(F,Object.assign({key:a,item:t},e.props))});return u.a.createElement("div",{className:L.a.equipment},u.a.createElement("div",{className:L.a.wrapper},u.a.createElement("div",{className:L.a.header},u.a.createElement("span",{className:L.a.name},"Name"),u.a.createElement("span",{className:L.a.quantity},"Quantity"),u.a.createElement("span",{className:L.a.weight},"Weight"),u.a.createElement("span",{className:L.a.notes},"Notes")),t),u.a.createElement("div",{className:L.a.title},"Equipment"))}}]),t}(u.a.Component),G=a(60),W="player_character_asset",B="upload_image",q=a(341),V=a.n(q),z=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,a=e.imageUrl;return t(u.a.createElement("div",{className:V.a.wrapper},u.a.createElement("img",{src:a||"http://placekitten.com/128/128"})))}}]),t}(o.Component),K={canDrop:function(e,t){return!0},hover:function(e,t,a){},drop:function(e,t,a){var r=t.getItem();e.updateCharacter&&e.updateCharacter(e.character.id,Object(f.a)({},e.character,{imageRef:r.imageRef}))}};var Q=Object(G.DropTarget)(B,K,function(e,t){return{connectDropTarget:e.dropTarget()}})(z),J={0:"none",.5:"half-proficienct",1:"proficient",2:"expertise"},Z=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={editing:!1,newCharacter:JSON.stringify(a.props.character,void 0," ")},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.character;return this.state.editing?u.a.createElement("div",{className:"column character-sheet ".concat(this.props.popout?"popout":"")},u.a.createElement("div",{className:"character-cancel",onClick:function(t){return e.abortEditSheet()}},"CANCEL"),u.a.createElement("div",{className:"character-edit",onClick:function(t){return e.saveSheet()}},"SAVE"),u.a.createElement("textarea",{rows:40,value:this.state.newCharacter,onChange:function(t){return e.setState(Object(f.a)({},e.state,{newCharacter:t.target.value}))}})):u.a.createElement("div",{className:"column character-sheet ".concat(this.props.popout?"popout":"")},u.a.createElement("div",{className:"character-close",onClick:function(t){return e.closeSheet()}},"X"),u.a.createElement("div",{className:"character-edit",onClick:function(t){return e.editSheet()}},"EDIT"),u.a.createElement("div",{className:"character-popout",onClick:function(t){return e.popoutSheet()}},"POPOUT"),u.a.createElement("div",{className:"row character-details"},u.a.createElement("div",{className:"character-name"},t.name),u.a.createElement("div",{className:"character-image"},u.a.createElement(Q,{imageUrl:this.props.image?this.props.image.downloadUrl:null,character:t,updateCharacter:this.props.updatePlayerCharacter})),u.a.createElement("div",{className:"character-classes"},(t.levels||[]).map(function(e){return"".concat(e.className," ").concat(e.level)}).join(", "))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"ability-container"},u.a.createElement(N,Object.assign({ability:"strength",character:t},this.props)),u.a.createElement(N,Object.assign({ability:"dexterity",character:t},this.props)),u.a.createElement(N,Object.assign({ability:"constitution",character:t},this.props)),u.a.createElement(N,Object.assign({ability:"intelligence",character:t},this.props)),u.a.createElement(N,Object.assign({ability:"wisdom",character:t},this.props)),u.a.createElement(N,Object.assign({ability:"charisma",character:t},this.props))),u.a.createElement(T,Object.assign({character:t},this.props)),u.a.createElement(w,Object.assign({character:t},this.props)),u.a.createElement(P,Object.assign({character:t},this.props))),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"column"},u.a.createElement("div",{className:"save-container"},u.a.createElement(k,Object.assign({ability:"strength",character:t},this.props)),u.a.createElement(k,Object.assign({ability:"dexterity",character:t},this.props)),u.a.createElement(k,Object.assign({ability:"constitution",character:t},this.props)),u.a.createElement(k,Object.assign({ability:"intelligence",character:t},this.props)),u.a.createElement(k,Object.assign({ability:"wisdom",character:t},this.props)),u.a.createElement(k,Object.assign({ability:"charisma",character:t},this.props)),u.a.createElement("div",{className:"section-title"},"Saving Throws"))),u.a.createElement("div",{className:"skill-container"},u.a.createElement(A,Object.assign({skill:"acrobatics",ability:"dexterity",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"animalHandling",ability:"wisdom",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"arcana",ability:"intelligence",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"athletics",ability:"strength",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"deception",ability:"charisma",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"history",ability:"intelligence",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"insight",ability:"wisdom",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"intimidation",ability:"charisma",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"investigation",ability:"intelligence",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"medicine",ability:"wisdom",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"nature",ability:"intelligence",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"perception",ability:"wisdom",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"performance",ability:"charisma",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"persuasion",ability:"charisma",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"religion",ability:"intelligence",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"sleightOfHand",ability:"dexterity",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"stealth",ability:"dexterity",character:t},this.props)),u.a.createElement(A,Object.assign({skill:"survival",ability:"wisdom",character:t},this.props)),u.a.createElement("div",{className:"section-title"},"Skills")),u.a.createElement("div",{className:"column",style:{flex:1}},u.a.createElement("div",{className:"row"},u.a.createElement(_,Object.assign({character:t},this.props)),u.a.createElement(D,Object.assign({character:t},this.props))),u.a.createElement("div",{className:"row"},u.a.createElement(x,Object.assign({character:t},this.props))),u.a.createElement("div",{className:"row"},u.a.createElement(Y,Object.assign({character:t},this.props))))))}},{key:"closeSheet",value:function(){this.props.closeCharacterSheet(this.props.character.id)}},{key:"editSheet",value:function(){this.setState(Object(f.a)({},this.state,{editing:!0}))}},{key:"abortEditSheet",value:function(){this.setState(Object(f.a)({},this.state,{editing:!1}))}},{key:"saveSheet",value:function(){var e=JSON.parse(this.state.newCharacter);this.props.updatePlayerCharacter(e.id,e),this.setState(Object(f.a)({},this.state,{editing:!1}))}},{key:"popoutSheet",value:function(){window.open("/characterSheet/".concat(this.props.character.id),"popupWindow","height=768,width=1024,toolbar=no,location=no,statusbar=no,titlebar=no,directories=no",!1),this.closeSheet()}}]),t}(u.a.Component),X=a(17),$=a.n(X),ee=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.ability,r=t.character,n=C.getAbilityModifier(r,a);return u.a.createElement("div",{className:$.a.ability,onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("div",{className:$.a.abilityTitle},C.getShortAbilityName(a)),u.a.createElement("div",{className:$.a.rollable},u.a.createElement("div",{className:$.a.popupAdvantage,onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:$.a.popupDisadvantage,onClick:function(t){return e.handleClick(t,-1)}},"D"),u.a.createElement("div",null,r[a]," (",n>=0?"+".concat(n):n,")")))}},{key:"handleClick",value:function(e,t){var a=C.getAbilityModifier(this.props.character,this.props.ability),r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Ability",rollName:C.getLongAbilityName(this.props.ability),modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),te=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){this.props.character;return u.a.createElement("div",{className:$.a.abilityContainer},u.a.createElement(ee,Object.assign({ability:"strength"},this.props)),u.a.createElement(ee,Object.assign({ability:"dexterity"},this.props)),u.a.createElement(ee,Object.assign({ability:"constitution"},this.props)),u.a.createElement(ee,Object.assign({ability:"intelligence"},this.props)),u.a.createElement(ee,Object.assign({ability:"wisdom"},this.props)),u.a.createElement(ee,Object.assign({ability:"charisma"},this.props)))}}]),t}(u.a.Component),ae=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.skill,r=(t.character,C.getLongSkillName(a.skill));return u.a.createElement("div",{className:$.a.skill,onClick:function(t){return e.handleClick(t,0)}},u.a.createElement("span",null,r),u.a.createElement("div",{className:$.a.rollable},u.a.createElement("div",{className:$.a.popupAdvantage,onClick:function(t){return e.handleClick(t,1)}},"A"),u.a.createElement("div",{className:$.a.popupDisadvantage,onClick:function(t){return e.handleClick(t,-1)}},"D"),a.modifier>=0?"+".concat(a.modifier):a.modifier))}},{key:"handleClick",value:function(e,t){var a=this.props.skill.modifier,r=(a<0?"":"+")+a,n=new b.DiceRoll("d20"+r),c={type:"roll",rollType:"Skill",rollName:C.getLongSkillName(this.props.skill.skill),modifier:r,roll1Total:n.total,roll1Details:n.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:20===n.rolls[0][0],roll1CritFail:1===n.rolls[0][0]};if(t){var i=new b.DiceRoll("d20"+r);c.rollAdvantageType=t,c.roll2Total=i.total,c.roll2Details=i.toString().match(/.*?: (.*?) =/)[1],c.roll2CritSuccess=20===i.rolls[0][0],c.roll2CritFail=1===i.rolls[0][0],e.stopPropagation()}this.props.sendMessage("",c)}}]),t}(u.a.Component),re=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character;if(!e.skills||!e.skills.length)return null;var t=[],a=!0,r=!1,n=void 0;try{for(var c,i=e.skills[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value;t.push(u.a.createElement(ae,Object.assign({skill:s},this.props)))}}catch(l){r=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}return u.a.createElement("div",{className:"row"},u.a.createElement("span",{className:$.a.boldHeading},"Skills"),t)}}]),t}(u.a.Component),ne=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character;if(!e.features||!e.features.length)return null;var t=[],a=!0,r=!1,n=void 0;try{for(var c,i=e.features[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value;t.push(u.a.createElement("div",{className:$.a.feature},u.a.createElement("span",{className:$.a.italicHeading},s.title,"."),u.a.createElement("span",null,s.description)))}}catch(l){r=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}return u.a.createElement("div",null,t)}}]),t}(u.a.Component),ce=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.character;if(!t.actions||!t.actions.length)return null;var a=[],r=!0,n=!1,c=void 0;try{for(var i,s=function(){var t=i.value,r=t.effects.map(function(e){switch(e.type){case y.Text:var a=e;return u.a.createElement("span",null,a.text);case y.ToHit:var r=e;return u.a.createElement("span",null,r.modifier," to hit, range ",t.range," ft.");case y.Damage:var n=e;return u.a.createElement("span",null,"Hit: ",n.diceCount,"d",n.diceSize,"+",n.bonus," ",n.damageType," damage.");default:return u.a.createElement("div",null)}});a.push(u.a.createElement("div",{className:$.a.action,onClick:function(){return e.doAction(t,0)}},u.a.createElement("span",{className:$.a.italicHeading},t.title,"."),u.a.createElement("span",null,r)))},l=t.actions[Symbol.iterator]();!(r=(i=l.next()).done);r=!0)s()}catch(o){n=!0,c=o}finally{try{r||null==l.return||l.return()}finally{if(n)throw c}}return u.a.createElement("div",null,a)}},{key:"doAction",value:function(e,t){R.doAction(e,t,this.props.sendMessage)}}]),t}(u.a.Component),ie=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.character;if(!e.senses||!e.senses.length)return null;var t=[],a=!0,r=!1,n=void 0;try{for(var c,i=e.senses[Symbol.iterator]();!(a=(c=i.next()).done);a=!0){var s=c.value;t.push(u.a.createElement("div",null,C.getSenseName(s.type)," ",s.range," ft."))}}catch(l){r=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}return u.a.createElement("div",{className:"row"},u.a.createElement("span",{className:$.a.boldHeading},"Senses"),t)}}]),t}(u.a.Component),se=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={editing:!1,newCharacter:JSON.stringify(a.props.character,void 0," ")},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.character;return this.state.editing?u.a.createElement("div",{className:"column character-sheet ".concat(this.props.popout?"popout":"")},u.a.createElement("div",{className:"character-cancel",onClick:function(t){return e.abortEditSheet()}},"CANCEL"),u.a.createElement("div",{className:"character-edit",onClick:function(t){return e.saveSheet()}},"SAVE"),u.a.createElement("textarea",{rows:40,value:this.state.newCharacter,onChange:function(t){return e.setState(Object(f.a)({},e.state,{newCharacter:t.target.value}))}})):u.a.createElement("div",{className:"column ".concat($.a.characterSheet," ").concat(this.props.popout?"popout":"")},u.a.createElement("div",{className:"character-close",onClick:function(t){return e.closeSheet()}},"X"),u.a.createElement("div",{className:"character-edit",onClick:function(t){return e.editSheet()}},"EDIT"),u.a.createElement("div",{className:"character-popout",onClick:function(t){return e.popoutSheet()}},"POPOUT"),u.a.createElement("div",{className:$.a.characterImageContainer},u.a.createElement(Q,{imageUrl:this.props.image?this.props.image.downloadUrl:null,character:t,updateCharacter:this.props.updateNonPlayerCharacter})),u.a.createElement("div",{className:$.a.characterName},t.name),u.a.createElement("div",{className:$.a.characterType},t.class,", ",t.alignment),u.a.createElement("hr",{className:$.a.divider}),u.a.createElement("div",null,u.a.createElement("span",{className:$.a.boldHeading},"Armor Class"),u.a.createElement("span",null,t.ac," (",t.acType,")")),u.a.createElement("div",null,u.a.createElement("span",{className:$.a.boldHeading},"Hit Points"),u.a.createElement("span",null,t.hpDice)),u.a.createElement("div",null,u.a.createElement("span",{className:$.a.boldHeading},"Speed"),u.a.createElement("span",null,t.speed&&t.speed.walk||0," ft.")),u.a.createElement("hr",{className:$.a.divider}),u.a.createElement(te,this.props),u.a.createElement("hr",{className:$.a.divider}),u.a.createElement(re,this.props),u.a.createElement(ie,this.props),u.a.createElement("div",null,u.a.createElement("span",{className:$.a.boldHeading},"Languages"),u.a.createElement("span",null,(t.languages||[]).join(", "))),u.a.createElement("div",null,u.a.createElement("span",{className:$.a.boldHeading},"Challenge"),u.a.createElement("span",null,t.cr)),u.a.createElement("hr",{className:$.a.divider}),u.a.createElement(ne,this.props),u.a.createElement("div",{className:$.a.subheading},"Actions"),u.a.createElement(ce,this.props))}},{key:"closeSheet",value:function(){this.props.closeCharacterSheet(this.props.character.id)}},{key:"editSheet",value:function(){this.setState(Object(f.a)({},this.state,{editing:!0}))}},{key:"abortEditSheet",value:function(){this.setState(Object(f.a)({},this.state,{editing:!1}))}},{key:"saveSheet",value:function(){var e=JSON.parse(this.state.newCharacter);this.props.updateNonPlayerCharacter(e.id,e),this.setState(Object(f.a)({},this.state,{editing:!1}))}},{key:"popoutSheet",value:function(){window.open("/characterSheet/".concat(this.props.character.id),"popupWindow2","height=768,width=1024,toolbar=no,location=no,statusbar=no,titlebar=no,directories=no",!1),this.closeSheet()}}]),t}(u.a.Component),le={CHAT:{SYNC:"CHAT.SYNC",SYNC_FAILED:"CHAT.SYNC_FAILED",NEW:{SAVE:"CHAT.NEW.SAVE"}}},oe=function(e){return{type:le.CHAT.SYNC,messages:e}},ue=function(e,t){return{type:le.CHAT.NEW.SAVE,message:e,data:t}},pe=function(e){return{type:le.CHAT.SYNC_FAILED,error:e}},me={CHARACTERS:{OPEN_SHEET:"CHARACTERS.OPEN_SHEET",CLOSE_SHEET:"CHARACTERS.CLOSE_SHEET"}},he={ASSETS:{PLAYERCHARACTER:{SYNC:"ASSETS.PLAYERCHARACTER.SYNC",SYNC_FAILED:"ASSETS.PLAYERCHARACTER.SYNC_FAILED",UPDATE:"ASSETS.PLAYERCHARACTER.UPDATE",NEW:{SAVE:"ASSETS.PLAYERCHARACTER.NEW.SAVE"}},NONPLAYERCHARACTER:{SYNC:"ASSETS.NONPLAYERCHARACTER.SYNC",SYNC_FAILED:"ASSETS.NONPLAYERCHARACTER.SYNC_FAILED",UPDATE:"ASSETS.NONPLAYERCHARACTER.UPDATE",NEW:{SAVE:"ASSETS.NONPLAYERCHARACTER.NEW.SAVE"}}}},de=function(e){return{type:he.ASSETS.PLAYERCHARACTER.SYNC,playerCharacters:e}},fe=function(e){return{type:he.ASSETS.PLAYERCHARACTER.SYNC_FAILED,error:e}},ve=function(e){return{type:he.ASSETS.NONPLAYERCHARACTER.SYNC,nonPlayerCharacters:e}},be=function(e){return{type:he.ASSETS.NONPLAYERCHARACTER.SYNC_FAILED,error:e}},ge=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.popout,r=t.images,n=t.playerCharacters,c=t.nonPlayerCharacters,i=t.openCharacterSheets,s=[];if(a){var l=n.find(function(t){return t.id===e.props.popout});if(l){var o=r.find(function(e){return e.filePath===l.imageRef});return u.a.createElement(Z,Object.assign({key:a,character:l,popout:"popout",image:o},this.props))}var p=c.find(function(t){return t.id===e.props.popout});if(p){var m=r.find(function(e){return e.filePath===p.imageRef});return u.a.createElement(se,Object.assign({key:a,character:p,popout:"popout",image:m},this.props))}}var h=!0,d=!1,f=void 0;try{for(var v,b=function(){var t=v.value,a=n.find(function(e){return e.id===t});if(a){var i=r.find(function(e){return e.filePath===a.imageRef});return s.push(u.a.createElement(Z,Object.assign({key:t,character:a,image:i},e.props))),"continue"}var l=c.find(function(e){return e.id===t});if(l){var o=r.find(function(e){return e.filePath===l.imageRef});s.push(u.a.createElement(se,Object.assign({key:t,character:l,image:o},e.props)))}},g=i[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)b()}catch(E){d=!0,f=E}finally{try{h||null==g.return||g.return()}finally{if(d)throw f}}return u.a.createElement("div",null,s)}}]),t}(o.Component),Ee=Object(d.c)(function(e){return{playerCharacters:e.assets.playerCharacters,nonPlayerCharacters:e.assets.nonPlayerCharacters,openCharacterSheets:e.characters.openCharacterSheets,images:e.images.images}},function(e){return{sendMessage:function(t,a){return e(ue(t,a))},closeCharacterSheet:function(t){return e(function(e){return{type:me.CHARACTERS.CLOSE_SHEET,characterId:e}}(t))},updatePlayerCharacter:function(t,a){return e(function(e,t){return{type:he.ASSETS.PLAYERCHARACTER.UPDATE,characterId:e,character:t}}(t,a))},updateNonPlayerCharacter:function(t,a){return e(function(e,t){return{type:he.ASSETS.NONPLAYERCHARACTER.UPDATE,characterId:e,character:t}}(t,a))}}})(ge),ye={STORAGE:{SEND_FILE:"STORAGE.SEND_FILE",SEND_FILE_SUCCESS:"STORAGE.SEND_FILE_SUCCESS",SEND_FILE_FAILURE:"STORAGE.SEND_FILE_FAILURE",SEND_FILE_PROGRESS:"STORAGE.SEND_FILE_PROGRESS"}},Oe=function(e){return{type:ye.STORAGE.SEND_FILE_PROGRESS,progress:e}},Ce=function(){return{type:ye.STORAGE.SEND_FILE_SUCCESS}},je=function(e){return{type:ye.STORAGE.SEND_FILE_FAILURE,error:e}},Se=a(31),Ne=a(53),ke=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={uploadName:"",file:null},a.onUpload=a.onUpload.bind(Object(v.a)(a)),a.onChangeFile=a.onChangeFile.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"onChangeFile",value:function(e){var t=e.target.files[0];this.setState({file:t})}},{key:"onUpload",value:function(e){this.state.file&&this.state.uploadName&&0!==this.state.uploadName.length&&this.props.onUpload(this.state.uploadName,this.state.file)}},{key:"render",value:function(){var e=this,t=this.props.classes;return u.a.createElement("div",{className:t.wrapper},u.a.createElement(Se.h,{label:"Upload Name",onChange:function(t){return e.setState({uploadName:t.target.value})},disabled:this.props.inProgress,margin:"normal"}),u.a.createElement(Se.c,{onChange:this.onChangeFile,type:"file",margin:"dense"}),u.a.createElement(Se.a,{className:t.button,variant:"contained",onClick:this.onUpload,disabled:this.props.inProgress,color:"primary"},"Upload"),u.a.createElement(Se.e,{value:this.props.progress,variant:"determinate",color:"secondary"}))}}]),t}(o.Component),Ae=Object(Ne.withStyles)(function(e){return{wrapper:{display:"flex",flexDirection:"column",padding:"5px"},button:{marginTop:"10px",marginBottom:"10px"}}})(ke),Te=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return u.a.createElement(Ae,{onUpload:this.props.sendFile,progress:this.props.uploadProgress,inProgress:this.props.uploading})}}]),t}(o.Component),we=Object(d.c)(function(e){return{uploadProgress:e.storage.uploadProgress,uploading:e.storage.uploading}},function(e){return{sendFile:function(t,a){return e(function(e,t){return{type:ye.STORAGE.SEND_FILE,name:e,file:t}}(t,a))}}})(Te),_e=a(153),De=a.n(_e),Pe=a(84),Re=a.n(Pe),Ie={LOGIN:{REQUEST:"LOGIN.REQUEST",SUCCESS:"LOGIN.SUCCESS",FAILURE:"LOGIN.FAILURE"},LOGOUT:{REQUEST:"LOGOUT.REQUEST",SUCCESS:"LOGOUT.SUCCESS",FAILURE:"LOGOUT.FAILURE"}},xe=function(e,t){return{type:Ie.LOGIN.REQUEST,username:e,password:t}},Me=function(e){return{type:Ie.LOGIN.SUCCESS,user:e}},Le=function(e){return{type:Ie.LOGIN.FAILURE,error:e}},Ue=function(){return{type:Ie.LOGOUT.REQUEST}},He=function(){return{type:Ie.LOGOUT.SUCCESS}},Fe=function(e){return{type:Ie.LOGOUT.FAILURE,error:e}},Ye=a(342),Ge=a.n(Ye),We=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={username:"",password:""},a.updateState=a.updateState.bind(Object(v.a)(a)),a.login=a.login.bind(Object(v.a)(a)),a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"updateState",value:function(e,t){var a={};a[e]=t,this.setState(a)}},{key:"login",value:function(){0!==this.state.username.length&&0!==this.state.password.length&&this.props.login(this.state.username,this.state.password)}},{key:"render",value:function(){var e=this,t=this.props,a=t.loggedIn;t.logout;return a?u.a.createElement("div",null):u.a.createElement("div",{className:Ge.a.wrapper},u.a.createElement(Re.a,{label:"Username",onChange:function(t){return e.updateState("username",t.target.value)},value:this.state.username,margin:"normal"}),u.a.createElement(Re.a,{label:"Password",onChange:function(t){return e.updateState("password",t.target.value)},value:this.state.password,margin:"normal",onKeyUp:function(t){13===t.keyCode&&e.login()}}),u.a.createElement(De.a,{variant:"contained",color:"primary",onClick:function(){return e.login()}},"Login"))}}]),t}(o.PureComponent),Be=Object(d.c)(function(e){return{loggedIn:e.auth.loggedIn}},function(e){return{login:function(t,a){return e(xe(t,a))},logout:function(){return e(Ue())}}})(We),qe=a(154),Ve=a.n(qe),ze=a(155),Ke=a.n(ze),Qe=a(86),Je=a.n(Qe),Ze=a(87),Xe=a.n(Ze),$e=(a(598),function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,a=(e.isOwner,t.sender||"unknown");return u.a.createElement("div",{className:"message",key:t.id},u.a.createElement("div",{className:Xe.a.username},a," :"),u.a.createElement("div",null,t.msg))}}]),t}(u.a.Component)),et=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t=this.props.message,a=t.data;switch(a.rollType){case"Skill":e="roll-skill";break;case"Ability":e="roll-ability";break;case"Initiative":e="roll-initiative";break;case"Attack":e="roll-attack";break;case"Ad-hoc":default:e="roll-adhoc"}var r=a.rollAdvantageType>0&&a.roll1Total<a.roll2Total||a.rollAdvantageType<0&&a.roll1Total>a.roll2Total,n=a.rollAdvantageType&&!r;return u.a.createElement("div",{className:"roll-container ".concat(e)},u.a.createElement("div",{className:"roll-header"},u.a.createElement("span",{className:"roll-user"},t.sender),u.a.createElement("span",{className:"roll-type"},a.rollType)),u.a.createElement("div",{className:"roll-title"},u.a.createElement("span",{className:"roll-name"},a.rollName),null!==a.modifier&&void 0!==a.modifier&&u.a.createElement("span",{className:"roll-modifier"},"(",a.modifier,")")),u.a.createElement("div",{className:"roll-rolls"},u.a.createElement("div",{className:"roll-1 ".concat(r?"ignore":"")},u.a.createElement("span",{className:"summary "+(a.roll1CritSuccess?"crit":a.roll1CritFail?"critFail":"")},u.a.createElement("span",{className:"roll-total"},a.roll1Total),u.a.createElement("span",{className:"roll-suffix"},a.rollSuffix)),u.a.createElement("span",{className:"details"},a.roll1Details)),a.roll2Details&&a.rollAdvantageType&&u.a.createElement("div",{className:a.rollAdvantageType>0?"roll-advantage":"roll-disadvantage"},a.rollAdvantageType>0?"A":"D"),a.roll2Details&&u.a.createElement("div",{className:"roll-2 ".concat(n?"ignore":"")},u.a.createElement("span",{className:"summary "+(a.roll2CritSuccess?"crit":a.roll2CritFail?"critFail":"")},u.a.createElement("span",{className:"roll-total"},a.roll2Total),u.a.createElement("span",{className:"roll-suffix"},a.rollSuffix)),u.a.createElement("span",{className:"details"},a.roll2Details))))}}]),t}(u.a.Component),tt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.result,t=[],a=0,r=!0,n=!1,c=void 0;try{for(var i,s=e.rolls[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value;t.push(u.a.createElement("div",{key:a++,className:"roll ".concat(l.ignore?"ignore":"")},u.a.createElement("span",{className:"summary "+(l.critSuccess?"crit":l.critFail?"critFail":"")},u.a.createElement("span",{className:"roll-total"},l.total)),u.a.createElement("span",{className:"details"},l.details))),e.advantage&&t.push(u.a.createElement("div",{key:a++,className:e.advantage===S.Advantage?"roll-advantage":"roll-disadvantage"},e.advantage===S.Advantage?"A":"D"))}}catch(o){n=!0,c=o}finally{try{r||null==s.return||s.return()}finally{if(n)throw c}}return u.a.createElement("div",{className:"roll-rolls"},t)}}]),t}(u.a.Component),at=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.result;return u.a.createElement("div",{className:"text"},e.text)}}]),t}(u.a.Component),rt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.result;return u.a.createElement("div",{className:"column"},u.a.createElement("div",null,e.condition),u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"column"},u.a.createElement("div",null,"On success:"),u.a.createElement("div",null,u.a.createElement(nt,{action:e.onSuccess}))),u.a.createElement("div",{className:"column"},u.a.createElement("div",null,"On failure:"),u.a.createElement("div",null,u.a.createElement(nt,{action:e.onFailure})))))}}]),t}(u.a.Component),nt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.action;switch(e.type){case j.Text:return u.a.createElement(at,{result:e});case j.DiceRoll:return u.a.createElement(tt,{result:e});case j.Condition:return u.a.createElement(rt,{result:e});default:return u.a.createElement("div",null,"Unknown action type ",e.type,"!")}}}]),t}(u.a.Component),ct=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.message,t=e.data,a=[];for(var r in t.results){var n=t.results[r];a.push(u.a.createElement(nt,{key:r,action:n}))}return u.a.createElement("div",{className:"character-action-container"},u.a.createElement("div",{className:"action-header"},u.a.createElement("span",{className:"action-user"},e.sender)),u.a.createElement("div",{className:"action-title"},u.a.createElement("span",{className:"action-name"},t.title)),t.results.map(function(e,t){return u.a.createElement(nt,{key:t,action:e})}))}}]),t}(u.a.Component),it=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={msg:"",messages:[]},a.scrollDiv=void 0,a.scrollToBottomOfChat=function(){a.scrollDiv&&(a.scrollDiv.scrollTop=a.scrollDiv.scrollHeight)},a.handleMsgChange=function(e){a.setState({msg:e.target.value})},a.handleKeyDown=function(e){if("Enter"===e.key){if(a.state.msg.match(/^\d*?d(\d+|%)/)){var t=new b.DiceRoll(a.state.msg),r={type:"roll",rollType:"Ad-hoc",rollName:t.notation,modifier:null,roll1Total:t.total,roll1Details:t.toString().match(/.*?: (.*?) =/)[1],roll1CritSuccess:!1,roll1CritFail:!1};a.props.sendMessage("",r)}else a.sendMessage(a.state.msg);a.setState({msg:""})}},a.sendMessage=function(e){a.props.sendMessage(e)},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.scrollToBottomOfChat()}},{key:"componentDidMount",value:function(){this.scrollToBottomOfChat()}},{key:"render",value:function(){var e=this,t=this.props.messages;return u.a.createElement("div",{style:{padding:"0 10px 10px 10px"}},this.props.loggedIn?u.a.createElement("div",{style:{}},u.a.createElement("div",{style:{paddingBottom:"15px"}},u.a.createElement(Be,null)),u.a.createElement("h1",{className:Xe.a.chatHeader},"Chat"),u.a.createElement("div",{className:Xe.a.messageWrapper},u.a.createElement("div",{className:Xe.a.messages,ref:function(t){return e.scrollDiv=t}},t.map(function(t,a){switch(t.data&&t.data.type){case"roll":return u.a.createElement(et,{message:t,key:a});case"action":return u.a.createElement(ct,{message:t,key:a});default:return u.a.createElement($e,{message:t,key:a,isOwner:t.sender===e.props.user.email})}})),u.a.createElement("div",{className:Xe.a.chatInputWrapper},u.a.createElement(Re.a,{placeholder:"msg or d20+4 etc",onChange:this.handleMsgChange,onKeyDown:this.handleKeyDown,value:this.state.msg,variant:"filled",margin:"normal"})))):u.a.createElement(Be,null))}}]),t}(u.a.Component),st=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return u.a.createElement(it,this.props)}}]),t}(o.Component),lt=Object(d.c)(function(e){return{messages:e.chat.messages,loggedIn:e.auth.loggedIn,user:e.auth.user}},function(e){return{sendMessage:function(t,a){return e(ue(t,a))},login:function(t,a){return e(xe(t,a))}}})(st),ot=a(115),ut=a.n(ot),pt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.asset,a=(e.assetType,e.images),r=this.props,n=r.isDragging,c=r.connectDragSource,i={cursor:"grab",padding:"5px 10px"};n&&(i.backgroundColor="red");var s=a.find(function(e){return e.filePath===t.imageRef});return c(u.a.createElement("img",{style:i,className:ut.a.image,src:s?s.downloadUrl:t.imageUrl||"",alt:t.name||"unknown"}))}}]),t}(o.Component);var mt,ht=Object(G.DragSource)(W,{beginDrag:function(e){return{id:e.asset.id,assetType:e.assetType}},endDrag:function(e,t,a){t.didDrop()&&(t.getItem(),t.getDropResult())}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(Object(Ne.withStyles)(function(e){return{assetItem:{backgroundColor:"transparent","&:hover":{backgroundColor:"green"}},dragging:{backgroundColor:"red"}}})(pt)),dt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.asset;t.assetType;return u.a.createElement("div",{className:ut.a.item},u.a.createElement(ht,this.props),u.a.createElement("div",{className:ut.a.title,onClick:function(){return e.onClick(a)}},a.name||"unknown"))}},{key:"onClick",value:function(e){this.props.openCharacterSheet(e.id)}}]),t}(o.Component);!function(e){e[e.PlayerCharacter=0]="PlayerCharacter",e[e.NonPlayerCharacter=1]="NonPlayerCharacter"}(mt||(mt={}));var ft=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.playerCharacters,r=t.nonPlayerCharacters;return u.a.createElement("div",null,u.a.createElement("ul",null,a.map(function(t){return u.a.createElement(dt,Object.assign({asset:t,assetType:mt.PlayerCharacter,key:t.id},e.props))})),u.a.createElement("hr",null),u.a.createElement("ul",null,r.map(function(t){return u.a.createElement(dt,Object.assign({asset:t,assetType:mt.NonPlayerCharacter,key:t.id},e.props))})))}}]),t}(o.Component),vt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.playerCharacters,a=e.nonPlayerCharacters,r=e.openCharacterSheet,n=e.images;return u.a.createElement("div",null,u.a.createElement("h1",null,"Asset List"),u.a.createElement(ft,{playerCharacters:t,nonPlayerCharacters:a,openCharacterSheet:r,images:n}))}}]),t}(o.Component),bt=Object(d.c)(function(e){return{playerCharacters:e.assets.playerCharacters,nonPlayerCharacters:e.assets.nonPlayerCharacters,images:e.images.images}},function(e){return{openCharacterSheet:function(t){return e(function(e){return{type:me.CHARACTERS.OPEN_SHEET,characterId:e}}(t))}}})(vt),gt=a(343),Et=a.n(gt),yt=a(21),Ot=a.n(yt),Ct=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={current:mt.PlayerCharacter},a.handleChange=function(e){a.setState({current:e.target.value}),a.props.onChange&&a.props.onChange(e.target.value)},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return u.a.createElement(Se.b,{className:e.formControl},u.a.createElement(Se.d,{htmlFor:"assetType-input"},"Asset Type"),u.a.createElement(Se.g,{value:this.state.current,onChange:this.handleChange,inputProps:{name:"assetType",id:"assetType-input"}},u.a.createElement(Se.f,{value:mt.PlayerCharacter},"Player Character"),u.a.createElement(Se.f,{value:mt.NonPlayerCharacter},"Non Player Character")))}}]),t}(o.Component),jt=Object(Ne.withStyles)(function(e){return{root:{display:"flex",flexWrap:"wrap"},formControl:{margin:e.spacing.unit,minWidth:120},selectEmpty:{marginTop:2*e.spacing.unit}}})(Ct),St=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={name:"",assetType:mt.PlayerCharacter,uploadId:null},a.onSave=function(){var e={imageRef:"",name:a.state.name};a.props.saveNewAsset(a.state.assetType,e)},a.onChangeAssetType=function(e){return a.setState({assetType:e})},a.onChangeName=function(e){return a.setState({name:e.currentTarget.value})},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.classes;return u.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},u.a.createElement("h1",null,"Create Asset"),u.a.createElement(jt,{onChange:this.onChangeAssetType}),u.a.createElement(Se.h,{label:"Name",margin:"normal",className:e.nameInput,value:this.state.name,onChange:this.onChangeName}),u.a.createElement(Se.a,{variant:"contained",className:e.button,onClick:this.onSave},u.a.createElement(Et.a,{className:Ot()(e.leftIcon,e.iconSmall)}),"Save"))}}]),t}(o.Component),Nt=Object(Ne.withStyles)(function(e){return{button:{margin:e.spacing.unit},leftIcon:{marginRight:e.spacing.unit},rightIcon:{marginLeft:e.spacing.unit},iconSmall:{fontSize:20},nameInput:{margin:e.spacing.unit}}})(St),kt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).saveNewAsset=function(e,t){e===mt.PlayerCharacter?a.props.saveNewPlayerCharacter(t):e===mt.NonPlayerCharacter&&a.props.saveNewNonPlayerCharacter(t)},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return u.a.createElement(Nt,{saveNewAsset:this.saveNewAsset})}}]),t}(o.Component),At=Object(d.c)(function(e){return{assets:e.assets.assets}},function(e){return{saveNewPlayerCharacter:function(t){return e((a=t,{type:he.ASSETS.PLAYERCHARACTER.NEW.SAVE,playerCharacterData:a}));var a},saveNewNonPlayerCharacter:function(t){return e((a=t,{type:he.ASSETS.NONPLAYERCHARACTER.NEW.SAVE,nonPlayerCharacterData:a}));var a}}})(kt),Tt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"copyRoomUrl",value:function(){var e=document.createElement("textarea"),t=JSON.parse(localStorage.getItem("firebaseConfig"));e.value=document.location+"?projectId=".concat(t.projectId,"&apiKey=").concat(t.apiKey),document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},{key:"render",value:function(){return u.a.createElement("div",{className:"column"},u.a.createElement("h1",null,"Settings"),u.a.createElement(Se.a,{onClick:this.copyRoomUrl},"Copy Room URL"),this.props.loggedIn&&u.a.createElement(Se.a,{variant:"contained",color:"primary",onClick:this.props.logout},"Logout"))}}]),t}(o.Component),wt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return u.a.createElement(Tt,{loggedIn:this.props.loggedIn,logout:this.props.logout})}}]),t}(o.Component),_t=Object(d.c)(function(e){return{loggedIn:e.auth.loggedIn}},function(e){return{logout:function(){return e(Ue())}}})(wt),Dt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.upload;return(0,this.props.connectDragSource)(u.a.createElement("img",{src:e.downloadUrl,width:64,height:64}))}}]),t}(o.Component);var Pt=Object(G.DragSource)(B,{beginDrag:function(e){return{imageRef:e.upload.filePath}},endDrag:function(e,t,a){t.didDrop()&&(t.getItem(),t.getDropResult())}},function(e,t){return{connectDragSource:e.dragSource()}})(Dt),Rt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.props.uploads.map(function(e){return u.a.createElement(Pt,{key:e.id,upload:e})})}}]),t}(o.Component),It=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.uploads;return u.a.createElement(Rt,{uploads:e})}}]),t}(o.Component),xt=Object(d.c)(function(e){return{uploads:e.images.images}},function(e){return{}})(It),Mt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={value:0},a.handleChange=function(e,t){a.setState({value:t})},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state.value;return u.a.createElement("div",null,u.a.createElement(Ve.a,{position:"static"},u.a.createElement(Ke.a,{variant:"scrollable",value:e,onChange:this.handleChange},u.a.createElement(Je.a,{label:"Chat"}),u.a.createElement(Je.a,{label:"Upload"}),u.a.createElement(Je.a,{label:"Assets"}),u.a.createElement(Je.a,{label:"Settings"}))),0===e&&u.a.createElement(lt,null),1===e&&u.a.createElement("div",null,u.a.createElement(we,null),u.a.createElement(xt,null)),2===e&&u.a.createElement("div",null,u.a.createElement(At,null),u.a.createElement(bt,null)),3===e&&u.a.createElement(_t,null))}}]),t}(o.Component),Lt=a(67),Ut=a(18),Ht=a(344),Ft=a.n(Ht),Yt=a(116),Gt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).layerName=void 0,a.mapObjectId=void 0,a.onUpdateObject=void 0,a}return Object(l.a)(t,e),t}(Ut.Container),Wt=a(158),Bt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).dragGrabOffset=void 0,a.dragging=void 0,a.dragData=void 0,a.dragLocked=void 0,a.hoverFilters=[new Wt.a(4,16711680)],a.dragFilters=[],a.interactive=!0,a.buttonMode=!0,a.onDragStart=function(e){a.alpha=.7,a.dragging=!0,a.dragData=e.data,a.dragGrabOffset=e.data.getLocalPosition(e.currentTarget);var t=a.getChildByName("sprite");t&&(t.filters=[].concat(Object(Yt.a)(t.filters||[]),Object(Yt.a)(a.dragFilters)))},a.onDragEnd=function(e){if(a.alpha=1,a.dragData&&a.dragging){var t=a.dragData.getLocalPosition(e.currentTarget.parent);a.dragGrabOffset&&(t.x-=a.dragGrabOffset.x,t.y-=a.dragGrabOffset.y),a.dragging=!1,a.dragData=null,a.dragGrabOffset=null,a.filters&&(a.filters=a.filters.filter(function(e){return!(a.dragFilters.indexOf(e)>=0)})),a.onUpdateObject&&a.onUpdateObject({layerName:a.layerName,mapObjectId:a.mapObjectId,newData:{position:t}})}},a.onDragMove=function(e){if(a.dragging){var t=a.dragData.getLocalPosition(e.currentTarget.parent);a.x=t.x-(a.dragGrabOffset?a.dragGrabOffset.x:0),a.y=t.y-(a.dragGrabOffset?a.dragGrabOffset.y:0)}},a.onMouseOver=function(e){var t=a.getChildByName("sprite");t&&(t.filters=a.hoverFilters)},a.onMouseOut=function(e){var t=a.getChildByName("sprite");t&&(t.filters=null)},a}return Object(l.a)(t,e),t}(Gt),qt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),t}(Bt),Vt=Object(Lt.PixiComponent)("Token",{create:function(e){var t=new qt;t.onUpdateObject=e.onUpdateObject,t.layerName=e.layerName,t.mapObjectId=e.mapObjectId,t.dragLocked=!1;var a=new Ut.Sprite(e.resource);a.name="sprite";var r=new Ut.Graphics;return r.name="healthbar",t.addChild(a),t.addChild(r),t},applyProps:function(e,t,a){var r=e.getChildByName("healthbar"),n=e.getChildByName("sprite");if(a.resource!==t.resource&&n&&(n.texture=a.resource),a.anchor!==t.anchor&&n&&n.anchor.set(a.anchor?a.anchor.x:.5,a.anchor?a.anchor.y:.5),a.pivot!==t.pivot&&e.pivot.set(a.pivot?a.pivot.x:.5,a.pivot?a.pivot.y:.5),a.scale!==t.scale&&e.scale.set(a.scale?a.scale.x:1,a.scale?a.scale.y:1),a.position!==t.position&&e.position.set(a.position?a.position.x:1,a.position?a.position.y:1),a.rotation!==t.rotation&&(e.rotation=a.rotation||0),a.hp!==t.hp){var c=a.hp.value/a.hp.max,i=Math.max(128,n.width);r.clear(),r.beginFill(7738931),r.drawRect(0,0,i,64),r.endFill(),r.beginFill(16711680),r.drawRect(0,0,i*c,64),r.endFill(),r.position.set(-i/2,-n.height/2-64-10)}},didMount:function(e,t){e.on("mousedown",e.onDragStart),e.on("mouseup",e.onDragEnd),e.on("mouseupoutside",e.onDragEnd),e.on("mousemove",e.onDragMove),e.on("mouseover",e.onMouseOver),e.on("mouseout",e.onMouseOut),e.on("click",function(e){})},willUnmount:function(e,t){e.off("mousedown"),e.off("mouseup"),e.off("mouseupoutside"),e.off("mousemove"),e.off("mouseover"),e.off("mouseout"),e.off("click")}}),zt=Object(Lt.PixiComponent)("Scenery",{create:function(e){var t=new Ut.Sprite(e.resource);t.name="sprite";var a=new Bt;return a.addChild(t),a.hoverFilters=[new Wt.a(4,65280)],a.onUpdateObject=e.onUpdateObject,a.layerName=e.layerName,a.mapObjectId=e.mapObjectId,a},applyProps:function(e,t,a){var r=e.getChildByName("sprite");a.resource!==t.resource&&r&&(r.texture=a.resource),a.anchor!==t.anchor&&r&&r.anchor.set(a.anchor?a.anchor.x:.5,a.anchor?a.anchor.y:.5),a.pivot!==t.pivot&&e.pivot.set(a.pivot?a.pivot.x:.5,a.pivot?a.pivot.y:.5),a.scale!==t.scale&&e.scale.set(a.scale?a.scale.x:1,a.scale?a.scale.y:1),a.position!==t.position&&e.position.set(a.position?a.position.x:1,a.position?a.position.y:1),a.rotation!==t.rotation&&(e.rotation=a.rotation||0)},didMount:function(e,t){e.on("mousedown",e.onDragStart),e.on("mouseup",e.onDragEnd),e.on("mouseupoutside",e.onDragEnd),e.on("mousemove",e.onDragMove),e.on("mouseover",e.onMouseOver),e.on("mouseout",e.onMouseOut)},willUnmount:function(e,t){e.off("mousedown"),e.off("mouseup"),e.off("mouseupoutside"),e.off("mousemove"),e.off("mouseover"),e.off("mouseout")}}),Kt=Object(Lt.PixiComponent)("Viewport",{create:function(e){var t=new Ft.a({screenWidth:.75*window.innerWidth,screenHeight:window.innerHeight,worldWidth:1e3,worldHeight:1e3});return t.drag({mouseButtons:"right"}).pinch().wheel().decelerate(),t}}),Qt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(c)))).state={loadingAssets:!0,loadProgress:0},a.app=void 0,a.root=void 0,a.loader=Ut.loader,a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this;if(this.props.images!=e.images){this.loader.resources.__missing__||this.loader.add("__missing__","http://placekitten.com/128/128"),this.setState({loadingAssets:!0});var r=this.props.images.map(function(e){return!!a.loader.resources[e.filePath]?null:{name:e.filePath,url:e.downloadUrl,loadType:2}}).filter(function(e){return e});this.loader.add(r),this.loader.load(function(){a.setState({loadingAssets:!1})}),this.loader.onProgress.add(function(e){return a.setState({loadProgress:e.progress})})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.playerCharacters,n=t.nonPlayerCharacters;if(this.state.loadingAssets)return u.a.createElement("div",{className:a.loadingWrapper},u.a.createElement("div",{className:a.loadingText},"LOADING..."),u.a.createElement(Se.e,{variant:"determinate",value:this.state.loadProgress}));if(!this.props.mapData)return u.a.createElement("div",null,"No Map");var c=this.props.mapData.layers,i=c.background,s=c.tokens;return(0,this.props.connectDropTarget)(u.a.createElement("div",null,u.a.createElement(Lt.Stage,{width:.75*window.innerWidth,height:window.innerHeight},u.a.createElement(Kt,null,u.a.createElement(Lt.Container,{name:"layer-background"},Object.keys(i.mapObjects).map(function(t){var a=i.mapObjects[t],c=a.pcId?r.find(function(e){return e.id===a.pcId}):null,s=a.npcId?n.find(function(e){return e.id===a.npcId}):null,l=c&&c.imageRef?c.imageRef:s&&s.imageRef?s.imageRef:a.imageRef||"__missing__",o=Ut.loader.resources[l].texture;return u.a.createElement(zt,{key:t,position:a.position,scale:a.scale,rotation:a.rotation,pivot:a.pivot,anchor:a.anchor,resource:o,onUpdateObject:e.props.onUpdateObject,mapObjectId:t,layerName:"background"})})),u.a.createElement(Lt.Container,{name:"layer-tokens"},s&&s.mapObjects&&Object.keys(s.mapObjects).map(function(t){var a=s.mapObjects[t],c=!!a.pcId,i=!!a.npcId,l=c?r.find(function(e){return e.id===a.pcId}):null,o=i?n.find(function(e){return e.id===a.npcId}):null,p=l&&l.imageRef?l.imageRef:o&&o.imageRef?o.imageRef:a.imageRef||"__missing__",m=Ut.loader.resources[p].texture;return u.a.createElement(Vt,{key:t,resource:m,hp:a.hp||{value:30,max:60},position:a.position,scale:a.scale,rotation:a.rotation,pivot:a.pivot,anchor:a.anchor,onUpdateObject:e.props.onUpdateObject,mapObjectId:t,layerName:"tokens"})}))))))}}]),t}(o.Component),Jt={canDrop:function(e,t){return!0},hover:function(e,t,a){},drop:function(e,t,a){var r=t.getItem(),n=t.getItemType();switch(console.log("dropped [DROPPER]:"),console.log(r),n){case W:e.onAddAssetToMap&&e.onAddAssetToMap({assetType:r.assetType,assetId:r.id});break;case B:e.onAddImageToMap&&e.onAddImageToMap({imageRef:r.imageRef})}}};var Zt=Object(G.DropTarget)([W,B],Jt,function(e,t){return{connectDropTarget:e.dropTarget(),itemType:t.getItemType()}})(Object(Ne.withStyles)(function(e){return{loadingWrapper:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, 0)"},loadingText:{fontSize:"200%"}}})(Qt)),Xt={TESTMAP:{SYNC:"TESTMAP.SYNC",SYNC_FAILED:"TESTMAP.SYNC_FAILED",UPDATE:{OBJECT:"TESTMAP.UPDATE.OBJECT"},ASSET:{ADD:"TESTMAP.ASSET.ADD"},IMAGE:{ADD:"TESTMAP.IMAGE.ADD"}}},$t=function(e){return{type:Xt.TESTMAP.SYNC,map:e}},ea=function(e){return{type:Xt.TESTMAP.SYNC_FAILED,error:e}},ta=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.zoom,a=e.testMap,r=e.onUpdateObject,n=e.onAddAssetToMap,c=e.onAddImageToMap,i=e.playerCharacters,s=e.nonPlayerCharacters,l=e.images;return u.a.createElement(Zt,{updateSpriteLocation:function(){},zoom:t,mapData:a,playerCharacters:i,nonPlayerCharacters:s,onUpdateObject:r,onAddAssetToMap:n,onAddImageToMap:c,images:l})}}]),t}(o.Component),aa=Object(d.c)(function(e){return{zoom:e.map.zoom,testMap:e.testMap.map,images:e.images.images,playerCharacters:e.assets.playerCharacters,nonPlayerCharacters:e.assets.nonPlayerCharacters}},function(e){return{onUpdateObject:function(t){return e(function(e){var t=e.layerName,a=e.mapObjectId,r=e.newData;return{type:Xt.TESTMAP.UPDATE.OBJECT,layerName:t,mapObjectId:a,newData:r}}(t))},onAddAssetToMap:function(t){return e(function(e){var t=e.assetType,a=e.assetId;return{type:Xt.TESTMAP.ASSET.ADD,assetType:t,assetId:a}}(t))},onAddImageToMap:function(t){return e(function(e){var t=e.imageRef;return{type:Xt.TESTMAP.IMAGE.ADD,imageRef:t}}(t))}}})(ta),ra=a(55),na=a(75),ca=a(70),ia=a(159),sa={messages:[],new:{},syncError:null};function la(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case le.CHAT.SYNC:return Object(f.a)({},e,{messages:t.messages});case le.CHAT.SYNC_FAILED:return Object(f.a)({},e,{syncError:t.error});default:return e}}var oa={openCharacterSheets:[]};function ua(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case me.CHARACTERS.OPEN_SHEET:return Object(f.a)({},e,{openCharacterSheets:[].concat(Object(Yt.a)(e.openCharacterSheets.filter(function(e){return e!==t.characterId})),[t.characterId])});case me.CHARACTERS.CLOSE_SHEET:return Object(f.a)({},e,{openCharacterSheets:e.openCharacterSheets.filter(function(e){return e!==t.characterId})});default:return e}}var pa={loading:!1,loggedIn:!1,user:null,loginError:null};function ma(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case Ie.LOGIN.REQUEST:case Ie.LOGOUT.REQUEST:return Object(f.a)({},e,{loading:!0});case Ie.LOGIN.SUCCESS:return Object(f.a)({},e,{loading:!1,loggedIn:!0,user:t.user,loginError:null});case Ie.LOGIN.FAILURE:return Object(f.a)({},e,{loading:!1,loginError:t.error});case Ie.LOGOUT.SUCCESS:return pa;case Ie.LOGOUT.FAILURE:return Object(f.a)({},e,{loading:!1});default:return e}}var ha={uploading:!1,url:null,uploadProgress:0,uploadError:null};function da(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ha,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case ye.STORAGE.SEND_FILE:return Object(f.a)({},e,{uploading:!0});case ye.STORAGE.SEND_FILE_SUCCESS:return Object(f.a)({},e,{uploading:!1});case ye.STORAGE.SEND_FILE_FAILURE:return Object(f.a)({},e,{uploading:!1,uploadError:t.error});case ye.STORAGE.SEND_FILE_PROGRESS:return Object(f.a)({},e,{uploadProgress:t.progress});default:return e}}var fa={IMAGES:{SYNC:"IMAGES.SYNC",SYNC_FAILED:"IMAGES.SYNC_FAILED"}},va=function(e){return{type:fa.IMAGES.SYNC,images:e}},ba=function(e){return{type:fa.IMAGES.SYNC_FAILED,error:e}},ga={images:[],syncError:null};function Ea(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ga,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case fa.IMAGES.SYNC:return Object(f.a)({},e,{images:t.images});case fa.IMAGES.SYNC_FAILED:return Object(f.a)({},e,{syncError:t.error});default:return e}}var ya={playerCharacters:[],nonPlayerCharacters:[],pcSyncError:null,npcSyncError:null};function Oa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ya,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case he.ASSETS.PLAYERCHARACTER.SYNC:return Object(f.a)({},e,{playerCharacters:t.playerCharacters});case he.ASSETS.PLAYERCHARACTER.UPDATE:return Object(f.a)({},e,{playerCharacters:e.playerCharacters.map(function(e){return e.id!==t.characterId?e:t.character})});case he.ASSETS.NONPLAYERCHARACTER.SYNC:return Object(f.a)({},e,{nonPlayerCharacters:t.nonPlayerCharacters});case he.ASSETS.PLAYERCHARACTER.SYNC_FAILED:return Object(f.a)({},e,{pcSyncError:t.error});case he.ASSETS.NONPLAYERCHARACTER.SYNC_FAILED:return Object(f.a)({},e,{npcSyncError:t.error});default:return e}}var Ca={MAP:{ZOOM:{IN:"MAP.ZOOM.IN",OUT:"MAP.ZOOM.OUT"}}},ja={zoom:1};function Sa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja;switch((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).type){case Ca.MAP.ZOOM.IN:return Object(f.a)({},e,{zoom:e.zoom*=1.2});case Ca.MAP.ZOOM.OUT:return Object(f.a)({},e,{zoom:e.zoom*=.8});default:return e}}var Na={map:null,syncError:null};function ka(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Na,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case Xt.TESTMAP.SYNC:return Object(f.a)({},e,{map:t.map});case Xt.TESTMAP.SYNC_FAILED:return Object(f.a)({},e,{syncError:t.error});default:return e}}var Aa=a(11),Ta=a.n(Aa),wa=a(9),_a=a(39),Da=a.n(_a),Pa=(a(335),a(346)),Ra=a.n(Pa),Ia=JSON.parse(localStorage.getItem("firebaseConfig")),xa=Da.a.initializeApp(Ia),Ma=(xa.database(),new Ra.a(xa)),La=Ta.a.mark(Fa),Ua=Ta.a.mark(Ga),Ha=Ta.a.mark(Wa);function Fa(e){var t,a,r;return Ta.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(wa.select)(function(e){return e.auth.user});case 2:return t=n.sent,a=e.message||"",r=e.data||{},n.next=7,Object(wa.call)(Ma.database.create,"/chatroom",{sender:t.email,timestamp:_a.database.ServerValue.TIMESTAMP,msg:a,data:r});case 7:case"end":return n.stop()}},La)}var Ya=function(e){var t=e.value;return Object.keys(t).map(function(e){return Object(f.a)({},t[e],{id:e})})};function Ga(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ma.database.sync,Object(_a.database)(Ma.app).ref("/chatroom").orderByChild("timestamp").limitToLast(100),{successActionCreator:oe,failureActionCreator:pe,transform:Ya},"value");case 2:case"end":return e.stop()}},Ua)}function Wa(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.all)([Object(wa.fork)(Ga),Object(wa.takeEvery)(le.CHAT.NEW.SAVE,Fa)]);case 2:case"end":return e.stop()}},Ha)}var Ba=Ta.a.mark(Ka),qa=Ta.a.mark(Qa),Va=Ta.a.mark(Ja),za=Ta.a.mark(Za);new Da.a.auth.EmailAuthProvider;function Ka(e){return Ta.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(wa.call)(Ma.auth.signInWithEmailAndPassword,e.username,e.password);case 3:t.next=9;break;case 5:return t.prev=5,t.t0=t.catch(0),t.next=9,Object(wa.put)(Le(t.t0));case 9:case"end":return t.stop()}},Ba,null,[[0,5]])}function Qa(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(wa.call)(Ma.auth.signOut);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),e.next=9,Object(wa.put)(Fe(e.t0));case 9:case"end":return e.stop()}},qa,null,[[0,5]])}function Ja(){var e,t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(wa.call)(Ma.auth.channel);case 2:e=r.sent;case 3:return r.next=6,Object(wa.take)(e);case 6:if(t=r.sent,!(a=t.user)){r.next=13;break}return r.next=11,Object(wa.put)(Me(a));case 11:r.next=15;break;case 13:return r.next=15,Object(wa.put)(He());case 15:r.next=3;break;case 17:case"end":return r.stop()}},Va)}function Za(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ja);case 2:return e.next=4,Object(wa.all)([Object(wa.takeEvery)(Ie.LOGIN.REQUEST,Ka),Object(wa.takeEvery)(Ie.LOGOUT.REQUEST,Qa)]);case 4:case"end":return e.stop()}},za)}var Xa=a(347),$a=a.n(Xa),er=Ta.a.mark(nr),tr=Ta.a.mark(cr),ar=Ta.a.mark(ir),rr=Object(na.channel)();function nr(e){var t,a,r,n;return Ta.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t="uploads/".concat(e.name,"/").concat($a()()),(a=Ma.storage.uploadFile(t,e.file)).on("state_changed",function(e){var t=100*e.bytesTransferred/e.totalBytes;console.log("".concat(t,"%")),rr.put(Oe(t))}),c.next=5,a;case 5:return c.prev=5,c.next=8,Object(wa.call)(Ma.storage.getDownloadURL,t);case 8:return r=c.sent,n={downloadUrl:r,name:e.name,filePath:t,uploadTime:_a.database.ServerValue.TIMESTAMP},c.next=12,Object(wa.call)(Ma.database.create,"/uploads",n);case 12:return c.next=14,Object(wa.put)(Ce());case 14:c.next=21;break;case 16:return c.prev=16,c.t0=c.catch(5),console.error(c.t0),c.next=21,Object(wa.put)(je(c.t0));case 21:case"end":return c.stop()}},er,null,[[5,16]])}function cr(){var e;return Ta.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(wa.take)(rr);case 3:return e=t.sent,t.next=6,Object(wa.put)(e);case 6:t.next=0;break;case 8:case"end":return t.stop()}},tr)}function ir(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(cr);case 2:return e.next=4,Object(wa.all)([Object(wa.takeEvery)(ye.STORAGE.SEND_FILE,nr)]);case 4:case"end":return e.stop()}},ar)}var sr=Ta.a.mark(ur),lr=Ta.a.mark(pr),or=function(e){var t=e.value;return Object.keys(t).map(function(e){return Object(f.a)({},t[e],{id:e})})};function ur(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ma.database.sync,Object(_a.database)(Ma.app).ref("/uploads").orderByChild("timestamp"),{successActionCreator:va,failureActionCreator:ba,transform:or},"value");case 2:case"end":return e.stop()}},sr)}function pr(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.all)([Object(wa.fork)(ur)]);case 2:case"end":return e.stop()}},lr)}var mr=Ta.a.mark(Or),hr=Ta.a.mark(Cr),dr=Ta.a.mark(jr),fr=Ta.a.mark(Sr),vr=Ta.a.mark(Nr),br=Ta.a.mark(kr),gr=Ta.a.mark(Ar),Er=function(e){var t=e.value;return Object.keys(t).map(function(e){return Object(f.a)({},t[e],{id:e})})},yr=function(e){var t=e.value;return Object.keys(t).map(function(e){return Object(f.a)({},t[e],{id:e})})};function Or(e){var t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(wa.select)(function(e){return e.auth.user});case 2:return t=r.sent,a=Object(f.a)({},e.nonPlayerCharacterData,{timestamp:_a.database.ServerValue.TIMESTAMP,creator:t.uid}),r.next=6,Object(wa.call)(Ma.database.create,"/nonPlayerCharacters",a);case 6:case"end":return r.stop()}},mr)}function Cr(e){var t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(wa.select)(function(e){return e.auth.user});case 2:return t=r.sent,a=Object(f.a)({},e.character,{timestamp:_a.database.ServerValue.TIMESTAMP,creator:t.uid}),r.next=6,Object(wa.call)(Ma.database.patch,"/playerCharacters/"+e.characterId,a);case 6:case"end":return r.stop()}},hr)}function jr(e){var t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(wa.select)(function(e){return e.auth.user});case 2:return t=r.sent,a=Object(f.a)({},e.playerCharacterData,{timestamp:_a.database.ServerValue.TIMESTAMP,creator:t.uid}),r.next=6,Object(wa.call)(Ma.database.create,"/playerCharacters",a);case 6:case"end":return r.stop()}},dr)}function Sr(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ma.database.sync,Object(_a.database)(Ma.app).ref("/playerCharacters"),{successActionCreator:de,failureActionCreator:fe,transform:Er},"value");case 2:case"end":return e.stop()}},fr)}function Nr(e){var t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(wa.select)(function(e){return e.auth.user});case 2:return t=r.sent,a=Object(f.a)({},e.character,{timestamp:_a.database.ServerValue.TIMESTAMP,creator:t.uid}),r.next=6,Object(wa.call)(Ma.database.update,"/nonPlayerCharacters/"+e.character.id,a);case 6:case"end":return r.stop()}},vr)}function kr(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ma.database.sync,Object(_a.database)(Ma.app).ref("/nonPlayerCharacters"),{successActionCreator:ve,failureActionCreator:be,transform:yr},"value");case 2:case"end":return e.stop()}},br)}function Ar(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.all)([Object(wa.fork)(Sr),Object(wa.fork)(kr),Object(wa.takeEvery)(he.ASSETS.PLAYERCHARACTER.UPDATE,Cr),Object(wa.takeEvery)(he.ASSETS.PLAYERCHARACTER.NEW.SAVE,jr),Object(wa.takeEvery)(he.ASSETS.NONPLAYERCHARACTER.UPDATE,Nr),Object(wa.takeEvery)(he.ASSETS.NONPLAYERCHARACTER.NEW.SAVE,Or)]);case 2:case"end":return e.stop()}},gr)}var Tr=Ta.a.mark(Ir),wr=Ta.a.mark(xr),_r=Ta.a.mark(Mr),Dr=Ta.a.mark(Lr),Pr=Ta.a.mark(Ur),Rr=function(e){return e.value};function Ir(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.fork)(Ma.database.sync,Object(_a.database)(Ma.app).ref("/testMap"),{successActionCreator:$t,failureActionCreator:ea,transform:Rr},"value");case 2:case"end":return e.stop()}},Tr)}function xr(e){var t,a,r;return Ta.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.layerName,a=e.mapObjectId,r=e.newData,n.next=3,Object(wa.call)(Ma.database.patch,"/testMap/layers/".concat(t,"/mapObjects/").concat(a),r);case 3:case"end":return n.stop()}},wr)}function Mr(e){var t,a,r;return Ta.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.assetType,a=e.assetId,r={anchor:{x:.5,y:.5},pivot:{x:.5,y:.5},name:"New Asset",position:{x:0,y:0},rotation:0,scale:{x:1,y:1}},t===mt.PlayerCharacter?r.pcId=a:t===mt.NonPlayerCharacter&&(r.npcId=a),n.next=5,Object(wa.call)(Ma.database.create,"/testMap/layers/tokens/mapObjects",r);case 5:case"end":return n.stop()}},_r)}function Lr(e){var t,a;return Ta.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.imageRef,a={anchor:{x:.5,y:.5},pivot:{x:.5,y:.5},name:"New Map Object",position:{x:0,y:0},rotation:0,scale:{x:1,y:1},imageRef:t},r.next=4,Object(wa.call)(Ma.database.create,"/testMap/layers/background/mapObjects",a);case 4:case"end":return r.stop()}},Dr)}function Ur(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.all)([Object(wa.fork)(Ir),Object(wa.takeEvery)(Xt.TESTMAP.UPDATE.OBJECT,xr),Object(wa.takeEvery)(Xt.TESTMAP.ASSET.ADD,Mr),Object(wa.takeEvery)(Xt.TESTMAP.IMAGE.ADD,Lr)]);case 2:case"end":return e.stop()}},Pr)}var Hr=Ta.a.mark(Fr);function Fr(){return Ta.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wa.all)([Object(wa.fork)(Wa),Object(wa.fork)(Za),Object(wa.fork)(ir),Object(wa.fork)(pr),Object(wa.fork)(Ar),Object(wa.fork)(Ur)]);case 2:case"end":return e.stop()}},Hr)}var Yr,Gr=Object(ca.a)({basename:""}),Wr=Object(na.default)(),Br=[Wr],qr=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ra.compose).apply(void 0,[ra.applyMiddleware.apply(void 0,Br)].concat([])),Vr=Object(ra.createStore)((Yr=Gr,Object(ra.combineReducers)({router:Object(ia.b)(Yr),chat:la,auth:ma,storage:da,images:Ea,assets:Oa,map:Sa,characters:ua,testMap:ka})),{},qr);Wr.run(Fr);var zr=Vr,Kr=a(348),Qr=a.n(Kr);a.d(t,"App",function(){return Jr});var Jr=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).configLoaded=void 0,a.configLoaded=!!localStorage.getItem("firebaseConfig"),a.state={projectName:"",apiKey:""},a}return Object(l.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=Object(Ne.createMuiTheme)({palette:{type:"dark"}});return u.a.createElement(d.a,{store:zr},u.a.createElement(ia.a,{history:Gr},u.a.createElement(G.DragDropContextProvider,{backend:Qr.a},u.a.createElement("div",{className:"App"},u.a.createElement(Ne.MuiThemeProvider,{theme:e},u.a.createElement(p.c,null,u.a.createElement(p.a,{exact:!0,path:"/",render:function(){return u.a.createElement("div",null,u.a.createElement("div",{className:h.a.mapWrapper},u.a.createElement(aa,null)),u.a.createElement("div",{className:h.a.chatWrapper},u.a.createElement(Mt,null)),u.a.createElement("div",null,u.a.createElement(Ee,null)))}}),u.a.createElement(p.a,{path:"/upload",render:function(){return u.a.createElement(we,null)}}),u.a.createElement(p.a,{path:"/login",render:function(){return u.a.createElement(Be,null)}}),u.a.createElement(p.a,{path:"/characterSheet/:id",render:function(e){return u.a.createElement(Ee,Object.assign({popout:e.match.params.id},e))}})))))))}}]),t}(o.Component);t.default=Jr},831:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(47),i=a.n(c);a(433),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(53),l=a(31),o=a(838),u=void 0;o.a({dsn:"https://04f41a05077c4badbe2fb7c804604233@sentry.dnd-player.com/2"});var p={projectId:"",apiKey:""},m=function(){localStorage.setItem("firebaseConfig",JSON.stringify({apiKey:p.apiKey,authDomain:"".concat(p.projectId,".firebaseapp.com"),databaseURL:"https://".concat(p.projectId,".firebaseio.com"),projectId:p.projectId,storageBucket:"".concat(p.projectId,".appspot.com")})),window.location.replace(window.location.origin)},h=window.location.search.match(/\?projectId=(.*?)&apiKey=(.*)$/);if(h)p.projectId=h[1],p.apiKey=h[2],m();else if(null==localStorage.getItem("firebaseConfig")){var d=Object(s.createMuiTheme)({palette:{type:"dark"}});i.a.render(n.a.createElement("div",{className:"App"},n.a.createElement(s.MuiThemeProvider,{theme:d},n.a.createElement("div",{className:"projectInputs"},n.a.createElement(l.h,{label:"Project Name",placeholder:"dnd-player-b8372",onChange:function(e){return p.projectId=e.target.value},margin:"normal"}),n.a.createElement(l.h,{label:"API Key",placeholder:"AIzaSd***************pK5ao6g95Q-9auWt-8",onChange:function(e){return p.apiKey=e.target.value},margin:"normal",onKeyUp:function(e){13===e.keyCode&&u.saveConfig()}}),n.a.createElement(l.a,{variant:"contained",color:"primary",onClick:function(){return m()}},"Save")))),document.getElementById("root"))}else{var f=a(830).default;i.a.render(n.a.createElement(f,null),document.getElementById("root"))}"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},87:function(e,t,a){e.exports={chatinput:"Chat_chatinput__1_63y",messageWrapper:"Chat_messageWrapper__NibWu",messages:"Chat_messages__umiIH",rollButton:"Chat_rollButton__2gB8L",chat:"Chat_chat__1_6O9",chatHeader:"Chat_chatHeader__2t-78",username:"Chat_username__2zIlL",chatInputWrapper:"Chat_chatInputWrapper__26-qp"}}},[[428,1,2]]]);
//# sourceMappingURL=main.5c133cde.chunk.js.map